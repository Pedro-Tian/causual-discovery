[2025-04-30 06:26:42,097] {'0.01_0': [], '0.01_0.05': [], '0.01_0.1': [], '0.01_0.15': [], '0.01_0.2': [], '0.01_0.25': [], '0.01_0.3': [], '0.01_0.35': [], '0.01_0.4': [], '0.01_0.45': [], '0.01_0.5': [], '0.01_0.6': [], '0.01_0.7': [], '0.01_0.8': [], '0.01_0.9': [], '0.02_0': [], '0.02_0.05': [], '0.02_0.1': [], '0.02_0.15': [], '0.02_0.2': [], '0.02_0.25': [], '0.02_0.3': [], '0.02_0.35': [], '0.02_0.4': [], '0.02_0.45': [], '0.02_0.5': [], '0.02_0.6': [], '0.02_0.7': [], '0.02_0.8': [], '0.02_0.9': [], '0.03_0': [], '0.03_0.05': [], '0.03_0.1': [], '0.03_0.15': [], '0.03_0.2': [], '0.03_0.25': [], '0.03_0.3': [], '0.03_0.35': [], '0.03_0.4': [], '0.03_0.45': [], '0.03_0.5': [], '0.03_0.6': [], '0.03_0.7': [], '0.03_0.8': [], '0.03_0.9': [], '0.04_0': [], '0.04_0.05': [], '0.04_0.1': [], '0.04_0.15': [], '0.04_0.2': [], '0.04_0.25': [], '0.04_0.3': [], '0.04_0.35': [], '0.04_0.4': [], '0.04_0.45': [], '0.04_0.5': [], '0.04_0.6': [], '0.04_0.7': [], '0.04_0.8': [], '0.04_0.9': [], '0.05_0': [], '0.05_0.05': [], '0.05_0.1': [], '0.05_0.15': [], '0.05_0.2': [], '0.05_0.25': [], '0.05_0.3': [], '0.05_0.35': [], '0.05_0.4': [], '0.05_0.45': [], '0.05_0.5': [], '0.05_0.6': [], '0.05_0.7': [], '0.05_0.8': [], '0.05_0.9': [], '0.1_0': [], '0.1_0.05': [], '0.1_0.1': [], '0.1_0.15': [], '0.1_0.2': [], '0.1_0.25': [], '0.1_0.3': [], '0.1_0.35': [], '0.1_0.4': [], '0.1_0.45': [], '0.1_0.5': [], '0.1_0.6': [], '0.1_0.7': [], '0.1_0.8': [], '0.1_0.9': [], '0.2_0': [], '0.2_0.05': [], '0.2_0.1': [], '0.2_0.15': [], '0.2_0.2': [], '0.2_0.25': [], '0.2_0.3': [], '0.2_0.35': [], '0.2_0.4': [], '0.2_0.45': [], '0.2_0.5': [], '0.2_0.6': [], '0.2_0.7': [], '0.2_0.8': [], '0.2_0.9': [], '0.3_0': [], '0.3_0.05': [], '0.3_0.1': [], '0.3_0.15': [], '0.3_0.2': [], '0.3_0.25': [], '0.3_0.3': [], '0.3_0.35': [], '0.3_0.4': [], '0.3_0.45': [], '0.3_0.5': [], '0.3_0.6': [], '0.3_0.7': [], '0.3_0.8': [], '0.3_0.9': [], '0.4_0': [], '0.4_0.05': [], '0.4_0.1': [], '0.4_0.15': [], '0.4_0.2': [], '0.4_0.25': [], '0.4_0.3': [], '0.4_0.35': [], '0.4_0.4': [], '0.4_0.45': [], '0.4_0.5': [], '0.4_0.6': [], '0.4_0.7': [], '0.4_0.8': [], '0.4_0.9': [], '0.5_0': [], '0.5_0.05': [], '0.5_0.1': [], '0.5_0.15': [], '0.5_0.2': [], '0.5_0.25': [], '0.5_0.3': [], '0.5_0.35': [], '0.5_0.4': [], '0.5_0.45': [], '0.5_0.5': [], '0.5_0.6': [], '0.5_0.7': [], '0.5_0.8': [], '0.5_0.9': [], '0.6_0': [], '0.6_0.05': [], '0.6_0.1': [], '0.6_0.15': [], '0.6_0.2': [], '0.6_0.25': [], '0.6_0.3': [], '0.6_0.35': [], '0.6_0.4': [], '0.6_0.45': [], '0.6_0.5': [], '0.6_0.6': [], '0.6_0.7': [], '0.6_0.8': [], '0.6_0.9': [], '0.7_0': [], '0.7_0.05': [], '0.7_0.1': [], '0.7_0.15': [], '0.7_0.2': [], '0.7_0.25': [], '0.7_0.3': [], '0.7_0.35': [], '0.7_0.4': [], '0.7_0.45': [], '0.7_0.5': [], '0.7_0.6': [], '0.7_0.7': [], '0.7_0.8': [], '0.7_0.9': [], '0.8_0': [], '0.8_0.05': [], '0.8_0.1': [], '0.8_0.15': [], '0.8_0.2': [], '0.8_0.25': [], '0.8_0.3': [], '0.8_0.35': [], '0.8_0.4': [], '0.8_0.45': [], '0.8_0.5': [], '0.8_0.6': [], '0.8_0.7': [], '0.8_0.8': [], '0.8_0.9': [], '0.9_0': [], '0.9_0.05': [], '0.9_0.1': [], '0.9_0.15': [], '0.9_0.2': [], '0.9_0.25': [], '0.9_0.3': [], '0.9_0.35': [], '0.9_0.4': [], '0.9_0.45': [], '0.9_0.5': [], '0.9_0.6': [], '0.9_0.7': [], '0.9_0.8': [], '0.9_0.9': [], '1_0': [], '1_0.05': [], '1_0.1': [], '1_0.15': [], '1_0.2': [], '1_0.25': [], '1_0.3': [], '1_0.35': [], '1_0.4': [], '1_0.45': [], '1_0.5': [], '1_0.6': [], '1_0.7': [], '1_0.8': [], '1_0.9': [], '1.5_0': [], '1.5_0.05': [], '1.5_0.1': [], '1.5_0.15': [], '1.5_0.2': [], '1.5_0.25': [], '1.5_0.3': [], '1.5_0.35': [], '1.5_0.4': [], '1.5_0.45': [], '1.5_0.5': [], '1.5_0.6': [], '1.5_0.7': [], '1.5_0.8': [], '1.5_0.9': [], '2_0': [], '2_0.05': [], '2_0.1': [], '2_0.15': [], '2_0.2': [], '2_0.25': [], '2_0.3': [], '2_0.35': [], '2_0.4': [], '2_0.45': [], '2_0.5': [], '2_0.6': [], '2_0.7': [], '2_0.8': [], '2_0.9': [], '3_0': [], '3_0.05': [], '3_0.1': [], '3_0.15': [], '3_0.2': [], '3_0.25': [], '3_0.3': [], '3_0.35': [], '3_0.4': [], '3_0.45': [], '3_0.5': [], '3_0.6': [], '3_0.7': [], '3_0.8': [], '3_0.9': [], '4_0': [], '4_0.05': [], '4_0.1': [], '4_0.15': [], '4_0.2': [], '4_0.25': [], '4_0.3': [], '4_0.35': [], '4_0.4': [], '4_0.45': [], '4_0.5': [], '4_0.6': [], '4_0.7': [], '4_0.8': [], '4_0.9': [], '5_0': [], '5_0.05': [], '5_0.1': [], '5_0.15': [], '5_0.2': [], '5_0.25': [], '5_0.3': [], '5_0.35': [], '5_0.4': [], '5_0.45': [], '5_0.5': [], '5_0.6': [], '5_0.7': [], '5_0.8': [], '5_0.9': [], '6_0': [], '6_0.05': [], '6_0.1': [], '6_0.15': [], '6_0.2': [], '6_0.25': [], '6_0.3': [], '6_0.35': [], '6_0.4': [], '6_0.45': [], '6_0.5': [], '6_0.6': [], '6_0.7': [], '6_0.8': [], '6_0.9': [], '7_0': [], '7_0.05': [], '7_0.1': [], '7_0.15': [], '7_0.2': [], '7_0.25': [], '7_0.3': [], '7_0.35': [], '7_0.4': [], '7_0.45': [], '7_0.5': [], '7_0.6': [], '7_0.7': [], '7_0.8': [], '7_0.9': [], '8_0': [], '8_0.05': [], '8_0.1': [], '8_0.15': [], '8_0.2': [], '8_0.25': [], '8_0.3': [], '8_0.35': [], '8_0.4': [], '8_0.45': [], '8_0.5': [], '8_0.6': [], '8_0.7': [], '8_0.8': [], '8_0.9': [], '9_0': [], '9_0.05': [], '9_0.1': [], '9_0.15': [], '9_0.2': [], '9_0.25': [], '9_0.3': [], '9_0.35': [], '9_0.4': [], '9_0.45': [], '9_0.5': [], '9_0.6': [], '9_0.7': [], '9_0.8': [], '9_0.9': [], '10_0': [], '10_0.05': [], '10_0.1': [], '10_0.15': [], '10_0.2': [], '10_0.25': [], '10_0.3': [], '10_0.35': [], '10_0.4': [], '10_0.45': [], '10_0.5': [], '10_0.6': [], '10_0.7': [], '10_0.8': [], '10_0.9': [], '15_0': [], '15_0.05': [], '15_0.1': [], '15_0.15': [], '15_0.2': [], '15_0.25': [], '15_0.3': [], '15_0.35': [], '15_0.4': [], '15_0.45': [], '15_0.5': [], '15_0.6': [], '15_0.7': [], '15_0.8': [], '15_0.9': [], '20_0': [], '20_0.05': [], '20_0.1': [], '20_0.15': [], '20_0.2': [], '20_0.25': [], '20_0.3': [], '20_0.35': [], '20_0.4': [], '20_0.45': [], '20_0.5': [], '20_0.6': [], '20_0.7': [], '20_0.8': [], '20_0.9': [], '30_0': [], '30_0.05': [], '30_0.1': [], '30_0.15': [], '30_0.2': [], '30_0.25': [], '30_0.3': [], '30_0.35': [], '30_0.4': [], '30_0.45': [], '30_0.5': [], '30_0.6': [], '30_0.7': [], '30_0.8': [], '30_0.9': [], '40_0': [], '40_0.05': [], '40_0.1': [], '40_0.15': [], '40_0.2': [], '40_0.25': [], '40_0.3': [], '40_0.35': [], '40_0.4': [], '40_0.45': [], '40_0.5': [], '40_0.6': [], '40_0.7': [], '40_0.8': [], '40_0.9': [], '50_0': [], '50_0.05': [], '50_0.1': [], '50_0.15': [], '50_0.2': [], '50_0.25': [], '50_0.3': [], '50_0.35': [], '50_0.4': [], '50_0.45': [], '50_0.5': [], '50_0.6': [], '50_0.7': [], '50_0.8': [], '50_0.9': [], '100_0': [], '100_0.05': [], '100_0.1': [], '100_0.15': [], '100_0.2': [], '100_0.25': [], '100_0.3': [], '100_0.35': [], '100_0.4': [], '100_0.45': [], '100_0.5': [], '100_0.6': [], '100_0.7': [], '100_0.8': [], '100_0.9': []}
[2025-04-30 06:26:42,097] 
================ repeat number 1 ====================
[2025-04-30 06:26:42,151] true_dag
[[0 0 1 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
[2025-04-30 06:26:47,572] 
===  0-th graph ===
[2025-04-30 06:26:47,572] 53 Nodes of True MB: [0, 2, 3, 5, 24, 27, 30, 39, 42, 47, 59, 60, 61, 64, 73, 82, 88, 91, 93, 100, 115, 118, 120, 122, 125, 134, 153, 157, 181, 185, 191, 192, 195, 196, 198, 219, 223, 225, 227, 228, 232, 233, 234, 241, 244, 245, 251, 257, 262, 269, 271, 284, 287], parents: {257, 100, 244, 118, 122, 287}, children: {2, 3, 196, 42, 60}, spouse: {0, 5, 134, 262, 269, 271, 24, 153, 27, 284, 157, 30, 287, 39, 47, 181, 185, 59, 61, 191, 192, 64, 195, 198, 73, 82, 88, 91, 219, 93, 223, 225, 227, 228, 232, 233, 234, 241, 115, 245, 120, 251, 125}
[2025-04-30 06:26:47,573] 9 Nodes of Markov blanket: [0, 30, 64, 115, 134, 153, 191, 192, 287]
[2025-04-30 06:26:47,577] [MB metrics] precision: 1.000, recall: 0.170, acc: 0.847, f1: 0.290
[2025-04-30 06:27:03,373] sub_met2 before prunning None
[2025-04-30 06:27:03,373] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3429, 'shd': 13, 'nnz': 12, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:27:03,373] 
===  1-th graph ===
[2025-04-30 06:27:03,386] 25 Nodes of True MB: [1, 5, 16, 20, 33, 36, 50, 77, 82, 92, 119, 142, 148, 162, 185, 192, 195, 241, 249, 256, 257, 265, 269, 291, 298], parents: {192, 33, 195, 265, 77, 269, 16, 50, 82, 20, 249}, children: {162}, spouse: {256, 1, 257, 291, 36, 5, 298, 142, 241, 20, 148, 119, 185, 92}
[2025-04-30 06:27:03,387] 8 Nodes of Markov blanket: [1, 5, 92, 119, 142, 185, 241, 291]
[2025-04-30 06:27:03,390] [MB metrics] precision: 1.000, recall: 0.320, acc: 0.943, f1: 0.485
[2025-04-30 06:27:21,221] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:27:21,221] sub_met2 before prunning None
[2025-04-30 06:27:21,221] sub_met after prunning None
[2025-04-30 06:27:21,221] 
===  2-th graph ===
[2025-04-30 06:27:21,221] 13 Nodes of True MB: [0, 2, 5, 59, 61, 91, 125, 181, 195, 198, 228, 232, 269], parents: {0, 195, 228, 5, 198, 232, 59, 269, 125, 181, 91, 61}, children: set(), spouse: {2}
[2025-04-30 06:27:21,221] 
===  3-th graph ===
[2025-04-30 06:27:21,221] 12 Nodes of True MB: [0, 3, 39, 82, 125, 134, 185, 191, 225, 251, 262, 287], parents: {0, 225, 287, 134, 39, 262, 82, 185, 251, 125, 191}, children: set(), spouse: {3}
[2025-04-30 06:27:21,221] 
===  4-th graph ===
[2025-04-30 06:27:21,221] 23 Nodes of True MB: [4, 30, 40, 73, 111, 113, 134, 140, 142, 153, 161, 178, 193, 197, 208, 210, 245, 252, 253, 257, 281, 282, 285], parents: {257, 245, 134}, children: {193, 210, 252}, spouse: {161, 285, 4, 197, 281, 40, 73, 140, 142, 111, 208, 113, 178, 153, 282, 253, 30}
[2025-04-30 06:27:21,221] 4 Nodes of Markov blanket: [4, 111, 161, 197]
[2025-04-30 06:27:21,221] [MB metrics] precision: 1.000, recall: 0.174, acc: 0.934, f1: 0.296
[2025-04-30 06:27:27,776] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:27:27,776] sub_met2 before prunning None
[2025-04-30 06:27:27,776] sub_met after prunning None
[2025-04-30 06:27:27,776] 
===  5-th graph ===
[2025-04-30 06:27:27,776] 72 Nodes of True MB: [0, 1, 2, 5, 10, 11, 20, 22, 24, 25, 28, 30, 36, 46, 56, 59, 60, 61, 64, 66, 73, 82, 88, 90, 91, 92, 94, 97, 102, 105, 107, 111, 113, 115, 119, 125, 128, 130, 142, 148, 153, 157, 162, 174, 180, 181, 183, 185, 194, 195, 198, 221, 223, 226, 228, 232, 241, 242, 249, 252, 256, 257, 269, 274, 275, 278, 280, 290, 291, 292, 295, 298], parents: {128, 102, 73, 107, 174, 275, 180, 22, 183, 249, 221}, children: {162, 2, 130, 290, 278, 60, 94}, spouse: {256, 1, 257, 0, 5, 10, 11, 269, 142, 274, 20, 148, 24, 25, 280, 153, 28, 157, 30, 291, 36, 292, 295, 298, 46, 181, 56, 185, 59, 61, 64, 66, 195, 194, 198, 82, 88, 90, 91, 92, 223, 97, 226, 228, 232, 105, 111, 241, 242, 115, 113, 119, 249, 252, 125}
[2025-04-30 06:27:27,776] 20 Nodes of Markov blanket: [1, 5, 11, 30, 46, 56, 59, 92, 105, 111, 115, 119, 142, 180, 185, 226, 232, 241, 256, 291]
[2025-04-30 06:27:27,776] [MB metrics] precision: 1.000, recall: 0.278, acc: 0.826, f1: 0.435
[2025-04-30 06:27:47,697] sub_met2 before prunning None
[2025-04-30 06:27:47,697] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.1405, 'shd': 31, 'nnz': 26, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:27:47,697] 
===  6-th graph ===
[2025-04-30 06:27:47,711] 37 Nodes of True MB: [6, 7, 25, 33, 37, 40, 41, 47, 74, 80, 88, 92, 97, 107, 112, 113, 117, 118, 126, 137, 140, 158, 159, 187, 189, 192, 201, 206, 214, 242, 244, 245, 266, 276, 281, 293, 298], parents: {298, 140, 244, 117, 88, 281, 126, 158}, children: {80, 41, 137, 242}, spouse: {6, 7, 266, 276, 25, 158, 159, 33, 293, 37, 40, 47, 187, 189, 192, 201, 74, 206, 214, 92, 97, 107, 112, 113, 245, 118, 117}
[2025-04-30 06:27:47,711] 6 Nodes of Markov blanket: [6, 7, 113, 214, 266, 276]
[2025-04-30 06:27:47,715] [MB metrics] precision: 1.000, recall: 0.162, acc: 0.896, f1: 0.279
[2025-04-30 06:27:57,856] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:27:57,856] sub_met2 before prunning None
[2025-04-30 06:27:57,856] sub_met after prunning None
[2025-04-30 06:27:57,856] 
===  7-th graph ===
[2025-04-30 06:27:57,856] 40 Nodes of True MB: [6, 7, 24, 30, 33, 47, 54, 76, 80, 92, 100, 103, 106, 113, 118, 121, 124, 134, 138, 141, 144, 169, 171, 175, 178, 193, 194, 208, 209, 214, 232, 235, 244, 249, 259, 262, 266, 276, 289, 290], parents: {289, 100, 141, 134}, children: {259, 262, 138, 47, 80}, spouse: {134, 7, 262, 6, 266, 144, 276, 24, 30, 33, 290, 169, 171, 175, 178, 54, 193, 194, 76, 208, 209, 214, 92, 121, 103, 232, 106, 235, 113, 244, 118, 249, 124}
[2025-04-30 06:27:57,856] 13 Nodes of Markov blanket: [6, 7, 54, 124, 169, 171, 178, 214, 232, 244, 262, 266, 276]
[2025-04-30 06:27:57,856] [MB metrics] precision: 1.000, recall: 0.325, acc: 0.907, f1: 0.491
[2025-04-30 06:28:14,907] sub_met2 before prunning None
[2025-04-30 06:28:14,907] sub_met after prunning {'fdr': 0.8667, 'tpr': 1.0, 'fpr': 0.3514, 'shd': 26, 'nnz': 30, 'precision': 0.1333, 'recall': 1.0, 'F1': 0.2353, 'gscore': 0.0}
[2025-04-30 06:28:14,907] 
===  8-th graph ===
[2025-04-30 06:28:14,907] 3 Nodes of True MB: [8, 31, 224], parents: {224, 31}, children: set(), spouse: {8}
[2025-04-30 06:28:14,907] 
===  9-th graph ===
[2025-04-30 06:28:14,907] 26 Nodes of True MB: [9, 20, 59, 73, 75, 76, 87, 101, 103, 109, 112, 115, 120, 139, 141, 181, 192, 196, 205, 208, 244, 282, 284, 285, 294, 298], parents: {285, 181, 294}, children: {205, 76, 101, 103}, spouse: {9, 139, 141, 20, 282, 284, 298, 59, 192, 196, 73, 75, 208, 87, 109, 112, 115, 244, 120}
[2025-04-30 06:28:14,907] 11 Nodes of Markov blanket: [9, 59, 109, 112, 115, 120, 139, 192, 208, 244, 298]
[2025-04-30 06:28:14,923] [MB metrics] precision: 1.000, recall: 0.423, acc: 0.950, f1: 0.595
[2025-04-30 06:28:31,671] sub_met2 before prunning None
[2025-04-30 06:28:31,671] sub_met after prunning {'fdr': 0.9615, 'tpr': 0.5, 'fpr': 0.4717, 'shd': 26, 'nnz': 26, 'precision': 0.0385, 'recall': 0.5, 'F1': 0.0714, 'gscore': 0.0}
[2025-04-30 06:28:31,671] 
===  10-th graph ===
[2025-04-30 06:28:31,671] 48 Nodes of True MB: [5, 10, 23, 24, 25, 32, 40, 49, 56, 59, 66, 87, 88, 90, 91, 96, 97, 105, 106, 109, 111, 113, 122, 123, 135, 148, 157, 160, 189, 211, 213, 226, 233, 239, 249, 251, 259, 260, 266, 274, 278, 280, 281, 284, 290, 294, 296, 299], parents: {233, 211}, children: {96, 290, 260, 274, 213, 23}, spouse: {259, 5, 135, 10, 266, 274, 148, 278, 24, 25, 280, 281, 284, 157, 32, 160, 294, 296, 40, 299, 49, 56, 59, 189, 66, 87, 88, 90, 91, 97, 226, 105, 106, 123, 109, 239, 111, 113, 249, 122, 251}
[2025-04-30 06:28:31,671] 7 Nodes of Markov blanket: [10, 40, 66, 106, 189, 251, 281]
[2025-04-30 06:28:31,676] [MB metrics] precision: 1.000, recall: 0.146, acc: 0.863, f1: 0.255
[2025-04-30 06:28:45,029] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:28:45,041] sub_met2 before prunning None
[2025-04-30 06:28:45,041] sub_met after prunning None
[2025-04-30 06:28:45,041] 
===  11-th graph ===
[2025-04-30 06:28:45,041] 28 Nodes of True MB: [5, 11, 44, 46, 56, 61, 66, 70, 82, 84, 115, 122, 130, 147, 149, 166, 169, 172, 184, 194, 199, 224, 229, 242, 286, 287, 292, 293], parents: {224, 293, 70, 166, 169, 44, 84, 149, 184, 122, 286}, children: {130, 172}, spouse: {66, 194, 292, 5, 229, 199, 11, 46, 82, 115, 242, 147, 56, 122, 61, 287}
[2025-04-30 06:28:45,041] 9 Nodes of Markov blanket: [5, 11, 46, 56, 61, 66, 82, 115, 286]
[2025-04-30 06:28:45,046] [MB metrics] precision: 1.000, recall: 0.321, acc: 0.935, f1: 0.486
[2025-04-30 06:29:00,360] sub_met2 before prunning None
[2025-04-30 06:29:00,360] sub_met after prunning {'fdr': 0.8333, 'tpr': 0.3333, 'fpr': 0.1515, 'shd': 7, 'nnz': 6, 'precision': 0.1667, 'recall': 0.3333, 'F1': 0.2222, 'gscore': 0.0}
[2025-04-30 06:29:00,360] 
===  12-th graph ===
[2025-04-30 06:29:00,360] 47 Nodes of True MB: [12, 13, 17, 38, 46, 50, 52, 58, 62, 66, 76, 95, 103, 111, 125, 129, 134, 135, 143, 155, 159, 160, 161, 165, 168, 180, 183, 184, 198, 201, 204, 231, 232, 236, 238, 247, 253, 269, 270, 276, 277, 280, 284, 286, 291, 292, 293], parents: {129, 66, 161, 38, 103, 135, 270, 50}, children: {17, 52, 201, 238}, spouse: {134, 12, 13, 269, 143, 276, 277, 280, 155, 284, 286, 159, 160, 291, 292, 165, 293, 168, 46, 50, 180, 183, 184, 58, 62, 198, 204, 76, 95, 231, 232, 236, 111, 125, 247, 253}
[2025-04-30 06:29:00,360] 3 Nodes of Markov blanket: [12, 58, 168]
[2025-04-30 06:29:00,366] [MB metrics] precision: 1.000, recall: 0.064, acc: 0.850, f1: 0.120
[2025-04-30 06:29:07,490] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:29:07,490] sub_met2 before prunning None
[2025-04-30 06:29:07,490] sub_met after prunning None
[2025-04-30 06:29:07,490] 
===  13-th graph ===
[2025-04-30 06:29:07,490] 59 Nodes of True MB: [12, 13, 18, 40, 50, 55, 56, 67, 80, 82, 92, 94, 95, 102, 108, 109, 111, 118, 125, 130, 150, 151, 152, 155, 159, 160, 166, 168, 173, 180, 185, 189, 192, 194, 199, 201, 203, 204, 207, 220, 224, 230, 233, 234, 235, 236, 246, 248, 249, 251, 254, 260, 267, 269, 272, 277, 284, 291, 299], parents: {235}, children: {40, 201, 173, 277, 151, 185, 251, 189}, spouse: {130, 260, 267, 12, 13, 269, 272, 18, 277, 150, 152, 155, 284, 159, 160, 291, 166, 168, 299, 50, 180, 55, 56, 185, 192, 194, 67, 199, 203, 204, 207, 80, 82, 220, 92, 94, 95, 224, 102, 230, 233, 234, 236, 108, 109, 111, 246, 118, 248, 249, 125, 254}
[2025-04-30 06:29:07,490] 19 Nodes of Markov blanket: [13, 82, 92, 94, 102, 111, 118, 152, 155, 173, 194, 199, 203, 234, 246, 248, 251, 272, 277]
[2025-04-30 06:29:07,490] [MB metrics] precision: 1.000, recall: 0.322, acc: 0.867, f1: 0.487
[2025-04-30 06:29:27,865] sub_met2 before prunning None
[2025-04-30 06:29:27,865] sub_met after prunning {'fdr': 0.8462, 'tpr': 0.5556, 'fpr': 0.3595, 'shd': 60, 'nnz': 65, 'precision': 0.1538, 'recall': 0.5556, 'F1': 0.241, 'gscore': 0.0}
[2025-04-30 06:29:27,865] 
===  14-th graph ===
[2025-04-30 06:29:27,865] 9 Nodes of True MB: [14, 24, 30, 69, 192, 193, 198, 200, 247], parents: {192, 193, 69, 198, 200, 247, 24, 30}, children: set(), spouse: {14}
[2025-04-30 06:29:27,865] 
===  15-th graph ===
[2025-04-30 06:29:27,879] 34 Nodes of True MB: [15, 29, 36, 46, 57, 76, 81, 84, 88, 96, 102, 107, 126, 136, 140, 141, 152, 156, 164, 170, 175, 194, 200, 206, 208, 219, 232, 233, 239, 249, 266, 280, 295, 299], parents: {152, 233, 266}, children: {36, 249, 232, 81, 57}, spouse: {136, 266, 140, 141, 15, 280, 156, 29, 164, 295, 170, 299, 46, 175, 194, 200, 76, 206, 208, 84, 88, 219, 96, 102, 107, 239, 126}
[2025-04-30 06:29:27,879] 9 Nodes of Markov blanket: [15, 29, 46, 102, 126, 136, 156, 170, 175]
[2025-04-30 06:29:27,881] [MB metrics] precision: 1.000, recall: 0.265, acc: 0.917, f1: 0.419
[2025-04-30 06:29:43,612] sub_met2 before prunning None
[2025-04-30 06:29:43,612] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.4118, 'shd': 15, 'nnz': 14, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:29:43,612] 
===  16-th graph ===
[2025-04-30 06:29:43,612] 54 Nodes of True MB: [1, 16, 20, 24, 31, 33, 48, 50, 56, 62, 64, 69, 73, 77, 82, 85, 99, 107, 108, 111, 112, 115, 117, 122, 135, 142, 147, 160, 168, 171, 179, 181, 192, 195, 197, 200, 202, 203, 214, 231, 233, 241, 249, 255, 259, 260, 265, 267, 269, 276, 279, 280, 289, 292], parents: {202}, children: {160, 1, 69, 171, 241, 85, 280, 31}, spouse: {259, 260, 135, 265, 267, 269, 142, 16, 147, 20, 276, 279, 24, 33, 289, 292, 168, 48, 50, 179, 181, 56, 62, 192, 64, 195, 197, 200, 73, 203, 77, 82, 214, 99, 231, 233, 107, 108, 111, 112, 115, 117, 249, 122, 255}
[2025-04-30 06:29:43,624] 14 Nodes of Markov blanket: [16, 24, 48, 56, 85, 107, 111, 135, 179, 181, 197, 214, 267, 279]
[2025-04-30 06:29:43,628] [MB metrics] precision: 1.000, recall: 0.259, acc: 0.863, f1: 0.412
[2025-04-30 06:29:59,318] sub_met2 before prunning None
[2025-04-30 06:29:59,318] sub_met after prunning {'fdr': 0.9655, 'tpr': 0.125, 'fpr': 0.3373, 'shd': 34, 'nnz': 29, 'precision': 0.0345, 'recall': 0.125, 'F1': 0.0541, 'gscore': 0.0}
[2025-04-30 06:29:59,318] 
===  17-th graph ===
[2025-04-30 06:29:59,318] 9 Nodes of True MB: [12, 17, 165, 168, 231, 253, 276, 284, 293], parents: {165, 293, 231, 168, 12, 276, 284, 253}, children: set(), spouse: {17}
[2025-04-30 06:29:59,318] 
===  18-th graph ===
[2025-04-30 06:29:59,333] 50 Nodes of True MB: [13, 18, 20, 31, 53, 68, 70, 78, 82, 98, 100, 102, 104, 106, 107, 110, 111, 117, 130, 135, 140, 143, 147, 150, 151, 156, 164, 168, 176, 178, 180, 182, 183, 185, 202, 203, 211, 216, 220, 224, 230, 234, 244, 250, 251, 257, 260, 267, 276, 289], parents: {100, 107, 140, 110, 78, 147}, children: {98, 68, 70, 168, 106, 53, 151}, spouse: {257, 130, 260, 135, 267, 13, 143, 18, 276, 20, 150, 156, 31, 289, 164, 176, 178, 180, 182, 183, 185, 202, 203, 82, 211, 216, 220, 224, 230, 102, 104, 234, 111, 244, 117, 250, 251}
[2025-04-30 06:29:59,333] 14 Nodes of Markov blanket: [18, 20, 102, 104, 135, 147, 164, 180, 182, 211, 216, 230, 234, 276]
[2025-04-30 06:29:59,336] [MB metrics] precision: 1.000, recall: 0.280, acc: 0.876, f1: 0.438
[2025-04-30 06:30:14,644] sub_met2 before prunning None
[2025-04-30 06:30:14,655] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2619, 'shd': 29, 'nnz': 22, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:30:14,655] 
===  19-th graph ===
[2025-04-30 06:30:14,655] 10 Nodes of True MB: [19, 42, 48, 121, 140, 231, 234, 237, 248, 277], parents: {231, 42, 234, 140, 237, 48, 277, 248, 121}, children: set(), spouse: {19}
[2025-04-30 06:30:14,655] 
===  20-th graph ===
[2025-04-30 06:30:14,656] 83 Nodes of True MB: [1, 5, 9, 16, 18, 20, 24, 27, 31, 33, 36, 45, 46, 49, 50, 61, 63, 66, 69, 77, 82, 88, 92, 95, 98, 100, 101, 102, 110, 111, 119, 122, 131, 133, 135, 136, 140, 142, 143, 147, 148, 162, 163, 164, 165, 166, 168, 179, 180, 183, 185, 191, 192, 194, 195, 200, 202, 208, 211, 222, 224, 237, 241, 244, 245, 247, 249, 250, 255, 256, 257, 260, 263, 265, 268, 269, 285, 289, 291, 293, 297, 298, 299], parents: set(), children: {1, 66, 162, 101, 133, 263, 136, 168, 237, 143, 208, 211, 24, 250, 61, 222}, spouse: {256, 1, 257, 131, 260, 5, 135, 265, 9, 268, 269, 142, 140, 16, 18, 147, 20, 148, 27, 285, 31, 33, 289, 291, 36, 163, 166, 293, 164, 297, 298, 165, 299, 45, 46, 49, 50, 179, 180, 183, 185, 63, 192, 191, 66, 195, 194, 69, 200, 202, 77, 82, 88, 247, 92, 95, 224, 98, 100, 102, 110, 111, 241, 244, 245, 119, 249, 122, 255}
[2025-04-30 06:30:14,656] 14 Nodes of Markov blanket: [18, 20, 27, 45, 66, 135, 163, 165, 192, 200, 244, 249, 289, 293]
[2025-04-30 06:30:14,658] [MB metrics] precision: 1.000, recall: 0.169, acc: 0.770, f1: 0.289
[2025-04-30 06:30:31,274] sub_met2 before prunning None
[2025-04-30 06:30:31,274] sub_met after prunning {'fdr': 0.9677, 'tpr': 1.0, 'fpr': 0.3333, 'shd': 30, 'nnz': 31, 'precision': 0.0323, 'recall': 1.0, 'F1': 0.0625, 'gscore': 0.0}
[2025-04-30 06:30:31,274] 
===  21-th graph ===
[2025-04-30 06:30:31,274] 7 Nodes of True MB: [21, 43, 65, 131, 215, 288, 291], parents: {288, 65, 131, 291, 43, 215}, children: set(), spouse: {21}
[2025-04-30 06:30:31,274] 
===  22-th graph ===
[2025-04-30 06:30:31,274] 27 Nodes of True MB: [5, 22, 29, 66, 73, 92, 102, 107, 128, 133, 168, 174, 180, 183, 204, 208, 214, 221, 226, 234, 245, 246, 249, 251, 261, 275, 293], parents: {66, 246}, children: {261, 293, 5}, spouse: {128, 133, 275, 22, 29, 168, 174, 180, 183, 73, 204, 208, 214, 92, 221, 226, 102, 234, 107, 245, 249, 251}
[2025-04-30 06:30:31,274] 9 Nodes of Markov blanket: [22, 102, 174, 180, 204, 208, 226, 245, 251]
[2025-04-30 06:30:31,279] [MB metrics] precision: 1.000, recall: 0.333, acc: 0.939, f1: 0.500
[2025-04-30 06:30:47,397] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:30:47,397] sub_met2 before prunning None
[2025-04-30 06:30:47,397] sub_met after prunning None
[2025-04-30 06:30:47,397] 
===  23-th graph ===
[2025-04-30 06:30:47,397] 19 Nodes of True MB: [10, 23, 77, 87, 97, 100, 106, 123, 125, 135, 139, 141, 150, 160, 171, 190, 212, 221, 278], parents: {160, 97, 135, 10, 106, 278, 87, 123}, children: {212}, spouse: {100, 139, 171, 77, 141, 150, 23, 221, 125, 190}
[2025-04-30 06:30:47,397] 
===  24-th graph ===
[2025-04-30 06:30:47,397] 71 Nodes of True MB: [0, 5, 7, 10, 14, 16, 20, 24, 25, 27, 30, 33, 45, 59, 66, 69, 73, 90, 99, 102, 105, 110, 111, 112, 113, 118, 120, 122, 134, 142, 147, 148, 157, 160, 161, 163, 171, 175, 177, 180, 183, 191, 192, 193, 196, 197, 198, 200, 208, 216, 219, 223, 227, 233, 235, 240, 241, 247, 249, 260, 262, 264, 267, 270, 274, 276, 280, 282, 284, 285, 290], parents: {20, 285, 110, 183}, children: {160, 290, 163, 196, 262, 45, 14, 148}, spouse: {0, 260, 5, 134, 7, 264, 10, 267, 142, 270, 16, 274, 147, 276, 24, 25, 280, 27, 284, 157, 30, 282, 160, 33, 161, 171, 175, 177, 180, 59, 191, 192, 193, 66, 196, 69, 198, 197, 200, 73, 208, 216, 90, 219, 223, 99, 227, 102, 105, 233, 235, 111, 112, 113, 241, 240, 118, 247, 120, 249, 122}
[2025-04-30 06:30:47,397] 12 Nodes of Markov blanket: [16, 24, 105, 111, 180, 183, 192, 193, 198, 216, 233, 267]
[2025-04-30 06:30:47,405] [MB metrics] precision: 1.000, recall: 0.169, acc: 0.797, f1: 0.289
[2025-04-30 06:31:04,745] sub_met2 before prunning None
[2025-04-30 06:31:04,745] sub_met after prunning {'fdr': 0.9231, 'tpr': 0.3333, 'fpr': 0.1905, 'shd': 14, 'nnz': 13, 'precision': 0.0769, 'recall': 0.3333, 'F1': 0.125, 'gscore': 0.0}
[2025-04-30 06:31:04,745] 
===  25-th graph ===
[2025-04-30 06:31:04,745] 66 Nodes of True MB: [5, 6, 10, 24, 25, 33, 37, 38, 40, 47, 48, 50, 54, 59, 64, 66, 67, 70, 74, 76, 88, 90, 91, 101, 105, 107, 111, 113, 117, 121, 133, 141, 148, 152, 157, 178, 189, 191, 192, 194, 206, 218, 220, 221, 222, 224, 227, 232, 233, 236, 237, 242, 243, 249, 264, 268, 271, 272, 274, 275, 280, 282, 289, 290, 293, 294], parents: {194, 67, 221, 294}, children: {33, 290, 37, 268, 271, 242, 54}, spouse: {5, 133, 6, 264, 10, 141, 272, 274, 275, 148, 24, 25, 152, 280, 282, 157, 33, 289, 293, 38, 40, 47, 48, 178, 50, 59, 189, 191, 192, 64, 66, 67, 70, 74, 76, 206, 88, 90, 91, 218, 220, 222, 224, 121, 227, 101, 232, 233, 105, 107, 236, 237, 111, 113, 243, 117, 249}
[2025-04-30 06:31:04,745] 13 Nodes of Markov blanket: [25, 67, 76, 101, 105, 117, 133, 148, 191, 192, 224, 237, 289]
[2025-04-30 06:31:04,750] [MB metrics] precision: 1.000, recall: 0.197, acc: 0.820, f1: 0.329
[2025-04-30 06:31:21,185] sub_met2 before prunning None
[2025-04-30 06:31:21,185] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.4267, 'shd': 34, 'nnz': 32, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:31:21,194] 
===  26-th graph ===
[2025-04-30 06:31:21,194] 19 Nodes of True MB: [26, 38, 62, 82, 107, 111, 114, 123, 135, 145, 164, 180, 197, 214, 255, 261, 272, 281, 299], parents: {197, 299, 111, 82, 281, 62, 255}, children: {114, 123}, spouse: {164, 261, 38, 135, 107, 272, 145, 180, 214, 26}
[2025-04-30 06:31:21,194] 
===  27-th graph ===
[2025-04-30 06:31:21,194] 35 Nodes of True MB: [0, 20, 24, 27, 48, 73, 75, 82, 84, 98, 100, 104, 118, 120, 134, 136, 150, 157, 169, 189, 191, 196, 219, 223, 227, 228, 233, 241, 255, 256, 257, 260, 268, 277, 284], parents: {256, 100, 169, 48, 84}, children: {136, 196, 150}, spouse: {0, 257, 260, 134, 268, 20, 277, 24, 27, 284, 157, 189, 191, 73, 75, 82, 219, 223, 98, 227, 228, 104, 233, 241, 118, 120, 255}
[2025-04-30 06:31:21,194] 4 Nodes of Markov blanket: [20, 27, 75, 82]
[2025-04-30 06:31:21,199] [MB metrics] precision: 1.000, recall: 0.114, acc: 0.891, f1: 0.205
[2025-04-30 06:31:28,279] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:31:28,279] sub_met2 before prunning None
[2025-04-30 06:31:28,279] sub_met after prunning None
[2025-04-30 06:31:28,279] 
===  28-th graph ===
[2025-04-30 06:31:28,279] 19 Nodes of True MB: [5, 28, 66, 94, 97, 140, 153, 155, 158, 185, 189, 203, 223, 226, 252, 261, 283, 291, 295], parents: {226, 185, 203, 153, 189}, children: {283, 94}, spouse: {97, 66, 226, 291, 261, 5, 295, 140, 252, 155, 28, 158, 223}
[2025-04-30 06:31:28,279] 4 Nodes of Markov blanket: [28, 158, 226, 295]
[2025-04-30 06:31:28,289] [MB metrics] precision: 1.000, recall: 0.211, acc: 0.949, f1: 0.348
[2025-04-30 06:31:35,520] sub_met2 before prunning None
[2025-04-30 06:31:35,520] sub_met after prunning {'fdr': 0.8, 'tpr': 1.0, 'fpr': 0.8, 'shd': 4, 'nnz': 5, 'precision': 0.2, 'recall': 1.0, 'F1': 0.3333, 'gscore': 0.0}
[2025-04-30 06:31:35,520] 
===  29-th graph ===
[2025-04-30 06:31:35,520] 43 Nodes of True MB: [15, 22, 29, 36, 38, 44, 48, 56, 67, 82, 92, 96, 97, 101, 102, 104, 107, 120, 128, 133, 141, 143, 145, 179, 186, 199, 200, 204, 206, 208, 214, 224, 226, 227, 245, 249, 251, 255, 266, 287, 289, 293, 296], parents: {56, 266, 255}, children: {128, 227, 36, 293, 186}, spouse: {133, 141, 143, 15, 145, 22, 29, 287, 289, 38, 296, 44, 48, 179, 67, 199, 200, 204, 206, 208, 82, 214, 92, 96, 97, 226, 224, 101, 102, 104, 107, 245, 120, 249, 251}
[2025-04-30 06:31:35,520] 7 Nodes of Markov blanket: [15, 29, 104, 120, 199, 200, 249]
[2025-04-30 06:31:35,520] [MB metrics] precision: 1.000, recall: 0.163, acc: 0.879, f1: 0.280
[2025-04-30 06:31:48,768] sub_met2 before prunning None
[2025-04-30 06:31:48,768] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2632, 'shd': 7, 'nnz': 5, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:31:48,768] 
===  30-th graph ===
[2025-04-30 06:31:48,768] 43 Nodes of True MB: [0, 4, 5, 7, 14, 24, 30, 31, 47, 60, 64, 67, 69, 84, 88, 92, 103, 105, 106, 111, 115, 121, 140, 142, 144, 153, 168, 178, 181, 192, 193, 198, 200, 208, 210, 234, 240, 245, 247, 251, 253, 281, 285], parents: {144, 168, 142, 111}, children: {67, 105, 14, 47, 210, 60}, spouse: {0, 4, 5, 7, 140, 144, 24, 153, 281, 285, 30, 31, 178, 181, 192, 193, 64, 69, 198, 200, 208, 84, 88, 92, 103, 234, 106, 240, 115, 245, 247, 121, 251, 253}
[2025-04-30 06:31:48,774] 9 Nodes of Markov blanket: [0, 5, 30, 103, 115, 121, 198, 234, 240]
[2025-04-30 06:31:48,778] [MB metrics] precision: 1.000, recall: 0.209, acc: 0.881, f1: 0.346
[2025-04-30 06:32:03,668] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:32:03,668] sub_met2 before prunning None
[2025-04-30 06:32:03,668] sub_met after prunning None
[2025-04-30 06:32:03,668] 
===  31-th graph ===
[2025-04-30 06:32:03,668] 51 Nodes of True MB: [8, 16, 18, 20, 30, 31, 45, 46, 61, 66, 68, 77, 82, 84, 88, 102, 105, 111, 122, 131, 135, 140, 155, 159, 163, 165, 166, 174, 178, 183, 189, 194, 195, 202, 208, 224, 225, 234, 240, 245, 247, 249, 251, 255, 259, 263, 267, 275, 279, 289, 293], parents: {289, 259, 135, 16, 279}, children: {195, 68, 263, 8, 105, 77, 61}, spouse: {131, 267, 140, 18, 275, 20, 155, 30, 159, 31, 289, 163, 293, 166, 165, 45, 174, 46, 178, 183, 189, 194, 66, 202, 208, 82, 84, 88, 224, 225, 102, 234, 111, 240, 245, 247, 249, 122, 251, 255}
[2025-04-30 06:32:03,668] 13 Nodes of Markov blanket: [31, 45, 66, 102, 111, 131, 159, 163, 178, 194, 224, 234, 293]
[2025-04-30 06:32:03,668] [MB metrics] precision: 1.000, recall: 0.255, acc: 0.871, f1: 0.406
[2025-04-30 06:32:19,774] sub_met2 before prunning None
[2025-04-30 06:32:19,774] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.25, 'shd': 21, 'nnz': 19, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:32:19,774] 
===  32-th graph ===
[2025-04-30 06:32:19,774] 43 Nodes of True MB: [10, 32, 48, 49, 51, 57, 59, 66, 68, 75, 78, 90, 96, 97, 101, 109, 120, 122, 128, 139, 140, 141, 144, 154, 156, 158, 164, 176, 177, 182, 191, 215, 223, 224, 226, 239, 246, 247, 248, 251, 285, 296, 298], parents: {285, 298, 141, 246}, children: {96, 139, 177, 182, 247, 158}, spouse: {128, 10, 140, 141, 144, 154, 156, 32, 164, 296, 48, 49, 176, 51, 57, 59, 191, 66, 68, 75, 78, 215, 90, 120, 223, 224, 97, 226, 101, 109, 239, 248, 122, 251}
[2025-04-30 06:32:19,774] 12 Nodes of Markov blanket: [32, 59, 66, 68, 75, 128, 141, 154, 164, 191, 215, 251]
[2025-04-30 06:32:19,783] [MB metrics] precision: 1.000, recall: 0.279, acc: 0.896, f1: 0.436
[2025-04-30 06:32:36,042] sub_met2 before prunning None
[2025-04-30 06:32:36,042] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.4531, 'shd': 31, 'nnz': 29, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:32:36,042] 
===  33-th graph ===
[2025-04-30 06:32:36,042] 54 Nodes of True MB: [1, 6, 7, 16, 20, 24, 25, 33, 37, 40, 43, 47, 48, 50, 70, 74, 77, 82, 88, 90, 91, 102, 103, 107, 117, 118, 141, 142, 152, 171, 175, 178, 189, 192, 195, 206, 208, 222, 229, 232, 233, 235, 242, 247, 249, 262, 265, 269, 272, 273, 275, 280, 284, 293], parents: {293, 232, 233, 141, 206, 275, 88, 25, 90, 152, 222}, children: {1, 37, 262, 273, 242}, spouse: {6, 7, 265, 269, 142, 16, 272, 20, 24, 25, 280, 284, 33, 40, 171, 43, 47, 48, 175, 50, 178, 189, 192, 195, 70, 74, 77, 208, 82, 88, 91, 229, 102, 103, 235, 107, 117, 118, 247, 249}
[2025-04-30 06:32:36,057] 12 Nodes of Markov blanket: [33, 47, 50, 88, 118, 171, 192, 195, 229, 247, 265, 269]
[2025-04-30 06:32:36,061] [MB metrics] precision: 1.000, recall: 0.222, acc: 0.857, f1: 0.364
[2025-04-30 06:32:53,062] sub_met2 before prunning None
[2025-04-30 06:32:53,062] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3125, 'shd': 22, 'nnz': 20, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:32:53,062] 
===  34-th graph ===
[2025-04-30 06:32:53,062] 7 Nodes of True MB: [34, 68, 98, 110, 179, 222, 250], parents: {98, 68, 110, 179, 250, 222}, children: set(), spouse: {34}
[2025-04-30 06:32:53,066] 
===  35-th graph ===
[2025-04-30 06:32:53,066] 10 Nodes of True MB: [35, 55, 70, 73, 133, 140, 156, 239, 253, 256], parents: {256, 133, 70, 73, 140, 239, 55, 156, 253}, children: set(), spouse: {35}
[2025-04-30 06:32:53,066] 
===  36-th graph ===
[2025-04-30 06:32:53,066] 32 Nodes of True MB: [1, 5, 15, 20, 29, 36, 67, 88, 92, 96, 107, 109, 113, 119, 129, 141, 142, 148, 162, 170, 184, 185, 200, 206, 222, 232, 241, 256, 257, 286, 291, 298], parents: {96, 200, 107, 141, 206, 15, 29}, children: {162, 286}, spouse: {256, 1, 257, 129, 5, 142, 20, 148, 291, 36, 298, 170, 184, 185, 67, 88, 92, 222, 232, 107, 109, 241, 113, 119}
[2025-04-30 06:32:53,066] 9 Nodes of Markov blanket: [36, 67, 88, 107, 109, 170, 184, 222, 232]
[2025-04-30 06:32:53,070] [MB metrics] precision: 1.000, recall: 0.281, acc: 0.923, f1: 0.439
[2025-04-30 06:33:08,396] sub_met2 before prunning None
[2025-04-30 06:33:08,396] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3143, 'shd': 12, 'nnz': 11, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:33:08,396] 
===  37-th graph ===
[2025-04-30 06:33:08,396] 15 Nodes of True MB: [6, 25, 33, 37, 47, 48, 70, 91, 92, 97, 137, 159, 178, 187, 272], parents: {33, 70, 47, 48, 272, 178, 25, 91}, children: {137}, spouse: {97, 37, 6, 187, 92, 159}
[2025-04-30 06:33:08,396] 
===  38-th graph ===
[2025-04-30 06:33:08,396] 59 Nodes of True MB: [12, 25, 26, 29, 38, 39, 50, 66, 67, 69, 74, 97, 100, 101, 103, 104, 107, 120, 122, 123, 124, 126, 129, 133, 135, 140, 142, 161, 164, 168, 170, 180, 181, 186, 191, 195, 197, 199, 211, 214, 221, 223, 224, 225, 236, 237, 243, 244, 248, 249, 264, 265, 268, 270, 272, 275, 277, 282, 289], parents: {236, 243, 244, 248, 221}, children: {39, 265, 12, 268, 270, 186, 123, 126}, spouse: {129, 133, 135, 264, 140, 142, 270, 272, 275, 277, 25, 282, 26, 29, 161, 289, 164, 38, 168, 170, 50, 180, 181, 191, 66, 67, 195, 197, 69, 199, 74, 211, 214, 223, 224, 97, 225, 100, 101, 103, 104, 107, 237, 120, 249, 122, 124}
[2025-04-30 06:33:08,396] 10 Nodes of Markov blanket: [38, 50, 97, 104, 140, 170, 199, 211, 223, 249]
[2025-04-30 06:33:08,405] [MB metrics] precision: 1.000, recall: 0.169, acc: 0.831, f1: 0.290
[2025-04-30 06:33:23,309] sub_met2 before prunning None
[2025-04-30 06:33:23,309] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2955, 'shd': 14, 'nnz': 13, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:33:23,309] 
===  39-th graph ===
[2025-04-30 06:33:23,309] 41 Nodes of True MB: [0, 3, 38, 39, 50, 64, 82, 86, 89, 97, 100, 101, 120, 124, 125, 133, 134, 140, 142, 148, 157, 170, 185, 186, 191, 197, 207, 211, 222, 223, 225, 226, 247, 251, 255, 262, 265, 266, 277, 287, 292], parents: {97, 100, 197, 38, 170, 140, 142, 50, 211, 277, 120, 223}, children: {89, 3, 86}, spouse: {0, 133, 134, 262, 265, 266, 148, 157, 287, 292, 39, 185, 186, 191, 64, 207, 82, 222, 225, 226, 101, 247, 251, 124, 125, 255}
[2025-04-30 06:33:23,315] 4 Nodes of Markov blanket: [39, 157, 207, 266]
[2025-04-30 06:33:23,318] [MB metrics] precision: 1.000, recall: 0.098, acc: 0.874, f1: 0.178
[2025-04-30 06:33:30,475] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:33:30,475] sub_met2 before prunning None
[2025-04-30 06:33:30,475] sub_met after prunning None
[2025-04-30 06:33:30,475] 
===  40-th graph ===
[2025-04-30 06:33:30,475] 53 Nodes of True MB: [4, 6, 10, 13, 25, 33, 40, 47, 58, 72, 74, 85, 95, 107, 110, 111, 112, 117, 135, 142, 148, 152, 155, 161, 166, 168, 181, 185, 189, 190, 192, 193, 194, 197, 201, 213, 218, 233, 242, 246, 248, 251, 253, 258, 259, 261, 264, 273, 281, 282, 284, 298, 299], parents: {194, 168, 233, 13, 246, 152, 185, 155}, children: {193, 72, 242, 213, 58}, spouse: {258, 259, 4, 261, 6, 135, 264, 10, 142, 273, 148, 25, 282, 281, 284, 161, 33, 166, 40, 298, 299, 47, 181, 189, 190, 192, 197, 201, 74, 85, 218, 95, 107, 110, 111, 112, 117, 248, 251, 253}
[2025-04-30 06:33:30,475] 9 Nodes of Markov blanket: [10, 40, 74, 85, 95, 181, 189, 218, 261]
[2025-04-30 06:33:30,475] [MB metrics] precision: 1.000, recall: 0.170, acc: 0.853, f1: 0.290
[2025-04-30 06:33:45,229] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:33:45,229] sub_met2 before prunning None
[2025-04-30 06:33:45,229] sub_met after prunning None
[2025-04-30 06:33:45,229] 
===  41-th graph ===
[2025-04-30 06:33:45,244] 10 Nodes of True MB: [6, 41, 74, 112, 118, 158, 201, 206, 245, 293], parents: {293, 6, 201, 74, 206, 112, 245, 118, 158}, children: set(), spouse: {41}
[2025-04-30 06:33:45,244] 
===  42-th graph ===
[2025-04-30 06:33:45,244] 31 Nodes of True MB: [0, 19, 42, 47, 48, 71, 79, 84, 86, 93, 121, 123, 131, 140, 167, 182, 185, 192, 199, 231, 232, 234, 237, 241, 244, 245, 248, 252, 271, 275, 277], parents: {0, 192, 232, 234, 47, 271, 245, 93}, children: {167, 19, 79}, spouse: {131, 140, 275, 277, 42, 48, 182, 185, 71, 199, 84, 86, 231, 234, 237, 241, 244, 248, 121, 123, 252}
[2025-04-30 06:33:45,245] 8 Nodes of Markov blanket: [42, 48, 121, 123, 140, 182, 185, 234]
[2025-04-30 06:33:45,248] [MB metrics] precision: 1.000, recall: 0.258, acc: 0.917, f1: 0.410
[2025-04-30 06:34:02,175] sub_met2 before prunning None
[2025-04-30 06:34:02,175] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3846, 'shd': 12, 'nnz': 10, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:34:02,175] 
===  43-th graph ===
[2025-04-30 06:34:02,175] 21 Nodes of True MB: [21, 33, 43, 62, 65, 88, 102, 103, 111, 131, 142, 185, 186, 215, 229, 247, 273, 280, 284, 288, 291], parents: {102, 111, 185, 186, 62}, children: {273, 21}, spouse: {288, 33, 280, 65, 131, 229, 102, 103, 291, 43, 142, 247, 88, 215, 284}
[2025-04-30 06:34:02,175] 3 Nodes of Markov blanket: [43, 131, 291]
[2025-04-30 06:34:02,187] [MB metrics] precision: 1.000, recall: 0.143, acc: 0.938, f1: 0.250
[2025-04-30 06:34:08,656] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:34:08,656] sub_met2 before prunning None
[2025-04-30 06:34:08,656] sub_met after prunning None
[2025-04-30 06:34:08,656] 
===  44-th graph ===
[2025-04-30 06:34:08,656] 38 Nodes of True MB: [11, 29, 44, 45, 48, 70, 82, 84, 87, 92, 97, 101, 116, 117, 119, 120, 122, 129, 135, 141, 142, 149, 166, 169, 182, 184, 190, 202, 224, 227, 229, 270, 277, 283, 286, 293, 294, 295], parents: {294, 117, 141, 270}, children: {184, 11, 229, 227}, spouse: {129, 135, 141, 142, 277, 149, 283, 29, 286, 293, 166, 295, 169, 44, 45, 48, 182, 184, 190, 70, 202, 82, 84, 87, 92, 224, 97, 101, 116, 119, 120, 122}
[2025-04-30 06:34:08,656] 6 Nodes of Markov blanket: [44, 45, 48, 97, 101, 120]
[2025-04-30 06:34:08,656] [MB metrics] precision: 1.000, recall: 0.158, acc: 0.892, f1: 0.273
[2025-04-30 06:34:18,773] sub_met2 before prunning None
[2025-04-30 06:34:18,773] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.7857, 'shd': 12, 'nnz': 11, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:34:18,773] 
===  45-th graph ===
[2025-04-30 06:34:18,773] 48 Nodes of True MB: [20, 24, 31, 44, 45, 66, 69, 75, 83, 97, 105, 107, 111, 112, 116, 135, 141, 142, 149, 152, 163, 177, 180, 182, 183, 184, 186, 187, 190, 191, 194, 196, 202, 209, 216, 218, 222, 233, 246, 247, 255, 258, 260, 263, 277, 289, 293, 295], parents: {196, 69, 233, 111, 112, 177, 180, 247, 24, 216}, children: {184, 209, 83, 263}, spouse: {258, 260, 135, 141, 142, 20, 277, 149, 152, 31, 289, 163, 293, 295, 44, 45, 182, 183, 186, 187, 190, 191, 66, 194, 202, 75, 218, 222, 97, 105, 107, 111, 116, 246, 247, 255}
[2025-04-30 06:34:18,773] 17 Nodes of Markov blanket: [20, 31, 44, 45, 66, 97, 111, 116, 141, 163, 182, 190, 194, 258, 277, 289, 293]
[2025-04-30 06:34:18,777] [MB metrics] precision: 1.000, recall: 0.354, acc: 0.895, f1: 0.523
[2025-04-30 06:34:37,809] sub_met2 before prunning None
[2025-04-30 06:34:37,809] sub_met after prunning {'fdr': 0.9778, 'tpr': 0.2, 'fpr': 0.3359, 'shd': 48, 'nnz': 45, 'precision': 0.0222, 'recall': 0.2, 'F1': 0.04, 'gscore': 0.0}
[2025-04-30 06:34:37,809] 
===  46-th graph ===
[2025-04-30 06:34:37,809] 59 Nodes of True MB: [5, 11, 12, 15, 20, 31, 46, 56, 57, 61, 62, 66, 76, 78, 81, 82, 88, 92, 107, 115, 117, 126, 130, 136, 156, 159, 164, 165, 168, 170, 174, 175, 176, 183, 184, 192, 194, 205, 208, 219, 222, 238, 241, 242, 246, 249, 253, 255, 257, 266, 276, 280, 284, 286, 287, 292, 295, 297, 298], parents: {194, 246}, children: {130, 238, 176, 81, 156, 61, 255}, spouse: {257, 5, 136, 266, 11, 12, 15, 276, 20, 280, 284, 156, 286, 159, 287, 31, 292, 164, 165, 295, 168, 297, 170, 298, 46, 175, 174, 183, 184, 56, 57, 61, 62, 192, 66, 194, 76, 205, 78, 208, 82, 88, 219, 92, 222, 107, 241, 242, 115, 117, 249, 253, 126}
[2025-04-30 06:34:37,811] 27 Nodes of Markov blanket: [5, 11, 15, 46, 56, 57, 61, 66, 78, 82, 92, 107, 115, 117, 156, 164, 170, 174, 175, 192, 194, 208, 219, 241, 280, 287, 292]
[2025-04-30 06:34:37,814] [MB metrics] precision: 1.000, recall: 0.458, acc: 0.893, f1: 0.628
[2025-04-30 06:34:58,098] sub_met2 before prunning None
[2025-04-30 06:34:58,098] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.0721, 'shd': 42, 'nnz': 24, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:34:58,098] 
===  47-th graph ===
[2025-04-30 06:34:58,098] 39 Nodes of True MB: [0, 6, 7, 25, 30, 33, 37, 40, 42, 47, 48, 65, 70, 73, 74, 76, 91, 92, 93, 106, 107, 117, 121, 133, 144, 169, 178, 189, 192, 221, 226, 232, 234, 242, 245, 255, 271, 272, 295], parents: {7, 106, 144, 121, 92, 30}, children: {65, 42, 242, 37}, spouse: {0, 133, 6, 271, 272, 25, 33, 295, 40, 169, 47, 48, 178, 189, 192, 70, 73, 74, 76, 91, 93, 221, 226, 232, 234, 107, 245, 117, 255}
[2025-04-30 06:34:58,102] 8 Nodes of Markov blanket: [33, 47, 65, 73, 117, 178, 221, 255]
[2025-04-30 06:34:58,105] [MB metrics] precision: 1.000, recall: 0.205, acc: 0.895, f1: 0.340
[2025-04-30 06:35:15,346] sub_met2 before prunning None
[2025-04-30 06:35:15,346] sub_met after prunning {'fdr': 0.7222, 'tpr': 1.0, 'fpr': 0.5652, 'shd': 13, 'nnz': 18, 'precision': 0.2778, 'recall': 1.0, 'F1': 0.4348, 'gscore': 0.0}
[2025-04-30 06:35:15,346] 
===  48-th graph ===
[2025-04-30 06:35:15,346] 69 Nodes of True MB: [16, 19, 25, 27, 29, 32, 33, 37, 42, 44, 47, 48, 49, 56, 59, 69, 70, 82, 84, 85, 91, 92, 97, 100, 101, 102, 108, 120, 121, 124, 128, 134, 135, 139, 140, 143, 144, 145, 156, 164, 169, 170, 178, 179, 180, 181, 191, 197, 200, 211, 214, 215, 219, 223, 227, 231, 234, 237, 248, 255, 256, 257, 259, 267, 272, 274, 277, 287, 296], parents: {49, 69, 257}, children: {128, 227, 37, 170, 139, 272, 19, 85, 215, 27}, spouse: {256, 259, 134, 135, 267, 140, 143, 272, 145, 16, 144, 274, 277, 25, 156, 29, 287, 32, 33, 164, 296, 169, 42, 44, 47, 48, 178, 179, 180, 181, 56, 59, 191, 197, 70, 200, 82, 211, 84, 214, 91, 92, 219, 223, 248, 97, 100, 101, 102, 231, 234, 108, 237, 120, 121, 124, 255}
[2025-04-30 06:35:15,346] 30 Nodes of Markov blanket: [16, 42, 44, 48, 70, 91, 97, 101, 102, 108, 120, 121, 124, 135, 140, 144, 169, 178, 179, 180, 197, 211, 214, 227, 234, 257, 259, 272, 274, 277]
[2025-04-30 06:35:15,355] [MB metrics] precision: 1.000, recall: 0.435, acc: 0.869, f1: 0.606
[2025-04-30 06:35:36,722] sub_met2 before prunning None
[2025-04-30 06:35:36,722] sub_met after prunning {'fdr': 0.9388, 'tpr': 0.25, 'fpr': 0.2238, 'shd': 107, 'nnz': 98, 'precision': 0.0612, 'recall': 0.25, 'F1': 0.0984, 'gscore': 0.0}
[2025-04-30 06:35:36,722] 
===  49-th graph ===
[2025-04-30 06:35:36,722] 32 Nodes of True MB: [10, 20, 32, 48, 49, 63, 66, 69, 96, 97, 109, 122, 129, 135, 145, 152, 155, 161, 169, 179, 191, 233, 237, 239, 245, 250, 257, 260, 287, 294, 296, 297], parents: set(), children: {96, 129, 294, 237, 48}, spouse: {257, 260, 135, 10, 145, 20, 152, 155, 287, 32, 161, 296, 169, 297, 49, 179, 63, 191, 66, 69, 96, 97, 122, 233, 109, 239, 245, 250}
[2025-04-30 06:35:36,722] 5 Nodes of Markov blanket: [49, 155, 191, 257, 287]
[2025-04-30 06:35:36,729] [MB metrics] precision: 1.000, recall: 0.156, acc: 0.909, f1: 0.270
[2025-04-30 06:35:44,019] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:35:44,019] sub_met2 before prunning None
[2025-04-30 06:35:44,019] sub_met after prunning None
[2025-04-30 06:35:44,019] 
===  50-th graph ===
[2025-04-30 06:35:44,019] 61 Nodes of True MB: [1, 12, 13, 16, 20, 25, 33, 38, 39, 50, 64, 66, 67, 76, 77, 82, 95, 97, 100, 103, 105, 108, 109, 111, 120, 125, 129, 135, 140, 142, 148, 152, 155, 159, 160, 161, 170, 180, 192, 195, 197, 201, 204, 211, 219, 223, 233, 235, 236, 237, 243, 245, 249, 265, 267, 269, 270, 271, 277, 288, 289], parents: set(), children: {288, 1, 39, 201, 108, 12, 111, 271}, spouse: {129, 135, 265, 267, 140, 269, 142, 12, 16, 13, 270, 20, 277, 148, 152, 25, 155, 159, 160, 33, 161, 289, 38, 170, 50, 180, 64, 192, 66, 195, 67, 197, 204, 77, 76, 82, 211, 219, 223, 95, 97, 100, 103, 233, 105, 235, 108, 109, 236, 237, 243, 245, 120, 249, 125}
[2025-04-30 06:35:44,019] 16 Nodes of Markov blanket: [33, 38, 50, 64, 66, 103, 109, 129, 155, 192, 195, 249, 265, 267, 270, 277]
[2025-04-30 06:35:44,019] [MB metrics] precision: 1.000, recall: 0.262, acc: 0.845, f1: 0.416
[2025-04-30 06:36:02,457] sub_met2 before prunning None
[2025-04-30 06:36:02,457] sub_met after prunning {'fdr': 0.94, 'tpr': 0.4286, 'fpr': 0.4159, 'shd': 51, 'nnz': 50, 'precision': 0.06, 'recall': 0.4286, 'F1': 0.1053, 'gscore': 0.0}
[2025-04-30 06:36:02,457] 
===  51-th graph ===
[2025-04-30 06:36:02,457] 17 Nodes of True MB: [32, 51, 57, 71, 110, 118, 135, 140, 166, 171, 176, 182, 183, 224, 248, 261, 293], parents: {261, 166, 135, 71, 293, 171, 110, 118, 183}, children: {182}, spouse: {32, 224, 140, 176, 51, 248, 57}
[2025-04-30 06:36:02,457] 3 Nodes of Markov blanket: [51, 57, 176]
[2025-04-30 06:36:02,457] [MB metrics] precision: 1.000, recall: 0.176, acc: 0.952, f1: 0.300
[2025-04-30 06:36:09,520] sub_met2 before prunning None
[2025-04-30 06:36:09,520] sub_met after prunning {'fdr': 0.6667, 'tpr': 1.0, 'fpr': 1.0, 'shd': 2, 'nnz': 3, 'precision': 0.3333, 'recall': 1.0, 'F1': 0.5, 'gscore': 0.0}
[2025-04-30 06:36:09,520] 
===  52-th graph ===
[2025-04-30 06:36:09,520] 11 Nodes of True MB: [12, 52, 58, 111, 134, 143, 168, 198, 232, 247, 291], parents: {291, 134, 198, 168, 232, 12, 143, 111, 247, 58}, children: set(), spouse: {52}
[2025-04-30 06:36:09,520] 
===  53-th graph ===
[2025-04-30 06:36:09,520] 9 Nodes of True MB: [18, 53, 164, 176, 182, 185, 216, 234, 250], parents: {164, 234, 176, 18, 182, 216, 185, 250}, children: set(), spouse: {53}
[2025-04-30 06:36:09,520] 
===  54-th graph ===
[2025-04-30 06:36:09,520] 18 Nodes of True MB: [7, 25, 54, 64, 76, 103, 121, 134, 138, 178, 193, 209, 218, 220, 227, 232, 262, 290], parents: {64, 121, 227, 25, 218, 220}, children: {138}, spouse: {193, 290, 134, 103, 7, 232, 262, 76, 209, 178, 54}
[2025-04-30 06:36:09,520] 5 Nodes of Markov blanket: [7, 54, 134, 178, 232]
[2025-04-30 06:36:09,520] [MB metrics] precision: 1.000, recall: 0.278, acc: 0.955, f1: 0.435
[2025-04-30 06:36:16,995] sub_met2 before prunning None
[2025-04-30 06:36:16,995] sub_met after prunning {'fdr': 0.8, 'tpr': 1.0, 'fpr': 0.4444, 'shd': 4, 'nnz': 5, 'precision': 0.2, 'recall': 1.0, 'F1': 0.3333, 'gscore': 0.0}
[2025-04-30 06:36:16,995] 
===  55-th graph ===
[2025-04-30 06:36:16,995] 50 Nodes of True MB: [13, 35, 55, 56, 64, 66, 68, 70, 73, 75, 98, 100, 102, 104, 108, 109, 111, 113, 119, 121, 127, 128, 132, 133, 135, 140, 156, 158, 159, 163, 166, 177, 179, 199, 202, 208, 218, 234, 235, 239, 251, 253, 256, 261, 264, 269, 270, 277, 281, 284], parents: {109, 119, 281, 218, 251, 158}, children: {35, 132, 269, 277, 127}, spouse: {256, 128, 133, 261, 135, 264, 140, 13, 270, 277, 284, 156, 159, 163, 166, 177, 179, 55, 56, 64, 66, 68, 70, 199, 73, 202, 75, 208, 98, 100, 102, 104, 234, 235, 108, 239, 111, 113, 121, 253}
[2025-04-30 06:36:16,995] 8 Nodes of Markov blanket: [55, 100, 113, 119, 163, 166, 261, 264]
[2025-04-30 06:36:16,995] [MB metrics] precision: 1.000, recall: 0.160, acc: 0.853, f1: 0.276
[2025-04-30 06:36:34,903] sub_met2 before prunning None
[2025-04-30 06:36:34,903] sub_met after prunning {'fdr': 0.8571, 'tpr': 1.0, 'fpr': 0.2222, 'shd': 6, 'nnz': 7, 'precision': 0.1429, 'recall': 1.0, 'F1': 0.25, 'gscore': 0.0}
[2025-04-30 06:36:34,903] 
===  56-th graph ===
[2025-04-30 06:36:34,903] 49 Nodes of True MB: [5, 10, 11, 13, 16, 29, 46, 48, 55, 56, 61, 66, 82, 85, 88, 91, 95, 97, 100, 102, 108, 111, 115, 130, 141, 142, 166, 183, 194, 197, 199, 200, 214, 226, 234, 242, 243, 250, 255, 260, 266, 267, 274, 276, 277, 279, 292, 294, 298], parents: set(), children: {130, 100, 260, 274, 243, 85, 277, 29, 95}, spouse: {5, 10, 11, 266, 141, 142, 267, 16, 13, 276, 279, 292, 294, 166, 298, 46, 48, 183, 56, 55, 61, 66, 194, 197, 199, 200, 82, 214, 88, 91, 97, 226, 102, 234, 108, 111, 242, 115, 250, 255}
[2025-04-30 06:36:34,903] 12 Nodes of Markov blanket: [5, 11, 16, 46, 56, 61, 115, 142, 197, 214, 255, 276]
[2025-04-30 06:36:34,903] [MB metrics] precision: 1.000, recall: 0.245, acc: 0.876, f1: 0.393
[2025-04-30 06:36:51,396] sub_met2 before prunning None
[2025-04-30 06:36:51,396] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.0469, 'shd': 5, 'nnz': 3, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:36:51,396] 
===  57-th graph ===
[2025-04-30 06:36:51,396] 22 Nodes of True MB: [15, 32, 46, 51, 57, 78, 88, 102, 140, 176, 182, 205, 222, 224, 239, 241, 248, 253, 257, 266, 297, 299], parents: {102, 266, 299, 239, 15, 88}, children: {176, 182}, spouse: {32, 257, 224, 297, 140, 205, 46, 78, 176, 241, 51, 248, 57, 253, 222}
[2025-04-30 06:36:51,396] 8 Nodes of Markov blanket: [46, 51, 57, 78, 176, 222, 241, 257]
[2025-04-30 06:36:51,410] [MB metrics] precision: 1.000, recall: 0.364, acc: 0.953, f1: 0.533
[2025-04-30 06:37:09,073] sub_met2 before prunning None
[2025-04-30 06:37:09,073] sub_met after prunning {'fdr': 0.9091, 'tpr': 0.1667, 'fpr': 0.4545, 'shd': 15, 'nnz': 11, 'precision': 0.0909, 'recall': 0.1667, 'F1': 0.1176, 'gscore': 0.0}
[2025-04-30 06:37:09,073] 
===  58-th graph ===
[2025-04-30 06:37:09,073] 20 Nodes of True MB: [12, 40, 52, 58, 74, 85, 95, 110, 111, 134, 143, 168, 181, 198, 232, 247, 248, 258, 261, 291], parents: {258, 261, 40, 74, 110, 85, 181, 248, 95}, children: {52}, spouse: {291, 134, 198, 168, 232, 12, 143, 111, 247, 58}
[2025-04-30 06:37:09,073] 5 Nodes of Markov blanket: [12, 58, 168, 198, 291]
[2025-04-30 06:37:09,087] [MB metrics] precision: 1.000, recall: 0.250, acc: 0.949, f1: 0.400
[2025-04-30 06:37:16,564] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:37:16,564] sub_met2 before prunning None
[2025-04-30 06:37:16,564] sub_met after prunning None
[2025-04-30 06:37:16,580] 
===  59-th graph ===
[2025-04-30 06:37:16,580] 44 Nodes of True MB: [0, 2, 5, 9, 10, 24, 25, 32, 48, 59, 61, 66, 73, 76, 90, 91, 105, 111, 113, 125, 139, 156, 157, 164, 181, 191, 195, 198, 208, 223, 225, 228, 232, 235, 244, 249, 266, 269, 274, 278, 280, 290, 295, 298], parents: {225, 266, 235}, children: {2, 290, 139, 76, 278}, spouse: {0, 5, 9, 10, 269, 274, 24, 25, 280, 156, 157, 32, 164, 295, 298, 48, 181, 59, 61, 191, 66, 195, 198, 73, 208, 90, 91, 223, 228, 232, 105, 111, 113, 244, 249, 125}
[2025-04-30 06:37:16,580] 12 Nodes of Markov blanket: [5, 9, 32, 59, 73, 105, 111, 157, 191, 208, 244, 298]
[2025-04-30 06:37:16,580] [MB metrics] precision: 1.000, recall: 0.273, acc: 0.893, f1: 0.429
[2025-04-30 06:37:33,829] sub_met2 before prunning None
[2025-04-30 06:37:33,829] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.4688, 'shd': 32, 'nnz': 30, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:37:33,829] 
===  60-th graph ===
[2025-04-30 06:37:33,829] 8 Nodes of True MB: [0, 5, 30, 60, 64, 88, 115, 153], parents: {0, 64, 5, 115, 88, 153, 30}, children: set(), spouse: {60}
[2025-04-30 06:37:33,829] 
===  61-th graph ===
[2025-04-30 06:37:33,829] 27 Nodes of True MB: [0, 2, 5, 11, 20, 31, 46, 56, 59, 61, 66, 82, 91, 115, 125, 130, 165, 181, 194, 195, 198, 228, 232, 242, 249, 269, 292], parents: {165, 46, 20, 249, 31}, children: {2, 130}, spouse: {0, 5, 11, 269, 292, 46, 181, 56, 59, 61, 66, 195, 194, 198, 82, 91, 228, 232, 242, 115, 125}
[2025-04-30 06:37:33,829] 7 Nodes of Markov blanket: [11, 46, 56, 61, 66, 82, 115]
[2025-04-30 06:37:33,835] [MB metrics] precision: 1.000, recall: 0.259, acc: 0.932, f1: 0.412
[2025-04-30 06:37:46,932] sub_met2 before prunning None
[2025-04-30 06:37:46,932] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.0526, 'shd': 3, 'nnz': 1, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:37:46,932] 
===  62-th graph ===
[2025-04-30 06:37:46,932] 37 Nodes of True MB: [12, 16, 26, 43, 46, 62, 64, 73, 76, 82, 102, 107, 111, 140, 152, 159, 168, 171, 179, 181, 183, 184, 185, 186, 197, 231, 233, 234, 238, 255, 276, 280, 281, 284, 286, 292, 299], parents: {152, 234, 140}, children: {26, 43, 171, 238}, spouse: {12, 16, 276, 280, 281, 284, 286, 159, 292, 168, 299, 46, 179, 181, 183, 184, 185, 186, 62, 64, 197, 73, 76, 82, 102, 231, 233, 107, 111, 255}
[2025-04-30 06:37:46,933] 7 Nodes of Markov blanket: [62, 82, 111, 152, 197, 255, 281]
[2025-04-30 06:37:46,937] [MB metrics] precision: 1.000, recall: 0.189, acc: 0.900, f1: 0.318
[2025-04-30 06:37:59,624] sub_met2 before prunning None
[2025-04-30 06:37:59,624] sub_met after prunning {'fdr': 0.4286, 'tpr': 1.0, 'fpr': 0.1765, 'shd': 3, 'nnz': 7, 'precision': 0.5714, 'recall': 1.0, 'F1': 0.7273, 'gscore': 0.25}
[2025-04-30 06:37:59,624] 
===  63-th graph ===
[2025-04-30 06:37:59,624] 19 Nodes of True MB: [20, 49, 63, 66, 88, 96, 100, 118, 129, 135, 145, 147, 161, 166, 169, 174, 233, 284, 294], parents: {174}, children: {129, 66, 118}, spouse: {96, 161, 66, 100, 166, 135, 294, 169, 233, 49, 145, 147, 20, 88, 284, 63}
[2025-04-30 06:37:59,624] 5 Nodes of Markov blanket: [63, 145, 147, 161, 166]
[2025-04-30 06:37:59,624] [MB metrics] precision: 1.000, recall: 0.263, acc: 0.953, f1: 0.417
[2025-04-30 06:38:07,073] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:38:07,073] sub_met2 before prunning None
[2025-04-30 06:38:07,073] sub_met after prunning None
[2025-04-30 06:38:07,073] 
===  64-th graph ===
[2025-04-30 06:38:07,073] 71 Nodes of True MB: [0, 5, 16, 25, 30, 39, 50, 54, 55, 60, 62, 64, 67, 68, 73, 75, 86, 88, 99, 104, 107, 108, 109, 113, 115, 121, 124, 128, 133, 135, 153, 155, 156, 157, 159, 163, 171, 177, 179, 181, 199, 202, 206, 207, 208, 215, 216, 218, 219, 220, 222, 226, 227, 231, 233, 235, 236, 239, 243, 244, 245, 250, 254, 264, 265, 266, 267, 269, 272, 288, 292], parents: {67, 236, 243, 215}, children: {288, 199, 264, 171, 269, 113, 86, 54, 216, 60}, spouse: {128, 0, 133, 5, 135, 265, 266, 267, 16, 272, 25, 153, 155, 156, 157, 30, 159, 163, 292, 39, 177, 50, 179, 181, 55, 62, 64, 67, 68, 73, 202, 75, 206, 207, 208, 88, 218, 219, 220, 222, 226, 99, 227, 231, 104, 233, 107, 108, 109, 235, 239, 113, 243, 244, 245, 115, 121, 250, 124, 254}
[2025-04-30 06:38:07,073] 13 Nodes of Markov blanket: [0, 50, 64, 113, 124, 128, 155, 156, 219, 222, 243, 267, 272]
[2025-04-30 06:38:07,080] [MB metrics] precision: 1.000, recall: 0.183, acc: 0.802, f1: 0.310
[2025-04-30 06:38:23,123] sub_met2 before prunning None
[2025-04-30 06:38:23,123] sub_met after prunning {'fdr': 0.6842, 'tpr': 0.75, 'fpr': 0.1857, 'shd': 15, 'nnz': 19, 'precision': 0.3158, 'recall': 0.75, 'F1': 0.4444, 'gscore': 0.0}
[2025-04-30 06:38:23,123] 
===  65-th graph ===
[2025-04-30 06:38:23,136] 16 Nodes of True MB: [21, 43, 47, 65, 73, 76, 131, 133, 169, 215, 221, 226, 255, 288, 291, 295], parents: {226, 133, 295, 73, 169, 76, 47, 221, 255}, children: {21}, spouse: {288, 65, 131, 291, 43, 215}
[2025-04-30 06:38:23,136] 4 Nodes of Markov blanket: [47, 65, 131, 291]
[2025-04-30 06:38:23,139] [MB metrics] precision: 1.000, recall: 0.250, acc: 0.959, f1: 0.400
[2025-04-30 06:38:30,264] sub_met2 before prunning None
[2025-04-30 06:38:30,264] sub_met after prunning {'fdr': 0.0, 'tpr': 1.0, 'fpr': 0.0, 'shd': 0, 'nnz': 1, 'precision': 1.0, 'recall': 1.0, 'F1': 1.0, 'gscore': 1.0}
[2025-04-30 06:38:30,264] 
===  66-th graph ===
[2025-04-30 06:38:30,264] 80 Nodes of True MB: [5, 10, 11, 12, 20, 22, 24, 25, 28, 31, 32, 38, 45, 46, 49, 50, 55, 56, 59, 61, 63, 66, 67, 75, 82, 88, 90, 91, 96, 97, 100, 103, 105, 111, 113, 115, 129, 130, 132, 135, 140, 145, 147, 155, 157, 158, 161, 163, 166, 169, 177, 183, 194, 195, 202, 215, 226, 233, 242, 246, 247, 249, 255, 260, 261, 263, 264, 265, 266, 270, 274, 280, 283, 284, 289, 290, 292, 293, 294, 295], parents: {100, 166, 147, 20, 88, 63}, children: {129, 130, 290, 132, 260, 263, 265, 12, 177, 274, 22, 283}, spouse: {129, 5, 261, 135, 264, 158, 10, 11, 266, 140, 270, 145, 274, 20, 24, 25, 280, 155, 284, 157, 28, 31, 32, 161, 289, 163, 292, 293, 166, 38, 294, 169, 295, 45, 46, 49, 50, 55, 56, 183, 59, 61, 63, 66, 194, 67, 195, 202, 75, 82, 215, 88, 90, 91, 96, 97, 226, 100, 103, 233, 105, 111, 113, 242, 115, 246, 247, 249, 255}
[2025-04-30 06:38:30,264] 22 Nodes of Markov blanket: [10, 11, 20, 31, 32, 45, 46, 50, 61, 66, 75, 82, 97, 113, 115, 129, 147, 161, 166, 195, 215, 293]
[2025-04-30 06:38:30,269] [MB metrics] precision: 1.000, recall: 0.275, acc: 0.804, f1: 0.431
[2025-04-30 06:38:50,159] sub_met2 before prunning None
[2025-04-30 06:38:50,159] sub_met after prunning {'fdr': 0.931, 'tpr': 0.1667, 'fpr': 0.1233, 'shd': 37, 'nnz': 29, 'precision': 0.069, 'recall': 0.1667, 'F1': 0.0976, 'gscore': 0.0}
[2025-04-30 06:38:50,159] 
===  67-th graph ===
[2025-04-30 06:38:50,159] 73 Nodes of True MB: [13, 25, 29, 30, 36, 38, 50, 64, 66, 67, 70, 76, 77, 88, 92, 93, 103, 104, 105, 107, 109, 113, 116, 119, 124, 129, 141, 145, 148, 154, 160, 161, 168, 170, 178, 181, 184, 186, 187, 189, 194, 195, 197, 198, 199, 214, 215, 216, 219, 221, 222, 224, 227, 232, 233, 235, 236, 237, 239, 243, 246, 249, 251, 252, 255, 260, 265, 271, 272, 286, 289, 291, 294], parents: {198, 103, 181, 251, 30}, children: {64, 186, 265, 271, 189, 119, 216, 25, 154, 187, 93, 286}, spouse: {129, 260, 13, 141, 271, 272, 145, 148, 25, 154, 29, 160, 289, 161, 291, 36, 38, 294, 168, 170, 50, 178, 184, 64, 66, 67, 195, 194, 197, 199, 70, 76, 77, 214, 215, 216, 88, 219, 92, 221, 222, 224, 227, 104, 105, 233, 235, 236, 237, 232, 239, 107, 113, 109, 243, 116, 252, 246, 249, 124, 255}
[2025-04-30 06:38:50,159] 18 Nodes of Markov blanket: [25, 36, 67, 88, 105, 107, 109, 113, 141, 154, 170, 178, 184, 198, 232, 233, 255, 260]
[2025-04-30 06:38:50,173] [MB metrics] precision: 1.000, recall: 0.247, acc: 0.814, f1: 0.396
[2025-04-30 06:39:09,461] sub_met2 before prunning None
[2025-04-30 06:39:09,461] sub_met after prunning {'fdr': 0.9091, 'tpr': 0.2857, 'fpr': 0.2878, 'shd': 49, 'nnz': 44, 'precision': 0.0909, 'recall': 0.2857, 'F1': 0.1379, 'gscore': 0.0}
[2025-04-30 06:39:09,461] 
===  68-th graph ===
[2025-04-30 06:39:09,461] 38 Nodes of True MB: [18, 31, 32, 34, 55, 64, 68, 75, 78, 82, 90, 98, 104, 110, 111, 115, 128, 135, 141, 154, 159, 177, 178, 179, 200, 202, 208, 222, 224, 233, 234, 247, 250, 251, 259, 260, 267, 269], parents: {224, 202, 234, 267, 178, 18, 82, 251, 31}, children: {34, 247, 269, 159}, spouse: {128, 259, 260, 135, 141, 154, 159, 32, 177, 179, 55, 64, 68, 200, 202, 75, 78, 208, 90, 222, 98, 104, 233, 110, 111, 115, 250, 251}
[2025-04-30 06:39:09,461] 10 Nodes of Markov blanket: [32, 68, 75, 98, 104, 154, 179, 200, 251, 260]
[2025-04-30 06:39:09,476] [MB metrics] precision: 1.000, recall: 0.263, acc: 0.896, f1: 0.417
[2025-04-30 06:39:24,313] sub_met2 before prunning None
[2025-04-30 06:39:24,319] sub_met after prunning {'fdr': 0.9286, 'tpr': 0.3333, 'fpr': 0.3095, 'shd': 15, 'nnz': 14, 'precision': 0.0714, 'recall': 0.3333, 'F1': 0.1176, 'gscore': 0.0}
[2025-04-30 06:39:24,319] 
===  69-th graph ===
[2025-04-30 06:39:24,319] 39 Nodes of True MB: [14, 16, 20, 24, 30, 38, 45, 48, 49, 69, 101, 111, 112, 115, 117, 120, 131, 140, 168, 177, 180, 181, 192, 193, 196, 198, 200, 216, 220, 222, 224, 225, 233, 247, 256, 257, 259, 270, 299], parents: {259, 233, 16, 115, 117}, children: {45, 14, 270, 48, 120, 222}, spouse: {256, 257, 131, 140, 20, 24, 30, 38, 168, 299, 177, 49, 180, 181, 192, 193, 196, 69, 198, 200, 216, 220, 224, 225, 101, 233, 111, 112, 115, 247, 120}
[2025-04-30 06:39:24,319] 6 Nodes of Markov blanket: [69, 115, 131, 198, 224, 247]
[2025-04-30 06:39:24,323] [MB metrics] precision: 1.000, recall: 0.154, acc: 0.890, f1: 0.267
[2025-04-30 06:39:34,440] sub_met2 before prunning None
[2025-04-30 06:39:34,440] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2143, 'shd': 4, 'nnz': 3, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:39:34,440] 
===  70-th graph ===
[2025-04-30 06:39:34,440] 40 Nodes of True MB: [11, 18, 25, 33, 35, 37, 44, 47, 48, 55, 67, 70, 73, 84, 91, 93, 116, 117, 122, 133, 135, 140, 149, 154, 156, 160, 166, 169, 178, 184, 216, 224, 239, 252, 253, 256, 271, 272, 286, 293], parents: {216, 18, 117, 135}, children: {35, 11, 93, 37}, spouse: {256, 133, 140, 271, 272, 149, 25, 154, 156, 286, 160, 33, 293, 166, 169, 44, 47, 48, 178, 55, 184, 67, 70, 73, 84, 91, 224, 239, 116, 122, 252, 253}
[2025-04-30 06:39:34,440] 4 Nodes of Markov blanket: [48, 70, 178, 272]
[2025-04-30 06:39:34,447] [MB metrics] precision: 1.000, recall: 0.100, acc: 0.878, f1: 0.182
[2025-04-30 06:39:41,708] sub_met2 before prunning None
[2025-04-30 06:39:41,708] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 1.2, 'shd': 6, 'nnz': 6, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:39:41,708] 
===  71-th graph ===
[2025-04-30 06:39:41,708] 20 Nodes of True MB: [42, 51, 71, 84, 110, 118, 131, 135, 166, 167, 171, 179, 182, 183, 185, 239, 261, 275, 291, 293], parents: {291, 179, 239}, children: {51, 167}, spouse: {131, 261, 166, 135, 71, 293, 42, 171, 110, 275, 84, 118, 183, 182, 185}
[2025-04-30 06:39:41,708] 6 Nodes of Markov blanket: [71, 110, 118, 135, 171, 293]
[2025-04-30 06:39:41,715] [MB metrics] precision: 1.000, recall: 0.300, acc: 0.952, f1: 0.462
[2025-04-30 06:39:51,979] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:39:51,979] sub_met2 before prunning None
[2025-04-30 06:39:51,979] sub_met after prunning None
[2025-04-30 06:39:51,989] 
===  72-th graph ===
[2025-04-30 06:39:51,989] 13 Nodes of True MB: [40, 72, 112, 135, 166, 190, 201, 218, 251, 253, 264, 273, 298], parents: {166, 135, 40, 201, 264, 298, 112, 273, 218, 251, 253, 190}, children: set(), spouse: {72}
[2025-04-30 06:39:51,989] 
===  73-th graph ===
[2025-04-30 06:39:51,989] 73 Nodes of True MB: [0, 4, 5, 9, 16, 22, 24, 27, 35, 47, 55, 59, 62, 64, 65, 70, 73, 74, 76, 80, 102, 107, 113, 120, 124, 128, 133, 134, 139, 140, 141, 156, 157, 166, 169, 171, 174, 179, 180, 181, 183, 191, 196, 204, 208, 219, 221, 223, 224, 226, 227, 231, 233, 234, 237, 239, 241, 244, 249, 250, 252, 253, 255, 256, 258, 259, 266, 275, 284, 294, 295, 297, 298], parents: {141}, children: {224, 65, 258, 35, 196, 5, 297, 234, 171, 76, 252, 124}, spouse: {256, 0, 128, 259, 4, 133, 134, 9, 266, 139, 140, 16, 275, 22, 24, 27, 156, 157, 284, 294, 295, 166, 169, 298, 174, 47, 179, 180, 181, 55, 183, 59, 62, 191, 64, 70, 73, 74, 76, 204, 80, 208, 219, 221, 223, 226, 227, 102, 231, 233, 107, 237, 239, 241, 113, 244, 120, 249, 250, 253, 255}
[2025-04-30 06:39:51,989] 16 Nodes of Markov blanket: [47, 59, 73, 102, 107, 133, 141, 156, 179, 181, 233, 244, 250, 253, 266, 298]
[2025-04-30 06:39:51,992] [MB metrics] precision: 1.000, recall: 0.219, acc: 0.809, f1: 0.360
[2025-04-30 06:40:10,227] sub_met2 before prunning None
[2025-04-30 06:40:10,227] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3304, 'shd': 42, 'nnz': 38, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:40:10,227] 
===  74-th graph ===
[2025-04-30 06:40:10,227] 48 Nodes of True MB: [6, 25, 33, 38, 40, 41, 47, 58, 73, 74, 78, 80, 85, 87, 95, 101, 107, 110, 112, 117, 118, 133, 139, 145, 158, 174, 180, 181, 189, 191, 192, 201, 204, 206, 224, 237, 242, 245, 248, 258, 261, 264, 268, 282, 284, 293, 294, 299], parents: {192, 78}, children: {258, 41, 268, 145, 242, 58}, spouse: {258, 133, 6, 261, 264, 139, 25, 282, 284, 158, 33, 293, 294, 38, 40, 299, 174, 47, 180, 181, 189, 191, 192, 73, 74, 201, 204, 206, 80, 85, 87, 95, 224, 101, 107, 237, 110, 112, 245, 118, 117, 248}
[2025-04-30 06:40:10,230] 9 Nodes of Markov blanket: [40, 74, 85, 95, 181, 204, 237, 261, 294]
[2025-04-30 06:40:10,233] [MB metrics] precision: 1.000, recall: 0.188, acc: 0.870, f1: 0.316
[2025-04-30 06:40:25,026] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:40:25,026] sub_met2 before prunning None
[2025-04-30 06:40:25,026] sub_met after prunning None
[2025-04-30 06:40:25,026] 
===  75-th graph ===
[2025-04-30 06:40:25,026] 45 Nodes of True MB: [9, 27, 32, 45, 55, 64, 66, 68, 75, 82, 92, 103, 104, 105, 107, 109, 118, 128, 135, 141, 150, 152, 159, 177, 179, 186, 187, 189, 190, 202, 208, 209, 214, 215, 222, 226, 228, 235, 257, 260, 269, 277, 284, 287, 291], parents: {291, 235, 214, 92, 287}, children: {103, 269, 177, 209, 150}, spouse: {128, 257, 260, 135, 9, 141, 277, 152, 27, 284, 159, 32, 45, 177, 179, 55, 186, 187, 189, 190, 64, 66, 68, 202, 75, 208, 82, 215, 222, 226, 228, 104, 105, 107, 109, 118}
[2025-04-30 06:40:25,026] 16 Nodes of Markov blanket: [27, 32, 66, 68, 75, 82, 104, 128, 152, 159, 179, 190, 202, 215, 222, 257]
[2025-04-30 06:40:25,044] [MB metrics] precision: 1.000, recall: 0.356, acc: 0.901, f1: 0.525
[2025-04-30 06:40:43,174] sub_met2 before prunning None
[2025-04-30 06:40:43,174] sub_met after prunning {'fdr': 0.9565, 'tpr': 0.5, 'fpr': 0.3793, 'shd': 46, 'nnz': 46, 'precision': 0.0435, 'recall': 0.5, 'F1': 0.08, 'gscore': 0.0}
[2025-04-30 06:40:43,174] 
===  76-th graph ===
[2025-04-30 06:40:43,174] 53 Nodes of True MB: [7, 9, 12, 15, 25, 46, 47, 50, 54, 59, 62, 65, 67, 73, 76, 84, 103, 105, 133, 134, 138, 148, 159, 164, 168, 169, 178, 183, 184, 193, 208, 209, 221, 226, 232, 236, 237, 238, 243, 244, 249, 255, 262, 271, 276, 280, 284, 286, 289, 290, 292, 295, 298], parents: {73, 9, 298, 208, 244, 59}, children: {65, 138, 238, 271, 249}, spouse: {133, 134, 7, 262, 12, 15, 276, 148, 280, 25, 284, 286, 159, 289, 290, 292, 164, 295, 168, 169, 46, 47, 178, 50, 54, 183, 184, 62, 193, 67, 73, 76, 209, 84, 221, 226, 103, 232, 105, 236, 237, 243, 255}
[2025-04-30 06:40:43,174] 11 Nodes of Markov blanket: [25, 76, 105, 148, 178, 232, 244, 280, 284, 289, 292]
[2025-04-30 06:40:43,180] [MB metrics] precision: 1.000, recall: 0.208, acc: 0.860, f1: 0.344
[2025-04-30 06:40:59,535] sub_met2 before prunning None
[2025-04-30 06:40:59,535] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.5, 'shd': 28, 'nnz': 27, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:40:59,535] 
===  77-th graph ===
[2025-04-30 06:40:59,535] 44 Nodes of True MB: [1, 16, 20, 23, 31, 33, 50, 67, 77, 82, 95, 100, 105, 122, 125, 133, 135, 139, 141, 145, 150, 153, 155, 166, 168, 171, 174, 187, 189, 190, 192, 195, 197, 208, 212, 216, 220, 221, 227, 246, 249, 265, 269, 275], parents: {166, 174, 208, 275, 155, 189, 31}, children: {1, 133, 212, 153, 187}, spouse: {135, 265, 139, 269, 141, 16, 145, 20, 150, 23, 33, 168, 171, 50, 190, 192, 195, 67, 197, 77, 82, 216, 220, 221, 95, 227, 100, 105, 246, 249, 122, 125}
[2025-04-30 06:40:59,535] 7 Nodes of Markov blanket: [77, 100, 150, 190, 192, 220, 221]
[2025-04-30 06:40:59,546] [MB metrics] precision: 1.000, recall: 0.159, acc: 0.866, f1: 0.275
[2025-04-30 06:41:12,336] sub_met2 before prunning None
[2025-04-30 06:41:12,336] sub_met after prunning {'fdr': 0.9167, 'tpr': 1.0, 'fpr': 0.55, 'shd': 11, 'nnz': 12, 'precision': 0.0833, 'recall': 1.0, 'F1': 0.1538, 'gscore': 0.0}
[2025-04-30 06:41:12,336] 
===  78-th graph ===
[2025-04-30 06:41:12,350] 34 Nodes of True MB: [18, 32, 46, 57, 68, 74, 78, 90, 100, 102, 107, 110, 115, 128, 140, 141, 147, 154, 164, 176, 192, 194, 203, 205, 207, 219, 222, 241, 247, 251, 253, 257, 291, 297], parents: {291, 219}, children: {74, 203, 207, 176, 18, 247}, spouse: {128, 257, 140, 141, 147, 154, 32, 164, 297, 46, 57, 192, 194, 68, 205, 78, 90, 222, 100, 102, 107, 110, 241, 115, 251, 253}
[2025-04-30 06:41:12,350] 8 Nodes of Markov blanket: [46, 57, 78, 102, 141, 164, 222, 241]
[2025-04-30 06:41:12,353] [MB metrics] precision: 1.000, recall: 0.235, acc: 0.913, f1: 0.381
[2025-04-30 06:41:29,828] sub_met2 before prunning None
[2025-04-30 06:41:29,828] sub_met after prunning {'fdr': 0.9167, 'tpr': 1.0, 'fpr': 0.4074, 'shd': 11, 'nnz': 12, 'precision': 0.0833, 'recall': 1.0, 'F1': 0.1538, 'gscore': 0.0}
[2025-04-30 06:41:29,828] 
===  79-th graph ===
[2025-04-30 06:41:29,828] 8 Nodes of True MB: [42, 79, 86, 123, 199, 241, 244, 252], parents: {199, 42, 241, 244, 86, 123, 252}, children: set(), spouse: {79}
[2025-04-30 06:41:29,828] 
===  80-th graph ===
[2025-04-30 06:41:29,828] 24 Nodes of True MB: [6, 7, 13, 73, 74, 80, 94, 113, 118, 139, 173, 174, 180, 199, 203, 204, 214, 237, 254, 258, 266, 267, 276, 294], parents: {6, 7, 266, 113, 276, 214}, children: {258, 173}, spouse: {294, 199, 73, 74, 139, 204, 237, 174, 13, 80, 203, 267, 180, 118, 254, 94}
[2025-04-30 06:41:29,828] 5 Nodes of Markov blanket: [80, 204, 237, 276, 294]
[2025-04-30 06:41:29,833] [MB metrics] precision: 1.000, recall: 0.208, acc: 0.936, f1: 0.345
[2025-04-30 06:41:37,257] sub_met2 before prunning None
[2025-04-30 06:41:37,257] sub_met after prunning {'fdr': 0.8333, 'tpr': 0.5, 'fpr': 0.625, 'shd': 6, 'nnz': 6, 'precision': 0.1667, 'recall': 0.5, 'F1': 0.25, 'gscore': 0.0}
[2025-04-30 06:41:37,257] 
===  81-th graph ===
[2025-04-30 06:41:37,257] 14 Nodes of True MB: [15, 46, 81, 88, 126, 136, 156, 170, 175, 194, 208, 219, 280, 295], parents: {280, 194, 295, 136, 170, 46, 15, 175, 208, 88, 219, 156, 126}, children: set(), spouse: {81}
[2025-04-30 06:41:37,257] 
===  82-th graph ===
[2025-04-30 06:41:37,257] 86 Nodes of True MB: [0, 1, 3, 5, 11, 13, 16, 18, 20, 26, 27, 29, 31, 33, 39, 44, 46, 48, 50, 56, 61, 62, 66, 68, 75, 77, 82, 92, 97, 101, 102, 104, 109, 110, 111, 115, 118, 120, 122, 124, 125, 130, 134, 150, 166, 178, 179, 185, 189, 191, 192, 194, 195, 197, 200, 202, 207, 208, 211, 219, 224, 225, 227, 228, 234, 242, 245, 248, 249, 251, 255, 257, 259, 260, 262, 265, 267, 269, 272, 277, 281, 284, 287, 291, 292, 299], parents: {208, 115}, children: {1, 130, 3, 68, 227, 122, 281, 272, 245, 150, 185, 26}, spouse: {0, 257, 259, 260, 5, 134, 262, 265, 11, 267, 269, 13, 16, 272, 18, 20, 277, 281, 27, 284, 29, 287, 31, 33, 291, 292, 166, 39, 299, 44, 46, 48, 50, 178, 179, 56, 185, 61, 189, 191, 192, 62, 66, 195, 194, 197, 200, 202, 75, 77, 207, 82, 211, 219, 92, 224, 225, 97, 248, 228, 101, 102, 104, 234, 109, 110, 111, 242, 115, 118, 120, 249, 251, 124, 125, 255}
[2025-04-30 06:41:37,257] 21 Nodes of Markov blanket: [11, 13, 27, 46, 61, 62, 66, 75, 82, 110, 115, 166, 194, 197, 248, 249, 259, 260, 272, 277, 281]
[2025-04-30 06:41:37,270] [MB metrics] precision: 1.000, recall: 0.244, acc: 0.783, f1: 0.393
[2025-04-30 06:41:56,813] sub_met2 before prunning None
[2025-04-30 06:41:56,813] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.1026, 'shd': 35, 'nnz': 20, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:41:56,813] 
===  83-th graph ===
[2025-04-30 06:41:56,813] 9 Nodes of True MB: [45, 83, 97, 111, 149, 191, 218, 246, 258], parents: {97, 258, 45, 111, 149, 246, 218, 191}, children: set(), spouse: {83}
[2025-04-30 06:41:56,813] 
===  84-th graph ===
[2025-04-30 06:41:56,819] 43 Nodes of True MB: [11, 15, 27, 30, 31, 42, 44, 48, 70, 71, 76, 84, 88, 95, 100, 105, 109, 110, 122, 131, 140, 147, 149, 157, 164, 166, 167, 169, 178, 182, 184, 185, 202, 224, 234, 240, 245, 249, 256, 275, 282, 286, 293], parents: {178, 164, 110}, children: {167, 105, 11, 249, 282, 27}, spouse: {256, 131, 140, 15, 275, 147, 149, 157, 30, 31, 286, 164, 293, 166, 169, 42, 44, 48, 182, 184, 185, 70, 71, 202, 76, 84, 88, 95, 224, 100, 234, 109, 240, 245, 122}
[2025-04-30 06:41:56,819] 7 Nodes of Markov blanket: [84, 140, 169, 224, 234, 240, 286]
[2025-04-30 06:41:56,821] [MB metrics] precision: 1.000, recall: 0.163, acc: 0.878, f1: 0.280
[2025-04-30 06:42:09,521] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:42:09,521] sub_met2 before prunning None
[2025-04-30 06:42:09,521] sub_met after prunning None
[2025-04-30 06:42:09,521] 
===  85-th graph ===
[2025-04-30 06:42:09,521] 23 Nodes of True MB: [16, 40, 48, 56, 58, 74, 85, 95, 110, 129, 134, 146, 160, 181, 197, 200, 214, 215, 248, 255, 258, 261, 267], parents: {197, 200, 267, 16, 48, 214, 56, 255}, children: {58, 146}, spouse: {160, 129, 258, 261, 134, 40, 74, 110, 85, 181, 215, 248, 95}
[2025-04-30 06:42:09,521] 11 Nodes of Markov blanket: [16, 40, 74, 85, 95, 129, 134, 160, 181, 215, 261]
[2025-04-30 06:42:09,521] [MB metrics] precision: 1.000, recall: 0.478, acc: 0.955, f1: 0.647
[2025-04-30 06:42:26,090] sub_met2 before prunning None
[2025-04-30 06:42:26,090] sub_met after prunning {'fdr': 0.9688, 'tpr': 0.25, 'fpr': 0.6078, 'shd': 34, 'nnz': 32, 'precision': 0.0312, 'recall': 0.25, 'F1': 0.0556, 'gscore': 0.0}
[2025-04-30 06:42:26,090] 
===  86-th graph ===
[2025-04-30 06:42:26,090] 18 Nodes of True MB: [39, 42, 64, 79, 86, 123, 124, 133, 157, 199, 207, 226, 241, 244, 252, 265, 266, 292], parents: {64, 226, 292, 133, 39, 265, 266, 207, 124, 157}, children: {79}, spouse: {199, 42, 241, 244, 86, 123, 252}
[2025-04-30 06:42:26,090] 
===  87-th graph ===
[2025-04-30 06:42:26,090] 30 Nodes of True MB: [9, 10, 23, 44, 74, 87, 92, 97, 102, 106, 112, 115, 119, 120, 123, 129, 135, 139, 140, 145, 160, 196, 202, 205, 229, 278, 282, 283, 284, 299], parents: {140, 102}, children: {145, 205, 229, 23}, spouse: {129, 135, 9, 10, 139, 278, 282, 283, 284, 160, 299, 44, 196, 74, 202, 87, 92, 97, 106, 112, 115, 119, 120, 123}
[2025-04-30 06:42:26,090] 6 Nodes of Markov blanket: [87, 112, 115, 120, 139, 282]
[2025-04-30 06:42:26,104] [MB metrics] precision: 1.000, recall: 0.200, acc: 0.920, f1: 0.333
[2025-04-30 06:42:36,054] sub_met2 before prunning None
[2025-04-30 06:42:36,054] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.5, 'shd': 8, 'nnz': 7, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:42:36,054] 
===  88-th graph ===
[2025-04-30 06:42:36,054] 75 Nodes of True MB: [0, 5, 6, 10, 15, 20, 25, 30, 31, 33, 36, 43, 46, 56, 57, 60, 63, 64, 66, 67, 81, 84, 88, 90, 91, 100, 102, 103, 105, 107, 109, 113, 115, 117, 126, 129, 136, 140, 141, 142, 147, 152, 153, 156, 158, 166, 170, 175, 184, 194, 206, 208, 219, 222, 229, 232, 233, 234, 239, 240, 244, 245, 247, 260, 266, 273, 275, 280, 281, 284, 286, 293, 295, 298, 299], parents: set(), children: {33, 66, 260, 6, 105, 81, 273, 57, 60, 286}, spouse: {0, 129, 5, 136, 10, 266, 140, 141, 142, 15, 275, 20, 147, 152, 25, 281, 280, 156, 284, 158, 30, 31, 33, 153, 36, 293, 166, 295, 298, 170, 43, 299, 46, 175, 56, 184, 63, 64, 66, 194, 67, 206, 208, 84, 88, 90, 91, 219, 222, 100, 229, 102, 103, 232, 233, 234, 107, 109, 239, 240, 113, 115, 244, 117, 245, 247, 126}
[2025-04-30 06:42:36,054] 14 Nodes of Markov blanket: [33, 36, 67, 88, 102, 107, 117, 140, 147, 158, 229, 232, 247, 280]
[2025-04-30 06:42:36,054] [MB metrics] precision: 1.000, recall: 0.187, acc: 0.797, f1: 0.315
[2025-04-30 06:42:51,923] sub_met2 before prunning None
[2025-04-30 06:42:51,923] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2289, 'shd': 27, 'nnz': 19, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:42:51,923] 
===  89-th graph ===
[2025-04-30 06:42:51,923] 10 Nodes of True MB: [39, 89, 101, 148, 185, 186, 222, 247, 255, 266], parents: {101, 39, 266, 148, 247, 185, 186, 222, 255}, children: set(), spouse: {89}
[2025-04-30 06:42:51,939] 
===  90-th graph ===
[2025-04-30 06:42:51,939] 38 Nodes of True MB: [5, 10, 24, 25, 32, 33, 59, 66, 68, 78, 88, 90, 105, 111, 113, 128, 141, 152, 154, 157, 206, 207, 222, 223, 228, 232, 233, 245, 247, 248, 249, 251, 274, 275, 280, 290, 293, 294], parents: {248}, children: {33, 290, 247, 223}, spouse: {128, 5, 10, 141, 274, 275, 24, 25, 152, 280, 154, 157, 32, 293, 294, 59, 66, 68, 206, 78, 207, 88, 90, 222, 228, 232, 233, 105, 111, 113, 245, 249, 251}
[2025-04-30 06:42:51,939] 3 Nodes of Markov blanket: [90, 207, 228]
[2025-04-30 06:42:51,942] [MB metrics] precision: 1.000, recall: 0.079, acc: 0.881, f1: 0.146
[2025-04-30 06:42:58,982] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:42:58,982] sub_met2 before prunning None
[2025-04-30 06:42:58,982] sub_met after prunning None
[2025-04-30 06:42:58,982] 
===  91-th graph ===
[2025-04-30 06:42:58,982] 30 Nodes of True MB: [0, 2, 5, 10, 25, 33, 37, 47, 48, 56, 59, 61, 66, 70, 88, 91, 92, 117, 125, 140, 178, 181, 195, 198, 228, 232, 260, 266, 269, 272], parents: set(), children: {2, 260, 37, 117, 92}, spouse: {0, 5, 10, 266, 140, 269, 272, 25, 33, 47, 48, 178, 181, 56, 59, 61, 66, 195, 198, 70, 88, 91, 228, 232, 125}
[2025-04-30 06:42:58,982] 5 Nodes of Markov blanket: [48, 91, 178, 260, 272]
[2025-04-30 06:42:58,988] [MB metrics] precision: 1.000, recall: 0.167, acc: 0.908, f1: 0.286
[2025-04-30 06:43:06,453] sub_met2 before prunning None
[2025-04-30 06:43:06,453] sub_met after prunning {'fdr': 0.8, 'tpr': 0.6667, 'fpr': 1.1429, 'shd': 8, 'nnz': 10, 'precision': 0.2, 'recall': 0.6667, 'F1': 0.3077, 'gscore': 0.0}
[2025-04-30 06:43:06,453] 
===  92-th graph ===
[2025-04-30 06:43:06,453] 73 Nodes of True MB: [1, 5, 6, 7, 13, 20, 22, 29, 30, 36, 37, 44, 46, 47, 48, 67, 75, 82, 87, 91, 92, 97, 101, 106, 107, 109, 111, 119, 120, 121, 129, 133, 137, 142, 144, 148, 156, 159, 162, 164, 168, 183, 185, 187, 189, 192, 202, 204, 208, 214, 224, 226, 227, 229, 232, 233, 235, 241, 245, 246, 248, 250, 251, 256, 257, 260, 283, 285, 287, 291, 292, 293, 298], parents: {232, 91}, children: {162, 227, 292, 229, 293, 137, 75, 47, 248, 251, 156, 189}, spouse: {256, 1, 257, 129, 260, 5, 133, 6, 7, 13, 142, 144, 20, 148, 22, 283, 29, 285, 159, 287, 30, 291, 36, 37, 164, 168, 298, 44, 46, 48, 183, 185, 187, 192, 67, 202, 204, 208, 82, 214, 87, 92, 224, 97, 226, 101, 232, 233, 106, 235, 107, 109, 111, 241, 245, 246, 119, 120, 121, 250, 251}
[2025-04-30 06:43:06,453] 20 Nodes of Markov blanket: [1, 5, 13, 46, 92, 101, 107, 119, 156, 164, 168, 185, 208, 232, 233, 241, 251, 256, 285, 291]
[2025-04-30 06:43:06,472] [MB metrics] precision: 1.000, recall: 0.274, acc: 0.823, f1: 0.430
[2025-04-30 06:43:25,861] sub_met2 before prunning None
[2025-04-30 06:43:25,861] sub_met after prunning {'fdr': 0.9231, 'tpr': 0.3333, 'fpr': 0.1989, 'shd': 41, 'nnz': 39, 'precision': 0.0769, 'recall': 0.3333, 'F1': 0.125, 'gscore': 0.0}
[2025-04-30 06:43:25,861] 
===  93-th graph ===
[2025-04-30 06:43:25,861] 15 Nodes of True MB: [0, 42, 47, 67, 70, 93, 116, 154, 160, 192, 232, 234, 245, 252, 271], parents: {160, 67, 70, 271, 116, 154, 252}, children: {42}, spouse: {0, 192, 232, 234, 47, 271, 245, 93}
[2025-04-30 06:43:25,861] 
===  94-th graph ===
[2025-04-30 06:43:25,868] 16 Nodes of True MB: [5, 13, 28, 80, 94, 97, 118, 173, 199, 203, 223, 226, 252, 254, 267, 291], parents: {97, 226, 291, 5, 252, 28, 223}, children: {173}, spouse: {199, 203, 267, 13, 80, 118, 254, 94}
[2025-04-30 06:43:25,868] 5 Nodes of Markov blanket: [13, 94, 118, 199, 203]
[2025-04-30 06:43:25,871] [MB metrics] precision: 1.000, recall: 0.312, acc: 0.962, f1: 0.476
[2025-04-30 06:43:33,373] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:43:33,373] sub_met2 before prunning None
[2025-04-30 06:43:33,373] sub_met after prunning None
[2025-04-30 06:43:33,373] 
===  95-th graph ===
[2025-04-30 06:43:33,373] 38 Nodes of True MB: [12, 13, 20, 40, 50, 56, 58, 74, 77, 84, 85, 95, 109, 110, 122, 125, 133, 135, 147, 155, 157, 159, 160, 164, 180, 181, 201, 202, 204, 236, 248, 250, 258, 261, 269, 277, 282, 298], parents: {56, 250, 298}, children: {201, 58, 282, 133}, spouse: {258, 261, 135, 12, 13, 269, 147, 20, 277, 155, 157, 159, 160, 164, 40, 50, 180, 181, 74, 202, 204, 77, 84, 85, 95, 236, 109, 110, 248, 122, 125}
[2025-04-30 06:43:33,389] 8 Nodes of Markov blanket: [40, 74, 85, 95, 110, 181, 258, 261]
[2025-04-30 06:43:33,389] [MB metrics] precision: 1.000, recall: 0.211, acc: 0.900, f1: 0.348
[2025-04-30 06:43:51,620] sub_met2 before prunning None
[2025-04-30 06:43:51,620] sub_met after prunning {'fdr': 0.8889, 'tpr': 1.0, 'fpr': 0.2963, 'shd': 8, 'nnz': 9, 'precision': 0.1111, 'recall': 1.0, 'F1': 0.2, 'gscore': 0.0}
[2025-04-30 06:43:51,620] 
===  96-th graph ===
[2025-04-30 06:43:51,620] 24 Nodes of True MB: [10, 15, 29, 32, 36, 49, 63, 66, 96, 97, 107, 109, 122, 129, 135, 141, 145, 161, 169, 200, 206, 233, 239, 296], parents: {32, 97, 296, 10, 109, 239, 49, 122}, children: {129, 36}, spouse: {96, 161, 66, 135, 200, 169, 233, 107, 141, 206, 15, 49, 145, 29, 63}
[2025-04-30 06:43:51,620] 
===  97-th graph ===
[2025-04-30 06:43:51,620] 60 Nodes of True MB: [5, 6, 10, 23, 28, 29, 32, 37, 38, 39, 44, 45, 48, 49, 50, 56, 66, 82, 83, 87, 92, 94, 96, 97, 100, 101, 106, 109, 111, 120, 122, 123, 135, 137, 140, 142, 149, 159, 160, 170, 187, 191, 197, 211, 218, 223, 226, 227, 228, 239, 246, 252, 256, 258, 274, 277, 278, 291, 294, 296], parents: {256, 122, 228}, children: {96, 227, 39, 137, 274, 83, 23, 94}, spouse: {258, 5, 6, 135, 10, 140, 142, 277, 149, 278, 28, 29, 159, 32, 160, 291, 37, 38, 294, 296, 170, 44, 45, 48, 49, 50, 56, 187, 191, 66, 197, 82, 211, 87, 218, 92, 223, 97, 226, 100, 101, 106, 109, 239, 111, 246, 120, 122, 123, 252}
[2025-04-30 06:43:51,620] 18 Nodes of Markov blanket: [38, 44, 45, 48, 66, 97, 101, 111, 140, 170, 211, 218, 223, 226, 239, 258, 277, 291]
[2025-04-30 06:43:51,630] [MB metrics] precision: 1.000, recall: 0.300, acc: 0.859, f1: 0.462
[2025-04-30 06:44:10,104] sub_met2 before prunning None
[2025-04-30 06:44:10,106] sub_met after prunning {'fdr': 0.9683, 'tpr': 0.5, 'fpr': 0.4094, 'shd': 63, 'nnz': 63, 'precision': 0.0317, 'recall': 0.5, 'F1': 0.0597, 'gscore': 0.0}
[2025-04-30 06:44:10,106] 
===  98-th graph ===
[2025-04-30 06:44:10,106] 37 Nodes of True MB: [18, 20, 27, 34, 55, 68, 98, 104, 110, 121, 126, 127, 135, 136, 141, 143, 145, 179, 186, 188, 199, 211, 222, 223, 224, 230, 235, 246, 250, 255, 257, 260, 268, 270, 276, 277, 280], parents: {257, 230, 135, 104, 143, 18, 211, 276}, children: {136, 34, 188, 127}, spouse: {260, 268, 141, 270, 145, 20, 277, 280, 27, 179, 55, 186, 68, 199, 222, 223, 224, 98, 235, 110, 246, 121, 250, 126, 255}
[2025-04-30 06:44:10,106] 5 Nodes of Markov blanket: [68, 98, 222, 230, 235]
[2025-04-30 06:44:10,108] [MB metrics] precision: 1.000, recall: 0.135, acc: 0.886, f1: 0.238
[2025-04-30 06:44:17,553] sub_met2 before prunning None
[2025-04-30 06:44:17,553] sub_met after prunning {'fdr': 0.75, 'tpr': 1.0, 'fpr': 0.3333, 'shd': 3, 'nnz': 4, 'precision': 0.25, 'recall': 1.0, 'F1': 0.4, 'gscore': 0.0}
[2025-04-30 06:44:17,553] 
===  99-th graph ===
[2025-04-30 06:44:17,553] 27 Nodes of True MB: [16, 24, 64, 99, 102, 111, 122, 142, 147, 160, 163, 191, 195, 217, 219, 227, 228, 230, 244, 250, 253, 260, 264, 267, 270, 276, 279], parents: {244, 253, 102}, children: {160, 217, 163, 264}, spouse: {260, 267, 142, 270, 16, 147, 276, 279, 24, 191, 64, 195, 219, 99, 227, 228, 230, 250, 111, 122}
[2025-04-30 06:44:17,553] 5 Nodes of Markov blanket: [99, 111, 191, 267, 270]
[2025-04-30 06:44:17,571] [MB metrics] precision: 1.000, recall: 0.185, acc: 0.921, f1: 0.312
[2025-04-30 06:44:24,897] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:44:24,897] sub_met2 before prunning None
[2025-04-30 06:44:24,897] sub_met after prunning None
[2025-04-30 06:44:24,897] 
===  100-th graph ===
[2025-04-30 06:44:24,897] 59 Nodes of True MB: [0, 7, 18, 20, 23, 27, 38, 39, 48, 50, 55, 56, 63, 66, 77, 78, 84, 88, 97, 100, 107, 110, 113, 118, 120, 122, 125, 132, 134, 139, 140, 141, 142, 147, 150, 163, 166, 169, 170, 171, 190, 197, 208, 211, 212, 221, 223, 233, 244, 245, 256, 257, 261, 264, 277, 279, 284, 287, 289], parents: {56, 279}, children: {0, 66, 132, 39, 7, 18, 212, 27, 221}, spouse: {256, 257, 261, 134, 264, 139, 140, 141, 142, 147, 20, 277, 150, 23, 284, 287, 289, 163, 166, 38, 169, 170, 171, 48, 50, 55, 190, 63, 66, 197, 77, 78, 208, 211, 84, 88, 221, 223, 97, 100, 233, 107, 110, 113, 244, 245, 118, 120, 122, 125}
[2025-04-30 06:44:24,897] 19 Nodes of Markov blanket: [55, 77, 100, 107, 113, 118, 122, 140, 147, 150, 166, 169, 208, 221, 245, 256, 257, 261, 287]
[2025-04-30 06:44:24,897] [MB metrics] precision: 1.000, recall: 0.322, acc: 0.862, f1: 0.487
[2025-04-30 06:44:44,455] sub_met2 before prunning None
[2025-04-30 06:44:44,455] sub_met after prunning {'fdr': 0.9216, 'tpr': 0.4444, 'fpr': 0.2901, 'shd': 51, 'nnz': 51, 'precision': 0.0784, 'recall': 0.4444, 'F1': 0.1333, 'gscore': 0.0}
[2025-04-30 06:44:44,455] 
===  101-th graph ===
[2025-04-30 06:44:44,455] 44 Nodes of True MB: [9, 20, 25, 29, 32, 38, 39, 44, 48, 69, 74, 82, 89, 92, 97, 101, 110, 115, 120, 121, 133, 144, 148, 158, 185, 186, 191, 192, 204, 220, 222, 224, 227, 231, 247, 254, 255, 256, 264, 266, 268, 282, 298, 299], parents: {192, 9, 20}, children: {227, 204, 268, 120, 89, 158}, spouse: {256, 133, 264, 266, 144, 148, 25, 282, 29, 32, 38, 39, 298, 299, 44, 48, 185, 186, 191, 69, 74, 82, 92, 220, 222, 224, 97, 101, 231, 110, 115, 247, 120, 121, 254, 255}
[2025-04-30 06:44:44,462] 17 Nodes of Markov blanket: [25, 44, 48, 92, 97, 101, 115, 120, 133, 148, 186, 191, 192, 220, 224, 255, 266]
[2025-04-30 06:44:44,466] [MB metrics] precision: 1.000, recall: 0.386, acc: 0.910, f1: 0.557
[2025-04-30 06:44:59,316] sub_met2 before prunning None
[2025-04-30 06:44:59,316] sub_met after prunning {'fdr': 0.9683, 'tpr': 0.2857, 'fpr': 0.4729, 'shd': 64, 'nnz': 63, 'precision': 0.0317, 'recall': 0.2857, 'F1': 0.0571, 'gscore': 0.0}
[2025-04-30 06:44:59,316] 
===  102-th graph ===
[2025-04-30 06:44:59,316] 82 Nodes of True MB: [5, 13, 15, 18, 20, 22, 24, 29, 31, 33, 43, 48, 55, 56, 57, 62, 73, 78, 82, 87, 88, 99, 102, 103, 107, 108, 111, 115, 122, 128, 131, 135, 140, 142, 143, 145, 147, 148, 159, 160, 161, 164, 166, 168, 169, 170, 174, 175, 179, 180, 183, 185, 186, 194, 195, 197, 199, 200, 203, 207, 221, 225, 229, 234, 239, 240, 244, 247, 249, 253, 256, 264, 266, 273, 275, 277, 280, 282, 284, 287, 296, 299], parents: {256, 147, 135}, children: {128, 99, 195, 5, 168, 170, 43, 203, 207, 273, 148, 277, 87, 57, 122}, spouse: {128, 131, 264, 266, 140, 13, 142, 143, 15, 145, 18, 275, 20, 22, 280, 24, 282, 284, 29, 159, 31, 287, 33, 160, 164, 161, 166, 296, 169, 43, 299, 174, 175, 48, 179, 180, 183, 55, 185, 186, 56, 62, 194, 197, 199, 200, 73, 78, 82, 88, 221, 225, 229, 102, 103, 234, 107, 108, 111, 240, 239, 115, 244, 247, 249, 122, 253}
[2025-04-30 06:44:59,320] 18 Nodes of Markov blanket: [13, 15, 18, 22, 31, 48, 73, 78, 88, 102, 111, 128, 135, 161, 166, 174, 234, 244]
[2025-04-30 06:44:59,323] [MB metrics] precision: 1.000, recall: 0.220, acc: 0.787, f1: 0.360
[2025-04-30 06:45:16,946] sub_met2 before prunning None
[2025-04-30 06:45:16,946] sub_met after prunning {'fdr': 0.8889, 'tpr': 0.5714, 'fpr': 0.2192, 'shd': 35, 'nnz': 36, 'precision': 0.1111, 'recall': 0.5714, 'F1': 0.186, 'gscore': 0.0}
[2025-04-30 06:45:16,952] 
===  103-th graph ===
[2025-04-30 06:45:16,952] 42 Nodes of True MB: [7, 9, 12, 30, 33, 38, 43, 50, 54, 66, 67, 75, 76, 88, 102, 103, 109, 117, 129, 134, 135, 138, 141, 142, 161, 178, 181, 193, 198, 208, 209, 229, 232, 247, 251, 262, 270, 273, 275, 280, 284, 290], parents: {9, 75, 109, 141, 284}, children: {67, 138, 12, 273, 275}, spouse: {129, 134, 7, 262, 135, 270, 142, 280, 284, 30, 161, 290, 33, 38, 43, 178, 50, 181, 54, 193, 66, 198, 76, 208, 209, 88, 229, 102, 103, 232, 117, 247, 251}
[2025-04-30 06:45:16,952] 10 Nodes of Markov blanket: [30, 50, 103, 117, 134, 178, 198, 232, 251, 275]
[2025-04-30 06:45:16,955] [MB metrics] precision: 1.000, recall: 0.238, acc: 0.890, f1: 0.385
[2025-04-30 06:45:31,956] sub_met2 before prunning None
[2025-04-30 06:45:31,956] sub_met after prunning {'fdr': 0.875, 'tpr': 0.6667, 'fpr': 0.3333, 'shd': 15, 'nnz': 16, 'precision': 0.125, 'recall': 0.6667, 'F1': 0.2105, 'gscore': 0.0}
[2025-04-30 06:45:31,956] 
===  104-th graph ===
[2025-04-30 06:45:31,956] 46 Nodes of True MB: [18, 27, 29, 38, 55, 64, 67, 68, 75, 82, 98, 104, 108, 118, 122, 124, 126, 128, 135, 143, 150, 159, 163, 177, 179, 186, 189, 199, 202, 208, 211, 214, 222, 224, 228, 230, 237, 249, 254, 257, 260, 269, 275, 276, 277, 289], parents: {108}, children: {98, 199, 269, 150, 186, 126}, spouse: {128, 257, 260, 135, 143, 18, 275, 276, 277, 27, 29, 159, 289, 163, 38, 177, 179, 55, 189, 64, 67, 68, 199, 202, 75, 208, 82, 211, 214, 222, 224, 228, 230, 104, 237, 118, 249, 122, 124, 254}
[2025-04-30 06:45:31,956] 15 Nodes of Markov blanket: [18, 29, 38, 68, 75, 104, 122, 124, 126, 159, 211, 230, 237, 249, 257]
[2025-04-30 06:45:31,956] [MB metrics] precision: 1.000, recall: 0.326, acc: 0.893, f1: 0.492
[2025-04-30 06:45:48,251] sub_met2 before prunning None
[2025-04-30 06:45:48,251] sub_met after prunning {'fdr': 0.8537, 'tpr': 0.75, 'fpr': 0.3608, 'shd': 36, 'nnz': 41, 'precision': 0.1463, 'recall': 0.75, 'F1': 0.2449, 'gscore': 0.0}
[2025-04-30 06:45:48,256] 
===  105-th graph ===
[2025-04-30 06:45:48,256] 49 Nodes of True MB: [5, 10, 24, 25, 30, 31, 45, 50, 59, 66, 67, 75, 76, 77, 84, 88, 90, 105, 107, 111, 113, 140, 145, 148, 152, 157, 168, 186, 187, 190, 197, 209, 216, 222, 227, 234, 236, 237, 240, 243, 245, 246, 249, 260, 271, 274, 280, 289, 290], parents: {234, 140, 240, 84, 245, 88, 30, 31}, children: {209, 290, 187, 271}, spouse: {260, 5, 10, 145, 274, 148, 152, 25, 24, 280, 157, 289, 168, 45, 50, 186, 59, 187, 190, 66, 67, 197, 75, 76, 77, 216, 90, 222, 227, 105, 107, 236, 237, 111, 113, 243, 246, 249}
[2025-04-30 06:45:48,256] 14 Nodes of Markov blanket: [5, 24, 25, 59, 67, 76, 105, 111, 113, 148, 197, 237, 260, 289]
[2025-04-30 06:45:48,259] [MB metrics] precision: 1.000, recall: 0.286, acc: 0.880, f1: 0.444
[2025-04-30 06:46:05,535] sub_met2 before prunning None
[2025-04-30 06:46:05,535] sub_met after prunning {'fdr': 0.9412, 'tpr': 0.4, 'fpr': 0.3721, 'shd': 35, 'nnz': 34, 'precision': 0.0588, 'recall': 0.4, 'F1': 0.1026, 'gscore': 0.0}
[2025-04-30 06:46:05,535] 
===  106-th graph ===
[2025-04-30 06:46:05,535] 27 Nodes of True MB: [7, 10, 18, 23, 30, 47, 87, 92, 97, 106, 121, 123, 126, 135, 144, 156, 160, 181, 183, 190, 200, 203, 234, 246, 259, 278, 289], parents: {289, 234, 203, 18, 183, 156}, children: {47, 190, 23}, spouse: {160, 97, 259, 7, 200, 135, 106, 10, 144, 181, 246, 87, 278, 121, 126, 123, 92, 30}
[2025-04-30 06:46:05,535] 2 Nodes of Markov blanket: [10, 106]
[2025-04-30 06:46:05,541] [MB metrics] precision: 1.000, recall: 0.074, acc: 0.914, f1: 0.138
[2025-04-30 06:46:12,542] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:46:12,542] sub_met2 before prunning None
[2025-04-30 06:46:12,542] sub_met after prunning None
[2025-04-30 06:46:12,542] 
===  107-th graph ===
[2025-04-30 06:46:12,542] 75 Nodes of True MB: [5, 6, 15, 16, 18, 22, 25, 26, 29, 33, 36, 38, 40, 45, 46, 47, 62, 64, 67, 73, 74, 75, 78, 88, 92, 96, 100, 102, 105, 107, 109, 110, 113, 115, 117, 123, 128, 129, 135, 140, 141, 147, 152, 156, 164, 170, 171, 174, 179, 180, 181, 183, 184, 186, 187, 189, 190, 192, 197, 200, 206, 209, 221, 222, 231, 232, 233, 240, 242, 249, 260, 272, 275, 286, 287], parents: {240, 115, 197}, children: {36, 5, 171, 209, 18, 242, 123, 156, 286}, spouse: {128, 129, 260, 6, 135, 140, 141, 15, 16, 272, 275, 147, 22, 152, 25, 26, 29, 287, 33, 164, 36, 38, 40, 170, 45, 174, 47, 46, 179, 180, 181, 183, 184, 186, 187, 189, 62, 190, 64, 192, 67, 200, 73, 74, 75, 206, 78, 88, 92, 221, 222, 96, 100, 102, 231, 232, 233, 105, 107, 109, 110, 113, 117, 249}
[2025-04-30 06:46:12,542] 23 Nodes of Markov blanket: [16, 36, 46, 67, 73, 88, 92, 100, 107, 109, 113, 115, 140, 147, 164, 170, 179, 181, 184, 192, 232, 286, 287]
[2025-04-30 06:46:12,542] [MB metrics] precision: 1.000, recall: 0.307, acc: 0.819, f1: 0.469
[2025-04-30 06:46:32,344] sub_met2 before prunning None
[2025-04-30 06:46:32,344] sub_met after prunning {'fdr': 0.8533, 'tpr': 0.6875, 'fpr': 0.27, 'shd': 68, 'nnz': 75, 'precision': 0.1467, 'recall': 0.6875, 'F1': 0.2418, 'gscore': 0.0}
[2025-04-30 06:46:32,344] 
===  108-th graph ===
[2025-04-30 06:46:32,344] 35 Nodes of True MB: [13, 16, 48, 50, 55, 56, 64, 102, 104, 108, 109, 111, 112, 117, 147, 155, 161, 166, 168, 169, 170, 180, 199, 203, 208, 220, 233, 234, 235, 245, 267, 276, 277, 280, 288], parents: {50, 235}, children: {288, 104, 170, 277, 280, 220}, spouse: {267, 13, 16, 147, 276, 155, 161, 166, 168, 169, 48, 50, 180, 55, 56, 64, 199, 203, 208, 102, 233, 234, 108, 109, 111, 112, 245, 117}
[2025-04-30 06:46:32,360] 4 Nodes of Markov blanket: [48, 108, 169, 180]
[2025-04-30 06:46:32,363] [MB metrics] precision: 1.000, recall: 0.114, acc: 0.893, f1: 0.205
[2025-04-30 06:46:39,453] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:46:39,453] sub_met2 before prunning None
[2025-04-30 06:46:39,453] sub_met after prunning None
[2025-04-30 06:46:39,453] 
===  109-th graph ===
[2025-04-30 06:46:39,453] 65 Nodes of True MB: [9, 10, 13, 32, 36, 49, 50, 55, 64, 67, 75, 82, 84, 88, 92, 95, 96, 97, 103, 107, 108, 109, 113, 119, 122, 129, 141, 147, 152, 155, 157, 158, 164, 166, 170, 183, 184, 185, 202, 207, 218, 222, 232, 233, 239, 245, 246, 248, 249, 250, 251, 260, 267, 272, 281, 282, 284, 285, 286, 287, 288, 292, 294, 296, 299], parents: {166, 239}, children: {96, 288, 292, 294, 103, 55, 185, 282, 286}, spouse: {129, 260, 9, 10, 267, 141, 13, 272, 147, 152, 281, 155, 284, 285, 158, 287, 32, 157, 164, 36, 296, 170, 299, 49, 50, 183, 184, 64, 67, 202, 75, 207, 82, 84, 88, 218, 92, 222, 95, 97, 232, 233, 250, 107, 108, 109, 239, 113, 245, 246, 119, 248, 249, 122, 251}
[2025-04-30 06:46:39,453] 13 Nodes of Markov blanket: [9, 36, 50, 67, 107, 109, 119, 184, 222, 232, 251, 284, 287]
[2025-04-30 06:46:39,453] [MB metrics] precision: 1.000, recall: 0.200, acc: 0.827, f1: 0.333
[2025-04-30 06:46:55,681] sub_met2 before prunning None
[2025-04-30 06:46:55,681] sub_met after prunning {'fdr': 0.9, 'tpr': 0.6667, 'fpr': 0.24, 'shd': 19, 'nnz': 20, 'precision': 0.1, 'recall': 0.6667, 'F1': 0.1739, 'gscore': 0.0}
[2025-04-30 06:46:55,681] 
===  110-th graph ===
[2025-04-30 06:46:55,681] 59 Nodes of True MB: [18, 20, 24, 34, 40, 51, 58, 68, 71, 74, 78, 82, 84, 85, 95, 98, 100, 101, 107, 110, 116, 118, 121, 134, 135, 140, 141, 142, 147, 149, 150, 164, 166, 169, 170, 171, 178, 179, 181, 183, 194, 195, 204, 222, 231, 248, 250, 253, 254, 255, 258, 261, 281, 285, 291, 293, 296, 298, 299], parents: {169, 285}, children: {34, 296, 204, 18, 51, 84, 116, 24, 281, 58}, spouse: {258, 261, 134, 135, 140, 141, 142, 147, 20, 149, 150, 285, 291, 164, 293, 166, 40, 298, 299, 171, 170, 178, 179, 181, 183, 194, 195, 68, 71, 74, 78, 82, 85, 222, 95, 98, 100, 101, 231, 107, 110, 118, 248, 121, 250, 253, 254, 255}
[2025-04-30 06:46:55,681] 13 Nodes of Markov blanket: [71, 82, 95, 110, 118, 121, 135, 170, 171, 194, 254, 261, 293]
[2025-04-30 06:46:55,694] [MB metrics] precision: 1.000, recall: 0.220, acc: 0.847, f1: 0.361
[2025-04-30 06:47:10,705] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:47:10,705] sub_met2 before prunning None
[2025-04-30 06:47:10,705] sub_met after prunning None
[2025-04-30 06:47:10,705] 
===  111-th graph ===
[2025-04-30 06:47:10,705] 93 Nodes of True MB: [4, 5, 10, 12, 13, 16, 18, 20, 24, 25, 26, 30, 31, 40, 43, 45, 50, 52, 55, 56, 58, 59, 62, 66, 68, 69, 82, 83, 90, 92, 97, 99, 102, 105, 108, 111, 112, 113, 115, 122, 131, 134, 142, 143, 144, 147, 149, 152, 157, 159, 160, 161, 166, 168, 177, 180, 185, 186, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 216, 218, 219, 224, 225, 232, 233, 234, 244, 246, 247, 249, 251, 255, 258, 259, 260, 274, 277, 280, 281, 282, 290, 291, 299], parents: {152, 50, 219}, children: {160, 193, 290, 195, 168, 43, 45, 83, 52, 277, 26, 251, 30, 159}, spouse: {4, 5, 10, 12, 13, 16, 18, 20, 24, 25, 31, 40, 45, 55, 56, 58, 59, 62, 66, 68, 69, 82, 90, 92, 97, 99, 102, 105, 108, 111, 112, 113, 115, 122, 131, 134, 142, 143, 144, 147, 149, 157, 159, 161, 166, 168, 177, 180, 185, 186, 191, 192, 194, 196, 197, 198, 199, 200, 216, 218, 224, 225, 232, 233, 234, 244, 246, 247, 249, 255, 258, 259, 260, 274, 280, 281, 282, 291, 299}
[2025-04-30 06:47:10,705] 26 Nodes of Markov blanket: [4, 5, 13, 16, 24, 31, 45, 59, 62, 97, 99, 102, 105, 111, 115, 122, 131, 142, 159, 161, 234, 247, 255, 258, 280, 281]
[2025-04-30 06:47:10,705] [MB metrics] precision: 1.000, recall: 0.280, acc: 0.777, f1: 0.437
[2025-04-30 06:47:31,475] sub_met2 before prunning None
[2025-04-30 06:47:31,475] sub_met after prunning {'fdr': 0.9293, 'tpr': 0.4667, 'fpr': 0.2968, 'shd': 100, 'nnz': 99, 'precision': 0.0707, 'recall': 0.4667, 'F1': 0.1228, 'gscore': 0.0}
[2025-04-30 06:47:31,475] 
===  112-th graph ===
[2025-04-30 06:47:31,475] 52 Nodes of True MB: [6, 9, 16, 24, 40, 41, 45, 69, 72, 74, 87, 108, 111, 112, 115, 117, 118, 120, 135, 139, 147, 155, 158, 166, 168, 177, 180, 190, 194, 196, 198, 201, 203, 205, 206, 216, 218, 228, 231, 233, 245, 247, 251, 253, 264, 273, 276, 280, 282, 293, 295, 298], parents: {198}, children: {295, 72, 41, 45, 205, 280}, spouse: {6, 135, 264, 9, 139, 16, 273, 147, 276, 24, 282, 155, 158, 293, 166, 40, 168, 298, 177, 180, 190, 194, 196, 69, 201, 74, 203, 206, 87, 216, 218, 228, 231, 233, 108, 111, 112, 115, 245, 118, 247, 120, 117, 251, 253}
[2025-04-30 06:47:31,476] 12 Nodes of Markov blanket: [9, 87, 112, 115, 117, 120, 139, 198, 201, 245, 276, 282]
[2025-04-30 06:47:31,479] [MB metrics] precision: 1.000, recall: 0.231, acc: 0.866, f1: 0.375
[2025-04-30 06:47:48,991] sub_met2 before prunning None
[2025-04-30 06:47:48,991] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2812, 'shd': 19, 'nnz': 18, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:47:48,991] 
===  113-th graph ===
[2025-04-30 06:47:48,991] 56 Nodes of True MB: [4, 5, 6, 7, 10, 24, 25, 36, 55, 59, 64, 66, 67, 73, 80, 88, 90, 100, 105, 107, 109, 111, 113, 124, 128, 129, 132, 156, 157, 163, 166, 170, 184, 206, 214, 216, 219, 222, 232, 235, 239, 243, 244, 249, 252, 261, 264, 266, 267, 272, 274, 276, 280, 284, 286, 290], parents: {64, 128, 267, 206, 243, 244, 156}, children: {290, 132, 80, 216, 252, 286}, spouse: {129, 4, 5, 261, 6, 264, 7, 10, 266, 272, 274, 276, 280, 24, 25, 284, 157, 163, 36, 166, 170, 55, 184, 59, 64, 66, 67, 73, 214, 88, 90, 219, 222, 100, 232, 105, 235, 107, 109, 111, 239, 113, 249, 124}
[2025-04-30 06:47:48,991] 17 Nodes of Markov blanket: [6, 55, 64, 66, 67, 100, 105, 107, 113, 124, 163, 166, 214, 219, 264, 272, 276]
[2025-04-30 06:47:49,000] [MB metrics] precision: 1.000, recall: 0.304, acc: 0.866, f1: 0.466
[2025-04-30 06:48:07,796] sub_met2 before prunning None
[2025-04-30 06:48:07,796] sub_met after prunning {'fdr': 0.931, 'tpr': 0.4, 'fpr': 0.4286, 'shd': 59, 'nnz': 58, 'precision': 0.069, 'recall': 0.4, 'F1': 0.1176, 'gscore': 0.0}
[2025-04-30 06:48:07,796] 
===  114-th graph ===
[2025-04-30 06:48:07,796] 5 Nodes of True MB: [26, 114, 145, 214, 261], parents: {145, 26, 261, 214}, children: set(), spouse: {114}
[2025-04-30 06:48:07,802] 
===  115-th graph ===
[2025-04-30 06:48:07,802] 47 Nodes of True MB: [0, 5, 9, 11, 16, 30, 46, 56, 60, 61, 64, 66, 68, 69, 78, 82, 87, 88, 101, 102, 107, 111, 112, 115, 117, 120, 130, 139, 153, 159, 194, 196, 197, 200, 203, 205, 208, 220, 233, 240, 242, 246, 256, 259, 260, 282, 292], parents: set(), children: {130, 69, 107, 203, 205, 82, 246, 120, 60, 159}, spouse: {256, 0, 259, 260, 5, 9, 11, 139, 16, 153, 282, 30, 292, 46, 56, 61, 64, 66, 194, 196, 197, 69, 68, 200, 78, 208, 82, 87, 88, 220, 101, 102, 233, 111, 240, 112, 242, 115, 117, 120}
[2025-04-30 06:48:07,802] 26 Nodes of Markov blanket: [0, 5, 9, 11, 30, 46, 56, 61, 66, 69, 82, 87, 101, 107, 111, 112, 115, 120, 139, 197, 200, 208, 220, 240, 259, 282]
[2025-04-30 06:48:07,802] [MB metrics] precision: 1.000, recall: 0.553, acc: 0.928, f1: 0.712
[2025-04-30 06:48:28,024] sub_met2 before prunning None
[2025-04-30 06:48:28,024] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.0939, 'shd': 43, 'nnz': 29, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:48:28,024] 
===  116-th graph ===
[2025-04-30 06:48:28,024] 24 Nodes of True MB: [44, 45, 67, 70, 93, 110, 116, 135, 141, 142, 149, 150, 154, 160, 170, 182, 184, 190, 195, 252, 253, 271, 277, 295], parents: {195, 170, 142, 110, 149, 150, 253}, children: {184, 93}, spouse: {160, 67, 70, 135, 295, 44, 141, 45, 142, 271, 116, 277, 182, 154, 252, 190}
[2025-04-30 06:48:28,032] 5 Nodes of Markov blanket: [45, 116, 141, 182, 277]
[2025-04-30 06:48:28,035] [MB metrics] precision: 1.000, recall: 0.208, acc: 0.936, f1: 0.345
[2025-04-30 06:48:35,449] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:48:35,449] sub_met2 before prunning None
[2025-04-30 06:48:35,449] sub_met after prunning None
[2025-04-30 06:48:35,449] 
===  117-th graph ===
[2025-04-30 06:48:35,449] 49 Nodes of True MB: [6, 16, 18, 25, 33, 40, 44, 46, 47, 69, 70, 74, 88, 91, 103, 107, 108, 112, 115, 117, 126, 135, 140, 141, 142, 147, 158, 168, 174, 189, 192, 203, 208, 216, 233, 242, 244, 250, 255, 259, 266, 270, 275, 276, 280, 281, 294, 298, 299], parents: {91, 140}, children: {69, 70, 6, 44, 142, 242, 275, 280, 255}, spouse: {259, 6, 135, 266, 140, 141, 270, 16, 18, 147, 276, 281, 25, 158, 33, 294, 40, 168, 298, 299, 46, 47, 174, 189, 192, 74, 203, 208, 216, 88, 103, 233, 107, 108, 112, 115, 244, 117, 250, 126}
[2025-04-30 06:48:35,449] 19 Nodes of Markov blanket: [25, 46, 47, 88, 103, 112, 117, 126, 140, 141, 147, 158, 192, 203, 233, 244, 270, 276, 294]
[2025-04-30 06:48:35,449] [MB metrics] precision: 1.000, recall: 0.388, acc: 0.900, f1: 0.559
[2025-04-30 06:48:55,176] sub_met2 before prunning None
[2025-04-30 06:48:55,176] sub_met after prunning {'fdr': 0.9796, 'tpr': 0.1667, 'fpr': 0.2909, 'shd': 52, 'nnz': 49, 'precision': 0.0204, 'recall': 0.1667, 'F1': 0.0364, 'gscore': 0.0}
[2025-04-30 06:48:55,176] 
===  118-th graph ===
[2025-04-30 06:48:55,176] 52 Nodes of True MB: [0, 6, 7, 13, 24, 27, 33, 41, 51, 63, 71, 74, 75, 80, 82, 94, 100, 104, 110, 112, 118, 122, 135, 150, 158, 166, 171, 173, 175, 183, 189, 199, 201, 203, 206, 208, 228, 235, 244, 245, 249, 254, 257, 260, 261, 262, 267, 277, 284, 287, 293, 294], parents: {284, 294, 63}, children: {0, 262, 41, 173, 51, 150}, spouse: {257, 260, 261, 6, 7, 135, 267, 13, 277, 24, 27, 158, 287, 33, 293, 166, 171, 175, 183, 189, 199, 71, 201, 74, 203, 75, 206, 208, 80, 82, 94, 100, 228, 104, 235, 110, 112, 244, 245, 118, 249, 122, 254}
[2025-04-30 06:48:55,176] 16 Nodes of Markov blanket: [13, 33, 71, 94, 100, 110, 118, 122, 135, 171, 173, 199, 203, 257, 287, 293]
[2025-04-30 06:48:55,191] [MB metrics] precision: 1.000, recall: 0.308, acc: 0.878, f1: 0.471
[2025-04-30 06:49:13,349] sub_met2 before prunning None
[2025-04-30 06:49:13,349] sub_met after prunning {'fdr': 0.9074, 'tpr': 0.8333, 'fpr': 0.4298, 'shd': 50, 'nnz': 54, 'precision': 0.0926, 'recall': 0.8333, 'F1': 0.1667, 'gscore': 0.0}
[2025-04-30 06:49:13,349] 
===  119-th graph ===
[2025-04-30 06:49:13,349] 37 Nodes of True MB: [1, 5, 20, 36, 44, 55, 67, 87, 92, 109, 119, 126, 129, 141, 142, 144, 148, 149, 158, 162, 173, 185, 202, 206, 213, 218, 229, 235, 241, 243, 251, 256, 257, 281, 283, 291, 298], parents: {67, 141, 235}, children: {229, 162, 149, 55}, spouse: {256, 129, 1, 257, 5, 142, 144, 20, 148, 281, 283, 158, 291, 36, 298, 44, 173, 185, 202, 206, 213, 87, 218, 92, 109, 241, 243, 119, 251, 126}
[2025-04-30 06:49:13,349] 15 Nodes of Markov blanket: [1, 5, 55, 92, 109, 119, 141, 142, 185, 218, 241, 251, 283, 291, 298]
[2025-04-30 06:49:13,366] [MB metrics] precision: 1.000, recall: 0.405, acc: 0.926, f1: 0.577
[2025-04-30 06:49:29,924] sub_met2 before prunning None
[2025-04-30 06:49:29,924] sub_met after prunning {'fdr': 0.9032, 'tpr': 0.4286, 'fpr': 0.2857, 'shd': 32, 'nnz': 31, 'precision': 0.0968, 'recall': 0.4286, 'F1': 0.1579, 'gscore': 0.0}
[2025-04-30 06:49:29,924] 
===  120-th graph ===
[2025-04-30 06:49:29,924] 49 Nodes of True MB: [0, 9, 24, 27, 29, 32, 38, 39, 44, 48, 50, 69, 73, 82, 87, 92, 97, 100, 101, 112, 115, 120, 134, 139, 140, 142, 144, 157, 158, 168, 170, 181, 191, 196, 197, 205, 211, 219, 220, 223, 225, 227, 233, 241, 256, 270, 277, 282, 284], parents: {256, 101, 69, 115, 220}, children: {227, 196, 39, 205, 270, 158}, spouse: {0, 134, 9, 139, 140, 142, 144, 277, 24, 282, 27, 284, 157, 29, 32, 38, 168, 170, 44, 48, 50, 181, 191, 196, 197, 69, 73, 82, 211, 87, 219, 92, 223, 97, 225, 227, 100, 101, 233, 112, 241, 115, 120}
[2025-04-30 06:49:29,932] 19 Nodes of Markov blanket: [9, 29, 44, 48, 87, 101, 112, 115, 120, 134, 139, 144, 170, 191, 211, 223, 227, 277, 282]
[2025-04-30 06:49:29,933] [MB metrics] precision: 1.000, recall: 0.388, acc: 0.895, f1: 0.559
[2025-04-30 06:49:49,343] sub_met2 before prunning None
[2025-04-30 06:49:49,343] sub_met after prunning {'fdr': 0.8723, 'tpr': 0.5, 'fpr': 0.2579, 'shd': 45, 'nnz': 47, 'precision': 0.1277, 'recall': 0.5, 'F1': 0.2034, 'gscore': 0.0}
[2025-04-30 06:49:49,343] 
===  121-th graph ===
[2025-04-30 06:49:49,343] 39 Nodes of True MB: [7, 19, 25, 30, 42, 47, 48, 54, 55, 64, 92, 98, 101, 106, 110, 121, 127, 140, 141, 144, 179, 191, 204, 218, 220, 227, 231, 233, 234, 235, 237, 248, 254, 270, 277, 279, 287, 298, 299], parents: set(), children: {235, 204, 47, 19, 179, 54, 127}, spouse: {7, 140, 141, 270, 144, 277, 279, 25, 30, 287, 298, 299, 42, 48, 55, 191, 64, 218, 92, 220, 98, 227, 101, 231, 233, 106, 234, 235, 237, 110, 248, 121, 254}
[2025-04-30 06:49:49,352] 10 Nodes of Markov blanket: [30, 42, 48, 110, 121, 140, 234, 254, 277, 298]
[2025-04-30 06:49:49,353] [MB metrics] precision: 1.000, recall: 0.256, acc: 0.903, f1: 0.408
[2025-04-30 06:50:05,078] sub_met2 before prunning None
[2025-04-30 06:50:05,078] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.1163, 'shd': 7, 'nnz': 5, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:50:05,078] 
===  122-th graph ===
[2025-04-30 06:50:05,078] 62 Nodes of True MB: [0, 10, 11, 16, 20, 24, 31, 32, 38, 44, 49, 70, 77, 82, 84, 95, 96, 97, 99, 100, 102, 104, 109, 111, 118, 122, 124, 126, 131, 133, 135, 141, 142, 147, 149, 159, 160, 166, 169, 172, 174, 184, 194, 195, 199, 200, 224, 225, 228, 229, 231, 237, 239, 244, 256, 257, 260, 275, 286, 287, 293, 296], parents: {200, 82, 102}, children: {0, 97, 96, 160, 195, 133, 231, 11, 172, 126}, spouse: {256, 257, 131, 260, 135, 10, 11, 141, 142, 16, 147, 20, 149, 275, 24, 286, 287, 32, 31, 159, 293, 166, 38, 296, 169, 44, 174, 49, 184, 194, 70, 199, 77, 84, 95, 224, 97, 225, 99, 100, 228, 102, 229, 104, 109, 237, 239, 111, 244, 118, 122, 124}
[2025-04-30 06:50:05,078] 11 Nodes of Markov blanket: [100, 104, 111, 118, 122, 124, 228, 237, 256, 257, 287]
[2025-04-30 06:50:05,078] [MB metrics] precision: 1.000, recall: 0.177, acc: 0.828, f1: 0.301
[2025-04-30 06:50:21,371] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:50:21,371] sub_met2 before prunning None
[2025-04-30 06:50:21,371] sub_met after prunning None
[2025-04-30 06:50:21,371] 
===  123-th graph ===
[2025-04-30 06:50:21,371] 22 Nodes of True MB: [10, 23, 26, 38, 42, 79, 86, 87, 97, 106, 107, 123, 135, 160, 164, 180, 199, 241, 244, 252, 272, 278], parents: {164, 38, 135, 107, 272, 180, 26}, children: {79, 23}, spouse: {160, 97, 199, 135, 42, 10, 106, 241, 244, 86, 87, 278, 123, 252}
[2025-04-30 06:50:21,371] 5 Nodes of Markov blanket: [42, 123, 241, 244, 252]
[2025-04-30 06:50:21,371] [MB metrics] precision: 1.000, recall: 0.227, acc: 0.939, f1: 0.370
[2025-04-30 06:50:28,755] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:50:28,755] sub_met2 before prunning None
[2025-04-30 06:50:28,755] sub_met after prunning None
[2025-04-30 06:50:28,755] 
===  124-th graph ===
[2025-04-30 06:50:28,755] 35 Nodes of True MB: [7, 38, 39, 48, 64, 67, 73, 82, 86, 104, 113, 122, 124, 126, 133, 157, 169, 179, 194, 207, 211, 216, 219, 222, 226, 235, 237, 239, 244, 259, 265, 266, 272, 275, 292], parents: {73}, children: {259, 272, 86, 216, 126}, spouse: {259, 133, 7, 265, 266, 272, 275, 157, 292, 38, 39, 169, 48, 179, 64, 194, 67, 207, 82, 211, 219, 222, 226, 104, 235, 237, 239, 113, 244, 122, 124}
[2025-04-30 06:50:28,755] 11 Nodes of Markov blanket: [7, 48, 64, 104, 113, 122, 124, 211, 219, 237, 272]
[2025-04-30 06:50:28,755] [MB metrics] precision: 1.000, recall: 0.314, acc: 0.918, f1: 0.478
[2025-04-30 06:50:43,671] sub_met2 before prunning None
[2025-04-30 06:50:43,671] sub_met after prunning {'fdr': 0.9394, 'tpr': 0.4, 'fpr': 0.62, 'shd': 34, 'nnz': 33, 'precision': 0.0606, 'recall': 0.4, 'F1': 0.1053, 'gscore': 0.0}
[2025-04-30 06:50:43,671] 
===  125-th graph ===
[2025-04-30 06:50:43,671] 50 Nodes of True MB: [0, 2, 3, 5, 12, 13, 23, 39, 50, 59, 61, 77, 82, 91, 95, 100, 125, 134, 139, 141, 150, 155, 159, 160, 171, 180, 181, 185, 190, 191, 195, 198, 201, 204, 212, 215, 216, 221, 225, 228, 232, 234, 236, 248, 251, 259, 262, 269, 277, 287], parents: {248, 259, 134, 234, 215, 216, 251}, children: {201, 2, 3, 212}, spouse: {0, 5, 134, 262, 139, 12, 13, 269, 141, 277, 150, 23, 155, 159, 160, 287, 39, 171, 50, 180, 181, 185, 59, 61, 190, 191, 195, 198, 204, 77, 82, 91, 221, 95, 225, 228, 100, 232, 236, 251, 125}
[2025-04-30 06:50:43,671] 6 Nodes of Markov blanket: [125, 150, 180, 236, 251, 277]
[2025-04-30 06:50:43,675] [MB metrics] precision: 1.000, recall: 0.120, acc: 0.847, f1: 0.214
[2025-04-30 06:50:53,869] sub_met2 before prunning None
[2025-04-30 06:50:53,869] sub_met after prunning {'fdr': 0.7143, 'tpr': 1.0, 'fpr': 0.3846, 'shd': 5, 'nnz': 7, 'precision': 0.2857, 'recall': 1.0, 'F1': 0.4444, 'gscore': 0.0}
[2025-04-30 06:50:53,869] 
===  126-th graph ===
[2025-04-30 06:50:53,869] 49 Nodes of True MB: [6, 15, 38, 46, 81, 88, 98, 104, 106, 117, 119, 122, 124, 126, 136, 140, 141, 144, 145, 149, 156, 158, 170, 173, 175, 181, 186, 188, 190, 194, 199, 200, 206, 208, 213, 219, 223, 224, 237, 243, 244, 246, 259, 260, 275, 280, 281, 295, 298], parents: {38, 104, 237, 275, 122, 124}, children: {6, 81, 149, 188, 190}, spouse: {259, 260, 136, 140, 141, 15, 144, 145, 280, 281, 156, 158, 295, 298, 170, 173, 46, 175, 181, 186, 194, 199, 200, 206, 208, 213, 88, 219, 223, 224, 98, 106, 243, 244, 117, 246, 119, 126}
[2025-04-30 06:50:53,869] 15 Nodes of Markov blanket: [15, 104, 117, 126, 136, 140, 145, 156, 158, 170, 175, 224, 246, 260, 280]
[2025-04-30 06:50:53,869] [MB metrics] precision: 1.000, recall: 0.306, acc: 0.886, f1: 0.469
[2025-04-30 06:51:10,603] sub_met2 before prunning None
[2025-04-30 06:51:10,603] sub_met after prunning {'fdr': 0.9744, 'tpr': 0.25, 'fpr': 0.3762, 'shd': 41, 'nnz': 39, 'precision': 0.0256, 'recall': 0.25, 'F1': 0.0465, 'gscore': 0.0}
[2025-04-30 06:51:10,603] 
===  127-th graph ===
[2025-04-30 06:51:10,603] 7 Nodes of True MB: [55, 98, 121, 127, 235, 270, 277], parents: {98, 235, 270, 277, 55, 121}, children: set(), spouse: {127}
[2025-04-30 06:51:10,603] 
===  128-th graph ===
[2025-04-30 06:51:10,603] 43 Nodes of True MB: [5, 22, 29, 32, 48, 55, 64, 68, 73, 75, 78, 90, 102, 104, 107, 113, 128, 135, 141, 143, 145, 154, 156, 159, 174, 177, 179, 180, 183, 202, 206, 208, 221, 243, 244, 247, 249, 251, 267, 269, 275, 287, 296], parents: {102, 296, 143, 48, 145, 179, 29, 287}, children: {113, 269, 5, 247}, spouse: {128, 135, 267, 141, 275, 22, 154, 156, 159, 32, 174, 177, 179, 180, 55, 183, 64, 68, 73, 202, 75, 206, 78, 208, 90, 221, 102, 104, 107, 243, 244, 249, 251}
[2025-04-30 06:51:10,616] 10 Nodes of Markov blanket: [32, 64, 75, 102, 128, 141, 154, 159, 179, 251]
[2025-04-30 06:51:10,618] [MB metrics] precision: 1.000, recall: 0.233, acc: 0.889, f1: 0.377
[2025-04-30 06:51:26,278] sub_met2 before prunning None
[2025-04-30 06:51:26,278] sub_met after prunning {'fdr': 0.9375, 'tpr': 0.3333, 'fpr': 0.3571, 'shd': 17, 'nnz': 16, 'precision': 0.0625, 'recall': 0.3333, 'F1': 0.1053, 'gscore': 0.0}
[2025-04-30 06:51:26,278] 
===  129-th graph ===
[2025-04-30 06:51:26,278] 39 Nodes of True MB: [12, 36, 38, 44, 49, 50, 63, 66, 67, 85, 87, 88, 92, 96, 103, 107, 109, 113, 119, 129, 134, 135, 145, 146, 160, 161, 169, 170, 181, 184, 202, 215, 222, 229, 232, 233, 270, 283, 286], parents: {96, 161, 66, 135, 169, 233, 49, 145, 63}, children: {146, 12, 229, 286}, spouse: {129, 134, 135, 270, 283, 160, 161, 36, 38, 170, 44, 50, 181, 184, 66, 67, 202, 85, 215, 87, 88, 92, 222, 103, 232, 107, 109, 113, 119}
[2025-04-30 06:51:26,286] 9 Nodes of Markov blanket: [50, 66, 85, 129, 145, 160, 161, 181, 215]
[2025-04-30 06:51:26,290] [MB metrics] precision: 1.000, recall: 0.231, acc: 0.895, f1: 0.375
[2025-04-30 06:51:41,848] sub_met2 before prunning None
[2025-04-30 06:51:41,848] sub_met after prunning {'fdr': 0.8333, 'tpr': 0.75, 'fpr': 0.4688, 'shd': 16, 'nnz': 18, 'precision': 0.1667, 'recall': 0.75, 'F1': 0.2727, 'gscore': 0.0}
[2025-04-30 06:51:41,848] 
===  130-th graph ===
[2025-04-30 06:51:41,848] 19 Nodes of True MB: [5, 11, 13, 18, 46, 56, 61, 66, 82, 115, 130, 150, 151, 194, 220, 230, 242, 260, 292], parents: {66, 194, 292, 5, 11, 46, 82, 115, 242, 56, 61}, children: {151}, spouse: {130, 260, 230, 13, 18, 150, 220}
[2025-04-30 06:51:41,848] 
===  131-th graph ===
[2025-04-30 06:51:41,848] 30 Nodes of True MB: [20, 21, 31, 42, 43, 65, 69, 71, 84, 102, 111, 122, 131, 144, 159, 167, 182, 185, 194, 195, 215, 222, 224, 225, 234, 239, 275, 288, 291, 299], parents: set(), children: {195, 167, 144, 21, 222}, spouse: {131, 275, 20, 159, 31, 288, 291, 42, 43, 299, 182, 185, 65, 194, 69, 71, 84, 215, 224, 225, 102, 234, 111, 239, 122}
[2025-04-30 06:51:41,852] 9 Nodes of Markov blanket: [31, 43, 65, 69, 111, 131, 159, 224, 291]
[2025-04-30 06:51:41,853] [MB metrics] precision: 1.000, recall: 0.300, acc: 0.930, f1: 0.462
[2025-04-30 06:51:58,303] sub_met2 before prunning None
[2025-04-30 06:51:58,303] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2941, 'shd': 12, 'nnz': 10, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:51:58,303] 
===  132-th graph ===
[2025-04-30 06:51:58,303] 10 Nodes of True MB: [55, 66, 100, 113, 132, 163, 166, 261, 264, 284], parents: {66, 163, 100, 261, 166, 264, 113, 55, 284}, children: set(), spouse: {132}
[2025-04-30 06:51:58,303] 
===  133-th graph ===
[2025-04-30 06:51:58,312] 49 Nodes of True MB: [20, 22, 25, 29, 35, 38, 39, 47, 55, 64, 65, 70, 73, 74, 76, 77, 86, 92, 95, 101, 122, 124, 133, 135, 140, 156, 157, 169, 191, 204, 207, 208, 221, 224, 226, 239, 245, 251, 253, 255, 256, 264, 265, 266, 268, 282, 292, 293, 295], parents: {135, 77, 20, 122, 95}, children: {65, 35, 293, 268, 86}, spouse: {256, 133, 264, 265, 266, 140, 22, 25, 282, 156, 29, 157, 292, 38, 295, 39, 169, 47, 55, 191, 64, 70, 73, 74, 76, 204, 207, 208, 92, 221, 224, 226, 101, 239, 245, 251, 124, 253, 255}
[2025-04-30 06:51:58,312] 7 Nodes of Markov blanket: [25, 73, 101, 133, 156, 224, 253]
[2025-04-30 06:51:58,316] [MB metrics] precision: 1.000, recall: 0.143, acc: 0.858, f1: 0.250
[2025-04-30 06:52:11,322] sub_met2 before prunning None
[2025-04-30 06:52:11,322] sub_met after prunning {'fdr': 0.9286, 'tpr': 1.0, 'fpr': 0.65, 'shd': 13, 'nnz': 14, 'precision': 0.0714, 'recall': 1.0, 'F1': 0.1333, 'gscore': 0.0}
[2025-04-30 06:52:11,322] 
===  134-th graph ===
[2025-04-30 06:52:11,322] 70 Nodes of True MB: [0, 3, 4, 7, 12, 24, 27, 39, 48, 52, 54, 58, 73, 76, 82, 85, 100, 103, 110, 111, 120, 125, 129, 134, 135, 138, 141, 143, 144, 146, 157, 160, 164, 168, 178, 181, 185, 191, 193, 194, 196, 198, 209, 214, 215, 216, 219, 223, 225, 227, 232, 233, 234, 241, 245, 247, 248, 251, 255, 256, 257, 259, 262, 274, 281, 284, 287, 289, 290, 291], parents: {256, 164}, children: {3, 4, 196, 7, 138, 146, 52, 214, 215, 281, 125}, spouse: {0, 257, 129, 259, 134, 262, 7, 135, 12, 141, 143, 144, 274, 24, 27, 284, 157, 287, 160, 289, 290, 291, 39, 168, 48, 178, 181, 54, 185, 58, 191, 193, 194, 198, 73, 76, 209, 82, 85, 215, 216, 219, 223, 248, 225, 227, 100, 103, 232, 233, 234, 110, 111, 241, 245, 247, 120, 251, 125, 255}
[2025-04-30 06:52:11,322] 17 Nodes of Markov blanket: [0, 54, 85, 103, 120, 134, 141, 178, 191, 215, 216, 225, 232, 233, 245, 248, 287]
[2025-04-30 06:52:11,322] [MB metrics] precision: 1.000, recall: 0.243, acc: 0.818, f1: 0.391
[2025-04-30 06:52:30,026] sub_met2 before prunning None
[2025-04-30 06:52:30,026] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3359, 'shd': 49, 'nnz': 44, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:52:30,026] 
===  135-th graph ===
[2025-04-30 06:52:30,028] 105 Nodes of True MB: [10, 12, 16, 18, 20, 23, 26, 31, 38, 40, 44, 45, 48, 49, 50, 51, 55, 63, 64, 66, 68, 70, 71, 72, 75, 77, 87, 95, 96, 97, 98, 102, 103, 104, 106, 107, 110, 112, 116, 117, 118, 122, 123, 128, 129, 133, 134, 135, 141, 142, 143, 144, 145, 147, 159, 160, 161, 164, 166, 169, 171, 177, 179, 180, 181, 182, 183, 184, 190, 201, 202, 208, 211, 215, 216, 218, 219, 220, 230, 233, 234, 240, 248, 251, 253, 256, 257, 259, 261, 264, 269, 270, 272, 273, 274, 276, 277, 278, 279, 289, 293, 295, 296, 298, 299], parents: {208, 219}, children: {129, 98, 133, 70, 102, 72, 230, 296, 12, 269, 240, 51, 23, 184, 215, 123, 31}, spouse: {10, 16, 18, 20, 26, 38, 40, 44, 45, 48, 49, 50, 55, 63, 64, 66, 68, 71, 75, 77, 87, 95, 96, 97, 103, 104, 106, 107, 110, 112, 116, 117, 118, 122, 123, 128, 129, 134, 135, 141, 142, 143, 144, 145, 147, 159, 160, 161, 164, 166, 169, 171, 177, 179, 180, 181, 182, 183, 190, 201, 202, 208, 211, 216, 218, 220, 230, 233, 234, 248, 251, 253, 256, 257, 259, 261, 264, 270, 272, 273, 274, 276, 277, 278, 279, 289, 293, 295, 298, 299}
[2025-04-30 06:52:30,028] 20 Nodes of Markov blanket: [16, 18, 20, 48, 71, 102, 110, 118, 135, 144, 145, 169, 171, 183, 208, 211, 233, 274, 279, 293]
[2025-04-30 06:52:30,030] [MB metrics] precision: 1.000, recall: 0.190, acc: 0.717, f1: 0.320
[2025-04-30 06:52:49,282] sub_met2 before prunning None
[2025-04-30 06:52:49,282] sub_met after prunning {'fdr': 0.9016, 'tpr': 0.6667, 'fpr': 0.3039, 'shd': 58, 'nnz': 61, 'precision': 0.0984, 'recall': 0.6667, 'F1': 0.1714, 'gscore': 0.0}
[2025-04-30 06:52:49,282] 
===  136-th graph ===
[2025-04-30 06:52:49,282] 19 Nodes of True MB: [15, 20, 27, 46, 81, 88, 98, 126, 136, 156, 170, 175, 194, 208, 219, 255, 268, 280, 295], parents: {98, 268, 20, 27, 255}, children: {81}, spouse: {280, 194, 295, 136, 170, 46, 15, 175, 208, 88, 219, 156, 126}
[2025-04-30 06:52:49,282] 5 Nodes of Markov blanket: [15, 126, 136, 170, 175]
[2025-04-30 06:52:49,289] [MB metrics] precision: 1.000, recall: 0.263, acc: 0.953, f1: 0.417
[2025-04-30 06:52:56,757] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:52:56,757] sub_met2 before prunning None
[2025-04-30 06:52:56,757] sub_met after prunning None
[2025-04-30 06:52:56,757] 
===  137-th graph ===
[2025-04-30 06:52:56,757] 7 Nodes of True MB: [6, 37, 92, 97, 137, 159, 187], parents: {97, 37, 6, 187, 92, 159}, children: set(), spouse: {137}
[2025-04-30 06:52:56,757] 
===  138-th graph ===
[2025-04-30 06:52:56,757] 12 Nodes of True MB: [7, 54, 76, 103, 134, 138, 178, 193, 209, 232, 262, 290], parents: {193, 290, 134, 103, 7, 232, 262, 76, 209, 178, 54}, children: set(), spouse: {138}
[2025-04-30 06:52:56,757] 
===  139-th graph ===
[2025-04-30 06:52:56,757] 35 Nodes of True MB: [9, 23, 32, 48, 59, 73, 74, 77, 80, 87, 100, 112, 115, 120, 125, 139, 141, 150, 156, 164, 171, 174, 180, 190, 191, 196, 204, 205, 212, 221, 223, 237, 258, 282, 294], parents: {32, 223, 164, 48, 59, 156, 191}, children: {258, 212, 205}, spouse: {9, 139, 141, 150, 23, 282, 294, 171, 174, 180, 190, 196, 73, 74, 204, 77, 80, 87, 221, 100, 237, 112, 115, 120, 125}
[2025-04-30 06:52:56,757] 7 Nodes of Markov blanket: [9, 87, 112, 115, 120, 139, 282]
[2025-04-30 06:52:56,757] [MB metrics] precision: 1.000, recall: 0.200, acc: 0.905, f1: 0.333
[2025-04-30 06:53:09,977] sub_met2 before prunning None
[2025-04-30 06:53:09,977] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.45, 'shd': 10, 'nnz': 9, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:53:09,977] 
===  140-th graph ===
[2025-04-30 06:53:09,977] 83 Nodes of True MB: [4, 6, 15, 18, 19, 20, 28, 30, 31, 32, 35, 38, 39, 42, 48, 50, 51, 55, 57, 62, 66, 69, 70, 73, 78, 84, 87, 88, 91, 97, 100, 102, 105, 107, 110, 117, 120, 121, 126, 133, 140, 142, 143, 147, 152, 153, 155, 156, 158, 164, 168, 170, 176, 178, 181, 182, 197, 198, 208, 210, 211, 223, 224, 225, 231, 232, 234, 237, 239, 240, 244, 245, 248, 253, 256, 261, 270, 277, 281, 283, 285, 295, 298], parents: set(), children: {35, 6, 39, 198, 105, 232, 270, 143, 18, 19, 210, 117, 182, 87, 283, 62}, spouse: {256, 4, 133, 261, 140, 142, 15, 147, 20, 277, 152, 281, 153, 155, 156, 285, 158, 30, 31, 32, 28, 164, 38, 295, 168, 298, 170, 42, 48, 176, 50, 178, 51, 181, 55, 57, 66, 197, 70, 69, 73, 78, 208, 211, 84, 88, 91, 223, 248, 97, 225, 224, 100, 102, 231, 234, 107, 237, 110, 239, 240, 244, 117, 245, 120, 121, 253, 126}
[2025-04-30 06:53:09,977] 25 Nodes of Markov blanket: [38, 42, 48, 84, 88, 97, 100, 107, 117, 121, 126, 140, 147, 153, 158, 170, 208, 211, 223, 231, 232, 234, 237, 240, 253]
[2025-04-30 06:53:09,982] [MB metrics] precision: 1.000, recall: 0.301, acc: 0.806, f1: 0.463
[2025-04-30 06:53:30,201] sub_met2 before prunning None
[2025-04-30 06:53:30,201] sub_met after prunning {'fdr': 0.9429, 'tpr': 0.4444, 'fpr': 0.2268, 'shd': 70, 'nnz': 70, 'precision': 0.0571, 'recall': 0.4444, 'F1': 0.1013, 'gscore': 0.0}
[2025-04-30 06:53:30,201] 
===  141-th graph ===
[2025-04-30 06:53:30,201] 87 Nodes of True MB: [7, 9, 15, 23, 25, 29, 32, 33, 36, 44, 45, 56, 67, 68, 73, 75, 77, 78, 88, 90, 96, 98, 100, 103, 107, 109, 110, 116, 117, 119, 121, 122, 125, 126, 128, 134, 135, 139, 141, 142, 145, 150, 152, 154, 171, 174, 182, 183, 184, 186, 188, 190, 192, 199, 200, 202, 206, 212, 219, 221, 222, 223, 224, 231, 232, 233, 235, 243, 246, 247, 251, 260, 267, 270, 275, 276, 277, 280, 284, 285, 289, 293, 294, 295, 296, 298, 299], parents: set(), children: {32, 33, 192, 36, 7, 103, 73, 231, 235, 44, 296, 243, 212, 119, 184, 247, 188}, spouse: {128, 260, 134, 135, 9, 267, 139, 141, 270, 15, 142, 145, 275, 276, 277, 150, 23, 152, 25, 154, 280, 284, 285, 29, 32, 289, 293, 294, 295, 298, 299, 171, 44, 174, 45, 182, 183, 56, 186, 190, 67, 68, 199, 200, 202, 75, 77, 206, 78, 88, 90, 219, 221, 222, 223, 96, 224, 98, 100, 232, 233, 107, 235, 109, 110, 116, 117, 246, 121, 122, 251, 125, 126}
[2025-04-30 06:53:30,211] 25 Nodes of Markov blanket: [32, 45, 67, 73, 78, 116, 117, 119, 128, 134, 141, 142, 150, 154, 182, 202, 221, 222, 251, 267, 270, 277, 289, 294, 299]
[2025-04-30 06:53:30,215] [MB metrics] precision: 1.000, recall: 0.287, acc: 0.793, f1: 0.446
[2025-04-30 06:53:50,203] sub_met2 before prunning None
[2025-04-30 06:53:50,203] sub_met after prunning {'fdr': 0.9375, 'tpr': 0.4615, 'fpr': 0.3136, 'shd': 96, 'nnz': 96, 'precision': 0.0625, 'recall': 0.4615, 'F1': 0.1101, 'gscore': 0.0}
[2025-04-30 06:53:50,203] 
===  142-th graph ===
[2025-04-30 06:53:50,219] 74 Nodes of True MB: [1, 4, 5, 16, 20, 24, 30, 33, 36, 38, 39, 40, 43, 44, 45, 50, 56, 88, 92, 97, 99, 100, 102, 103, 110, 111, 116, 117, 119, 120, 122, 135, 140, 141, 142, 144, 147, 148, 149, 150, 160, 161, 162, 168, 170, 182, 183, 184, 185, 190, 193, 195, 197, 211, 223, 229, 241, 243, 247, 250, 253, 256, 257, 260, 273, 276, 277, 280, 282, 284, 291, 295, 298, 299], parents: {250, 299, 117}, children: {160, 193, 162, 39, 273, 243, 116, 184, 30}, spouse: {256, 1, 257, 260, 4, 5, 135, 140, 141, 142, 16, 144, 147, 20, 148, 277, 276, 24, 280, 282, 149, 284, 150, 161, 33, 291, 36, 38, 295, 40, 168, 298, 170, 43, 44, 45, 50, 182, 183, 56, 185, 190, 195, 197, 211, 88, 247, 92, 223, 97, 99, 100, 229, 102, 103, 110, 111, 241, 116, 119, 120, 122, 253}
[2025-04-30 06:53:50,219] 14 Nodes of Markov blanket: [1, 5, 56, 111, 119, 141, 142, 185, 241, 256, 276, 277, 291, 298]
[2025-04-30 06:53:50,223] [MB metrics] precision: 1.000, recall: 0.189, acc: 0.800, f1: 0.318
[2025-04-30 06:54:06,238] sub_met2 before prunning None
[2025-04-30 06:54:06,238] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2273, 'shd': 23, 'nnz': 20, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:54:06,238] 
===  143-th graph ===
[2025-04-30 06:54:06,238] 30 Nodes of True MB: [12, 18, 20, 29, 48, 52, 58, 98, 102, 104, 111, 128, 134, 135, 140, 143, 145, 164, 168, 179, 198, 211, 230, 232, 247, 257, 276, 287, 291, 296], parents: {140, 164, 20}, children: {128, 98, 52}, spouse: {257, 134, 135, 12, 143, 145, 18, 276, 29, 287, 291, 296, 168, 48, 179, 58, 198, 211, 102, 230, 104, 232, 111, 247}
[2025-04-30 06:54:06,238] 
===  144-th graph ===
[2025-04-30 06:54:06,238] 30 Nodes of True MB: [7, 30, 32, 47, 48, 92, 101, 106, 111, 119, 120, 121, 126, 131, 134, 135, 142, 144, 149, 158, 168, 173, 181, 206, 213, 215, 234, 239, 243, 274], parents: {234, 131, 239}, children: {47, 30, 149, 215, 158}, spouse: {134, 7, 135, 142, 144, 274, 30, 32, 168, 173, 48, 181, 206, 213, 92, 101, 106, 111, 243, 119, 120, 121, 126}
[2025-04-30 06:54:06,250] 5 Nodes of Markov blanket: [48, 120, 135, 144, 274]
[2025-04-30 06:54:06,253] [MB metrics] precision: 1.000, recall: 0.167, acc: 0.909, f1: 0.286
[2025-04-30 06:54:13,663] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:54:13,663] sub_met2 before prunning None
[2025-04-30 06:54:13,663] sub_met after prunning None
[2025-04-30 06:54:13,663] 
===  145-th graph ===
[2025-04-30 06:54:13,663] 45 Nodes of True MB: [26, 29, 48, 49, 63, 66, 67, 74, 77, 87, 96, 98, 102, 105, 114, 126, 128, 129, 135, 141, 143, 145, 161, 168, 169, 179, 186, 187, 188, 197, 199, 214, 216, 223, 224, 227, 233, 246, 260, 261, 280, 284, 287, 296, 299], parents: {74, 299, 284, 87}, children: {128, 129, 114, 187, 188}, spouse: {260, 261, 135, 141, 143, 145, 280, 26, 29, 287, 161, 296, 169, 168, 48, 49, 179, 186, 63, 66, 67, 197, 199, 77, 214, 216, 223, 96, 224, 98, 227, 102, 233, 105, 246, 126}
[2025-04-30 06:54:13,663] 12 Nodes of Markov blanket: [63, 126, 129, 135, 145, 161, 169, 197, 233, 246, 261, 280]
[2025-04-30 06:54:13,663] [MB metrics] precision: 1.000, recall: 0.267, acc: 0.890, f1: 0.421
[2025-04-30 06:54:31,895] sub_met2 before prunning None
[2025-04-30 06:54:31,895] sub_met after prunning {'fdr': 0.8667, 'tpr': 0.2857, 'fpr': 0.2203, 'shd': 18, 'nnz': 15, 'precision': 0.1333, 'recall': 0.2857, 'F1': 0.1818, 'gscore': 0.0}
[2025-04-30 06:54:31,895] 
===  146-th graph ===
[2025-04-30 06:54:31,908] 7 Nodes of True MB: [85, 129, 134, 146, 160, 181, 215], parents: {160, 129, 134, 85, 181, 215}, children: set(), spouse: {146}
[2025-04-30 06:54:31,908] 
===  147-th graph ===
[2025-04-30 06:54:31,908] 45 Nodes of True MB: [11, 16, 18, 20, 24, 63, 66, 78, 84, 88, 95, 99, 100, 102, 107, 108, 109, 110, 111, 112, 117, 122, 135, 140, 142, 147, 157, 160, 164, 166, 168, 172, 199, 202, 203, 229, 233, 239, 256, 260, 276, 280, 282, 287, 298], parents: set(), children: {160, 66, 102, 298, 172, 18, 280, 282}, spouse: {256, 260, 135, 11, 140, 142, 16, 147, 20, 276, 24, 157, 287, 164, 166, 168, 63, 199, 202, 203, 78, 84, 88, 95, 99, 100, 229, 233, 107, 108, 109, 110, 111, 239, 112, 117, 122}
[2025-04-30 06:54:31,908] 11 Nodes of Markov blanket: [18, 63, 66, 88, 100, 107, 117, 140, 147, 229, 276]
[2025-04-30 06:54:31,912] [MB metrics] precision: 1.000, recall: 0.244, acc: 0.886, f1: 0.393
[2025-04-30 06:54:47,699] sub_met2 before prunning None
[2025-04-30 06:54:47,701] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.0217, 'shd': 10, 'nnz': 1, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:54:47,701] 
===  148-th graph ===
[2025-04-30 06:54:47,701] 51 Nodes of True MB: [1, 5, 10, 20, 24, 25, 36, 39, 40, 50, 67, 76, 89, 92, 101, 102, 105, 119, 142, 148, 160, 161, 162, 175, 185, 186, 189, 197, 213, 222, 236, 237, 240, 241, 243, 247, 251, 255, 256, 257, 259, 264, 266, 271, 281, 282, 284, 289, 291, 298, 299], parents: {160, 161, 197, 102, 264, 175, 240, 24, 282}, children: {89, 162, 213, 271}, spouse: {256, 1, 257, 259, 5, 266, 10, 142, 148, 20, 281, 25, 284, 289, 291, 36, 39, 40, 298, 299, 50, 185, 186, 189, 67, 76, 247, 92, 222, 101, 105, 236, 237, 241, 243, 119, 251, 255}
[2025-04-30 06:54:47,702] 11 Nodes of Markov blanket: [25, 76, 101, 105, 148, 185, 186, 237, 255, 266, 289]
[2025-04-30 06:54:47,705] [MB metrics] precision: 1.000, recall: 0.216, acc: 0.867, f1: 0.355
[2025-04-30 06:55:04,408] sub_met2 before prunning None
[2025-04-30 06:55:04,408] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3396, 'shd': 20, 'nnz': 18, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:55:04,408] 
===  149-th graph ===
[2025-04-30 06:55:04,408] 34 Nodes of True MB: [11, 44, 45, 70, 83, 84, 97, 110, 111, 116, 119, 122, 126, 142, 144, 149, 150, 166, 169, 170, 173, 184, 191, 195, 206, 213, 218, 224, 243, 246, 253, 258, 286, 293], parents: {173, 206, 144, 243, 213, 119, 126}, children: {83, 11, 116}, spouse: {258, 142, 149, 150, 286, 293, 166, 169, 170, 44, 45, 184, 191, 195, 70, 84, 218, 224, 97, 110, 111, 246, 122, 253}
[2025-04-30 06:55:04,408] 4 Nodes of Markov blanket: [149, 184, 224, 286]
[2025-04-30 06:55:04,418] [MB metrics] precision: 1.000, recall: 0.118, acc: 0.898, f1: 0.211
[2025-04-30 06:55:11,559] sub_met2 before prunning None
[2025-04-30 06:55:11,559] sub_met after prunning {'fdr': 0.5, 'tpr': 1.0, 'fpr': 0.2, 'shd': 1, 'nnz': 2, 'precision': 0.5, 'recall': 1.0, 'F1': 0.6667, 'gscore': 0.0}
[2025-04-30 06:55:11,559] 
===  150-th graph ===
[2025-04-30 06:55:11,559] 34 Nodes of True MB: [13, 18, 23, 27, 75, 77, 82, 100, 104, 110, 116, 118, 125, 130, 139, 141, 142, 149, 150, 151, 170, 171, 189, 190, 195, 212, 220, 221, 228, 230, 253, 257, 260, 277], parents: {257, 228, 260, 104, 75, 82, 277, 118, 27, 189}, children: {212, 116, 151}, spouse: {130, 260, 139, 141, 142, 13, 18, 149, 150, 23, 170, 171, 190, 195, 77, 220, 221, 100, 230, 110, 125, 253}
[2025-04-30 06:55:11,559] 9 Nodes of Markov blanket: [77, 100, 125, 141, 150, 170, 190, 221, 260]
[2025-04-30 06:55:11,571] [MB metrics] precision: 1.000, recall: 0.265, acc: 0.910, f1: 0.419
[2025-04-30 06:55:26,752] sub_met2 before prunning None
[2025-04-30 06:55:26,752] sub_met after prunning {'fdr': 0.9444, 'tpr': 0.5, 'fpr': 0.5, 'shd': 18, 'nnz': 18, 'precision': 0.0556, 'recall': 0.5, 'F1': 0.1, 'gscore': 0.0}
[2025-04-30 06:55:26,752] 
===  151-th graph ===
[2025-04-30 06:55:26,752] 8 Nodes of True MB: [13, 18, 130, 150, 151, 220, 230, 260], parents: {130, 260, 230, 13, 18, 150, 220}, children: set(), spouse: {151}
[2025-04-30 06:55:26,752] 
===  152-th graph ===
[2025-04-30 06:55:26,752] 50 Nodes of True MB: [13, 15, 25, 33, 40, 45, 49, 50, 62, 75, 88, 90, 105, 107, 109, 111, 140, 141, 152, 155, 165, 166, 168, 178, 185, 186, 187, 190, 194, 206, 209, 219, 222, 225, 226, 228, 232, 233, 234, 235, 236, 246, 250, 260, 266, 275, 287, 291, 293, 294], parents: set(), children: {33, 226, 228, 165, 294, 40, 236, 111, 15, 209, 62}, spouse: {260, 266, 140, 141, 13, 275, 152, 25, 155, 287, 291, 293, 166, 168, 45, 49, 178, 50, 185, 186, 187, 190, 194, 75, 206, 88, 90, 219, 222, 225, 226, 232, 233, 105, 235, 107, 109, 234, 246, 250}
[2025-04-30 06:55:26,752] 13 Nodes of Markov blanket: [13, 62, 75, 152, 194, 222, 225, 226, 233, 234, 246, 275, 287]
[2025-04-30 06:55:26,768] [MB metrics] precision: 1.000, recall: 0.260, acc: 0.875, f1: 0.413
[2025-04-30 06:55:42,238] sub_met2 before prunning None
[2025-04-30 06:55:42,238] sub_met after prunning {'fdr': 0.9286, 'tpr': 0.4, 'fpr': 0.3562, 'shd': 29, 'nnz': 28, 'precision': 0.0714, 'recall': 0.4, 'F1': 0.1212, 'gscore': 0.0}
[2025-04-30 06:55:42,238] 
===  153-th graph ===
[2025-04-30 06:55:42,238] 24 Nodes of True MB: [0, 4, 5, 28, 30, 60, 64, 77, 88, 115, 140, 153, 168, 178, 185, 189, 203, 208, 210, 220, 226, 253, 281, 285], parents: {168, 220, 77}, children: {210, 28, 60}, spouse: {0, 64, 226, 185, 4, 5, 281, 203, 140, 208, 178, 115, 189, 88, 153, 285, 253, 30}
[2025-04-30 06:55:42,241] 6 Nodes of Markov blanket: [0, 140, 153, 185, 208, 285]
[2025-04-30 06:55:42,243] [MB metrics] precision: 1.000, recall: 0.250, acc: 0.937, f1: 0.400
[2025-04-30 06:55:52,384] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:55:52,384] sub_met2 before prunning None
[2025-04-30 06:55:52,384] sub_met after prunning None
[2025-04-30 06:55:52,384] 
===  154-th graph ===
[2025-04-30 06:55:52,384] 20 Nodes of True MB: [32, 67, 68, 70, 78, 90, 93, 116, 128, 141, 154, 160, 178, 232, 247, 251, 252, 255, 260, 271], parents: {67, 260, 232, 178, 255}, children: {93, 247}, spouse: {160, 32, 128, 67, 68, 90, 70, 141, 78, 271, 116, 154, 251, 252}
[2025-04-30 06:55:52,384] 7 Nodes of Markov blanket: [32, 67, 68, 128, 141, 154, 251]
[2025-04-30 06:55:52,384] [MB metrics] precision: 1.000, recall: 0.350, acc: 0.952, f1: 0.519
[2025-04-30 06:56:05,598] sub_met2 before prunning None
[2025-04-30 06:56:05,598] sub_met after prunning {'fdr': 0.7, 'tpr': 0.75, 'fpr': 0.4118, 'shd': 8, 'nnz': 10, 'precision': 0.3, 'recall': 0.75, 'F1': 0.4286, 'gscore': 0.0}
[2025-04-30 06:56:05,598] 
===  155-th graph ===
[2025-04-30 06:56:05,598] 52 Nodes of True MB: [12, 13, 28, 31, 40, 49, 50, 64, 66, 77, 95, 108, 109, 112, 125, 140, 152, 155, 158, 159, 160, 166, 168, 174, 175, 180, 185, 189, 194, 201, 204, 208, 228, 231, 233, 236, 245, 246, 250, 260, 261, 267, 269, 275, 276, 277, 283, 287, 288, 289, 294, 295], parents: {246}, children: {288, 294, 295, 40, 201, 77, 175, 276, 283}, spouse: {260, 261, 267, 12, 13, 269, 140, 275, 277, 152, 155, 28, 158, 287, 159, 160, 31, 289, 166, 294, 168, 295, 174, 49, 50, 180, 185, 189, 64, 194, 66, 204, 208, 95, 228, 231, 233, 108, 109, 236, 112, 245, 246, 250, 125}
[2025-04-30 06:56:05,598] 14 Nodes of Markov blanket: [13, 49, 50, 64, 155, 168, 194, 208, 233, 246, 267, 275, 287, 295]
[2025-04-30 06:56:05,616] [MB metrics] precision: 1.000, recall: 0.269, acc: 0.872, f1: 0.424
[2025-04-30 06:56:21,003] sub_met2 before prunning None
[2025-04-30 06:56:21,003] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.314, 'shd': 31, 'nnz': 27, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:56:21,003] 
===  156-th graph ===
[2025-04-30 06:56:21,003] 46 Nodes of True MB: [15, 18, 32, 35, 46, 48, 55, 59, 64, 70, 73, 81, 88, 92, 106, 107, 113, 126, 128, 133, 136, 139, 140, 156, 164, 170, 175, 183, 191, 194, 203, 206, 208, 219, 223, 234, 239, 243, 244, 253, 256, 267, 280, 287, 289, 295], parents: {164, 107, 46, 92, 287}, children: {35, 106, 139, 81, 113}, spouse: {256, 128, 133, 136, 267, 140, 15, 18, 280, 156, 32, 289, 164, 295, 170, 46, 175, 48, 55, 183, 59, 191, 64, 194, 70, 73, 203, 206, 208, 88, 219, 223, 234, 239, 243, 244, 253, 126}
[2025-04-30 06:56:21,014] 14 Nodes of Markov blanket: [15, 46, 64, 73, 92, 126, 133, 156, 170, 175, 234, 243, 244, 253]
[2025-04-30 06:56:21,018] [MB metrics] precision: 1.000, recall: 0.304, acc: 0.892, f1: 0.467
[2025-04-30 06:56:36,801] sub_met2 before prunning None
[2025-04-30 06:56:36,801] sub_met after prunning {'fdr': 0.9, 'tpr': 1.0, 'fpr': 0.4138, 'shd': 36, 'nnz': 40, 'precision': 0.1, 'recall': 1.0, 'F1': 0.1818, 'gscore': 0.0}
[2025-04-30 06:56:36,801] 
===  157-th graph ===
[2025-04-30 06:56:36,801] 46 Nodes of True MB: [0, 5, 10, 24, 25, 27, 39, 59, 64, 66, 73, 84, 86, 90, 95, 105, 109, 111, 113, 120, 124, 133, 134, 147, 157, 164, 191, 196, 202, 207, 219, 223, 226, 227, 233, 241, 249, 265, 266, 274, 280, 282, 284, 287, 290, 292], parents: {226, 287}, children: {282, 196, 290, 86}, spouse: {0, 5, 134, 133, 265, 10, 266, 274, 147, 24, 25, 280, 27, 284, 157, 164, 292, 39, 59, 191, 64, 66, 73, 202, 207, 84, 90, 219, 223, 95, 226, 227, 233, 105, 109, 111, 241, 113, 120, 249, 124}
[2025-04-30 06:56:36,801] 6 Nodes of Markov blanket: [39, 59, 157, 202, 226, 266]
[2025-04-30 06:56:36,812] [MB metrics] precision: 1.000, recall: 0.130, acc: 0.863, f1: 0.231
[2025-04-30 06:56:46,730] sub_met2 before prunning None
[2025-04-30 06:56:46,730] sub_met after prunning {'fdr': 0.5, 'tpr': 0.5, 'fpr': 0.0769, 'shd': 2, 'nnz': 2, 'precision': 0.5, 'recall': 0.5, 'F1': 0.5, 'gscore': 0.0}
[2025-04-30 06:56:46,730] 
===  158-th graph ===
[2025-04-30 06:56:46,730] 32 Nodes of True MB: [6, 28, 32, 41, 55, 66, 74, 88, 101, 109, 112, 117, 118, 119, 120, 126, 140, 144, 155, 158, 201, 206, 218, 244, 245, 251, 261, 281, 283, 293, 295, 298], parents: {32, 144, 120, 101}, children: {41, 283, 6, 55}, spouse: {261, 6, 140, 281, 155, 28, 158, 293, 295, 298, 66, 201, 74, 206, 119, 88, 218, 109, 112, 244, 245, 118, 117, 251, 126}
[2025-04-30 06:56:46,730] 8 Nodes of Markov blanket: [28, 88, 117, 126, 140, 158, 245, 295]
[2025-04-30 06:56:46,730] [MB metrics] precision: 1.000, recall: 0.250, acc: 0.920, f1: 0.400
[2025-04-30 06:57:04,223] sub_met2 before prunning None
[2025-04-30 06:57:04,223] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2963, 'shd': 9, 'nnz': 8, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:57:04,223] 
===  159-th graph ===
[2025-04-30 06:57:04,223] 56 Nodes of True MB: [6, 12, 13, 31, 37, 46, 50, 55, 62, 64, 68, 75, 76, 92, 95, 97, 102, 104, 111, 115, 122, 125, 128, 131, 135, 137, 155, 159, 160, 168, 177, 179, 180, 183, 184, 187, 194, 195, 200, 201, 202, 204, 208, 225, 233, 236, 238, 259, 260, 269, 276, 277, 280, 284, 286, 292], parents: {259, 68, 260, 200, 233, 111, 115}, children: {195, 137, 201, 269, 238}, spouse: {128, 131, 6, 135, 12, 13, 269, 276, 277, 280, 155, 284, 286, 159, 31, 160, 292, 37, 168, 46, 177, 50, 179, 180, 55, 183, 184, 187, 62, 64, 194, 68, 202, 75, 204, 76, 208, 92, 95, 225, 97, 102, 104, 236, 111, 122, 125}
[2025-04-30 06:57:04,223] 9 Nodes of Markov blanket: [31, 75, 104, 111, 128, 131, 159, 179, 202]
[2025-04-30 06:57:04,232] [MB metrics] precision: 1.000, recall: 0.161, acc: 0.840, f1: 0.277
[2025-04-30 06:57:19,417] sub_met2 before prunning None
[2025-04-30 06:57:19,417] sub_met after prunning {'fdr': 0.9, 'tpr': 0.5, 'fpr': 0.2647, 'shd': 10, 'nnz': 10, 'precision': 0.1, 'recall': 0.5, 'F1': 0.1667, 'gscore': 0.0}
[2025-04-30 06:57:19,417] 
===  160-th graph ===
[2025-04-30 06:57:19,417] 51 Nodes of True MB: [10, 12, 13, 16, 23, 24, 50, 67, 70, 85, 87, 93, 95, 97, 99, 102, 106, 111, 116, 122, 123, 125, 129, 134, 135, 142, 146, 147, 148, 154, 155, 159, 160, 161, 175, 180, 181, 197, 201, 204, 215, 236, 240, 252, 260, 264, 269, 271, 277, 278, 282], parents: {99, 260, 142, 111, 16, 147, 24, 122}, children: {201, 146, 148, 23, 93}, spouse: {129, 134, 135, 264, 10, 12, 13, 269, 271, 277, 278, 24, 282, 155, 154, 159, 160, 161, 175, 50, 180, 181, 67, 197, 70, 204, 85, 215, 87, 95, 97, 102, 106, 236, 240, 116, 123, 252, 125}
[2025-04-30 06:57:19,417] 5 Nodes of Markov blanket: [85, 129, 160, 181, 215]
[2025-04-30 06:57:19,424] [MB metrics] precision: 1.000, recall: 0.098, acc: 0.837, f1: 0.179
[2025-04-30 06:57:26,813] sub_met2 before prunning None
[2025-04-30 06:57:26,813] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.7778, 'shd': 8, 'nnz': 7, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:57:26,813] 
===  161-th graph ===
[2025-04-30 06:57:26,813] 35 Nodes of True MB: [4, 12, 24, 38, 40, 49, 50, 63, 66, 67, 96, 102, 103, 108, 111, 129, 135, 142, 145, 148, 160, 161, 169, 175, 193, 195, 197, 208, 220, 233, 240, 264, 265, 270, 282], parents: set(), children: {129, 193, 265, 12, 148, 220}, spouse: {129, 4, 135, 264, 142, 270, 145, 24, 282, 160, 161, 38, 40, 169, 175, 49, 50, 63, 66, 67, 195, 197, 208, 96, 102, 103, 233, 108, 111, 240}
[2025-04-30 06:57:26,813] 10 Nodes of Markov blanket: [4, 63, 66, 102, 111, 129, 145, 161, 169, 208]
[2025-04-30 06:57:26,813] [MB metrics] precision: 1.000, recall: 0.286, acc: 0.912, f1: 0.444
[2025-04-30 06:57:42,621] sub_met2 before prunning None
[2025-04-30 06:57:42,621] sub_met after prunning {'fdr': 0.8235, 'tpr': 0.5, 'fpr': 0.359, 'shd': 17, 'nnz': 17, 'precision': 0.1765, 'recall': 0.5, 'F1': 0.2609, 'gscore': 0.0}
[2025-04-30 06:57:42,621] 
===  162-th graph ===
[2025-04-30 06:57:42,621] 15 Nodes of True MB: [1, 5, 20, 36, 92, 119, 142, 148, 162, 185, 241, 256, 257, 291, 298], parents: {256, 1, 257, 291, 36, 5, 298, 142, 241, 20, 148, 119, 185, 92}, children: set(), spouse: {162}
[2025-04-30 06:57:42,621] 
===  163-th graph ===
[2025-04-30 06:57:42,621] 33 Nodes of True MB: [20, 24, 31, 45, 55, 64, 66, 99, 100, 104, 113, 132, 163, 166, 183, 191, 194, 199, 202, 219, 222, 247, 254, 255, 261, 263, 264, 267, 270, 276, 284, 289, 293], parents: {99, 267, 270, 276, 24, 219, 191}, children: {132, 263, 199}, spouse: {261, 264, 20, 284, 31, 289, 163, 293, 166, 45, 55, 183, 64, 66, 194, 202, 222, 100, 104, 113, 247, 254, 255}
[2025-04-30 06:57:42,621] 11 Nodes of Markov blanket: [20, 31, 45, 55, 113, 163, 191, 194, 247, 289, 293]
[2025-04-30 06:57:42,621] [MB metrics] precision: 1.000, recall: 0.333, acc: 0.925, f1: 0.500
[2025-04-30 06:57:58,700] sub_met2 before prunning None
[2025-04-30 06:57:58,700] sub_met after prunning {'fdr': 0.9444, 'tpr': 0.3333, 'fpr': 0.3269, 'shd': 19, 'nnz': 18, 'precision': 0.0556, 'recall': 0.3333, 'F1': 0.0952, 'gscore': 0.0}
[2025-04-30 06:57:58,700] 
===  164-th graph ===
[2025-04-30 06:57:58,700] 47 Nodes of True MB: [15, 18, 20, 26, 32, 38, 46, 48, 53, 59, 76, 78, 84, 92, 95, 102, 107, 109, 110, 123, 134, 135, 139, 140, 143, 147, 156, 157, 164, 176, 178, 180, 182, 185, 191, 194, 202, 207, 216, 223, 234, 249, 250, 256, 272, 282, 287], parents: set(), children: {134, 139, 143, 207, 84, 53, 249, 282, 123, 156}, spouse: {256, 135, 140, 15, 272, 18, 147, 20, 26, 156, 157, 287, 32, 164, 38, 46, 48, 176, 178, 180, 182, 185, 59, 191, 194, 202, 76, 78, 84, 216, 92, 223, 95, 102, 234, 107, 109, 110, 250}
[2025-04-30 06:57:58,700] 13 Nodes of Markov blanket: [18, 32, 46, 78, 92, 107, 164, 178, 182, 191, 216, 234, 287]
[2025-04-30 06:57:58,712] [MB metrics] precision: 1.000, recall: 0.277, acc: 0.882, f1: 0.433
[2025-04-30 06:58:14,209] sub_met2 before prunning None
[2025-04-30 06:58:14,209] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2, 'shd': 18, 'nnz': 15, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:58:14,209] 
===  165-th graph ===
[2025-04-30 06:58:14,215] 17 Nodes of True MB: [12, 17, 20, 31, 46, 61, 152, 165, 168, 225, 231, 235, 249, 253, 276, 284, 293], parents: {152, 225, 235, 168}, children: {17, 61}, spouse: {165, 293, 231, 168, 12, 46, 276, 20, 249, 284, 253, 31}
[2025-04-30 06:58:14,215] 2 Nodes of Markov blanket: [20, 165]
[2025-04-30 06:58:14,218] [MB metrics] precision: 1.000, recall: 0.118, acc: 0.949, f1: 0.211
[2025-04-30 06:58:20,603] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:58:20,603] sub_met2 before prunning None
[2025-04-30 06:58:20,603] sub_met after prunning None
[2025-04-30 06:58:20,603] 
===  166-th graph ===
[2025-04-30 06:58:20,603] 76 Nodes of True MB: [11, 13, 20, 31, 40, 44, 51, 55, 56, 63, 66, 70, 71, 72, 73, 77, 82, 84, 88, 100, 102, 108, 109, 110, 111, 112, 113, 118, 122, 132, 135, 147, 149, 152, 155, 163, 166, 169, 171, 174, 183, 184, 189, 190, 197, 199, 201, 206, 208, 218, 224, 226, 228, 233, 234, 239, 245, 251, 253, 254, 261, 264, 266, 273, 275, 276, 277, 279, 284, 286, 287, 289, 291, 293, 294, 298], parents: set(), children: {66, 132, 228, 72, 234, 11, 77, 109, 206, 51, 276, 245, 277, 254, 287}, spouse: {261, 135, 264, 266, 13, 273, 147, 20, 149, 275, 279, 152, 155, 284, 286, 31, 289, 163, 291, 293, 166, 294, 40, 169, 298, 171, 44, 174, 55, 184, 183, 56, 189, 190, 63, 66, 197, 70, 71, 199, 201, 73, 206, 208, 82, 84, 88, 218, 224, 226, 100, 102, 233, 234, 108, 110, 239, 112, 113, 111, 118, 122, 251, 253}
[2025-04-30 06:58:20,603] 18 Nodes of Markov blanket: [55, 63, 66, 82, 100, 102, 113, 166, 184, 197, 218, 224, 233, 245, 261, 276, 279, 286]
[2025-04-30 06:58:20,603] [MB metrics] precision: 1.000, recall: 0.237, acc: 0.806, f1: 0.383
[2025-04-30 06:58:39,586] sub_met2 before prunning None
[2025-04-30 06:58:39,586] sub_met after prunning {'fdr': 0.931, 'tpr': 0.3636, 'fpr': 0.3803, 'shd': 61, 'nnz': 58, 'precision': 0.069, 'recall': 0.3636, 'F1': 0.1159, 'gscore': 0.0}
[2025-04-30 06:58:39,586] 
===  167-th graph ===
[2025-04-30 06:58:39,586] 8 Nodes of True MB: [42, 71, 84, 131, 167, 182, 185, 275], parents: {131, 71, 42, 275, 84, 182, 185}, children: set(), spouse: {167}
[2025-04-30 06:58:39,593] 
===  168-th graph ===
[2025-04-30 06:58:39,593] 74 Nodes of True MB: [12, 13, 16, 17, 18, 20, 22, 30, 38, 40, 46, 52, 58, 62, 67, 69, 76, 77, 92, 102, 105, 108, 111, 112, 117, 120, 134, 140, 142, 143, 144, 145, 147, 152, 153, 155, 159, 165, 168, 180, 181, 183, 184, 185, 187, 189, 194, 197, 198, 203, 214, 216, 220, 225, 227, 231, 232, 233, 234, 235, 238, 244, 246, 247, 253, 261, 270, 276, 280, 284, 286, 291, 292, 293], parents: {102, 111, 18, 180, 20, 244}, children: {165, 261, 40, 238, 270, 17, 52, 280, 153, 187, 189, 30}, spouse: {134, 12, 13, 140, 143, 16, 145, 142, 147, 276, 144, 22, 152, 280, 155, 284, 286, 159, 291, 292, 165, 38, 293, 168, 46, 181, 183, 184, 185, 58, 62, 194, 67, 69, 198, 197, 203, 76, 77, 214, 216, 220, 92, 225, 227, 231, 232, 233, 234, 235, 108, 105, 111, 112, 117, 246, 247, 120, 253}
[2025-04-30 06:58:39,593] 7 Nodes of Markov blanket: [12, 58, 92, 155, 168, 194, 233]
[2025-04-30 06:58:39,598] [MB metrics] precision: 1.000, recall: 0.095, acc: 0.772, f1: 0.173
[2025-04-30 06:58:52,625] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 06:58:52,625] sub_met2 before prunning None
[2025-04-30 06:58:52,625] sub_met after prunning None
[2025-04-30 06:58:52,625] 
===  169-th graph ===
[2025-04-30 06:58:52,625] 48 Nodes of True MB: [7, 11, 27, 44, 47, 48, 49, 63, 65, 66, 70, 73, 76, 84, 96, 100, 102, 108, 110, 122, 124, 129, 133, 135, 145, 149, 161, 166, 169, 170, 180, 184, 194, 221, 224, 226, 233, 244, 255, 256, 259, 260, 276, 284, 285, 286, 293, 295], parents: set(), children: {65, 129, 259, 170, 11, 110, 27, 284}, spouse: {256, 260, 133, 135, 7, 145, 276, 149, 285, 286, 161, 293, 166, 295, 169, 44, 47, 48, 49, 180, 184, 63, 66, 194, 70, 73, 76, 84, 221, 96, 224, 226, 100, 102, 233, 108, 244, 122, 124, 255}
[2025-04-30 06:58:52,625] 16 Nodes of Markov blanket: [7, 48, 84, 100, 108, 135, 145, 161, 169, 180, 184, 224, 244, 256, 276, 286]
[2025-04-30 06:58:52,641] [MB metrics] precision: 1.000, recall: 0.333, acc: 0.892, f1: 0.500
[2025-04-30 06:59:11,006] sub_met2 before prunning None
[2025-04-30 06:59:11,006] sub_met after prunning {'fdr': 0.9412, 'tpr': 0.6667, 'fpr': 0.2735, 'shd': 33, 'nnz': 34, 'precision': 0.0588, 'recall': 0.6667, 'F1': 0.1081, 'gscore': 0.0}
[2025-04-30 06:59:11,006] 
===  170-th graph ===
[2025-04-30 06:59:11,006] 47 Nodes of True MB: [15, 36, 38, 39, 46, 48, 50, 67, 81, 88, 97, 100, 102, 107, 108, 109, 110, 113, 116, 120, 126, 129, 136, 140, 142, 149, 150, 156, 169, 170, 175, 180, 184, 194, 195, 197, 208, 211, 219, 222, 223, 232, 253, 277, 280, 286, 295], parents: {102, 169, 108, 48, 180}, children: {81, 116, 286, 39}, spouse: {129, 136, 140, 142, 15, 149, 150, 277, 280, 156, 36, 38, 295, 170, 46, 175, 50, 184, 194, 195, 67, 197, 208, 211, 88, 219, 222, 223, 97, 100, 232, 107, 109, 110, 113, 120, 253, 126}
[2025-04-30 06:59:11,016] 23 Nodes of Markov blanket: [15, 36, 38, 46, 67, 97, 107, 110, 120, 126, 136, 140, 150, 156, 170, 175, 184, 194, 211, 219, 223, 232, 277]
[2025-04-30 06:59:11,020] [MB metrics] precision: 1.000, recall: 0.489, acc: 0.919, f1: 0.657
[2025-04-30 06:59:31,109] sub_met2 before prunning None
[2025-04-30 06:59:31,109] sub_met after prunning {'fdr': 0.95, 'tpr': 0.3, 'fpr': 0.2346, 'shd': 64, 'nnz': 60, 'precision': 0.05, 'recall': 0.3, 'F1': 0.0857, 'gscore': 0.0}
[2025-04-30 06:59:31,109] 
===  171-th graph ===
[2025-04-30 06:59:31,109] 37 Nodes of True MB: [7, 16, 23, 24, 33, 51, 62, 64, 71, 73, 77, 100, 107, 110, 118, 125, 135, 139, 141, 150, 166, 171, 175, 179, 181, 183, 190, 208, 212, 221, 231, 233, 235, 249, 261, 262, 293], parents: {64, 231, 73, 233, 107, 16, 179, 181, 62}, children: {51, 212, 262}, spouse: {261, 135, 7, 139, 141, 150, 23, 24, 33, 293, 166, 171, 175, 183, 190, 71, 77, 208, 221, 100, 235, 110, 118, 249, 125}
[2025-04-30 06:59:31,109] 8 Nodes of Markov blanket: [7, 33, 71, 110, 118, 135, 171, 293]
[2025-04-30 06:59:31,119] [MB metrics] precision: 1.000, recall: 0.216, acc: 0.901, f1: 0.356
[2025-04-30 06:59:48,986] sub_met2 before prunning None
[2025-04-30 06:59:48,986] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.4815, 'shd': 13, 'nnz': 13, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:59:48,986] 
===  172-th graph ===
[2025-04-30 06:59:48,986] 7 Nodes of True MB: [11, 122, 147, 172, 199, 229, 287], parents: {229, 199, 11, 147, 122, 287}, children: set(), spouse: {172}
[2025-04-30 06:59:48,986] 
===  173-th graph ===
[2025-04-30 06:59:48,986] 16 Nodes of True MB: [13, 80, 94, 118, 119, 126, 144, 149, 173, 199, 203, 206, 213, 243, 254, 267], parents: {199, 203, 267, 13, 80, 118, 254, 94}, children: {149}, spouse: {173, 206, 144, 243, 213, 119, 126}
[2025-04-30 06:59:48,986] 3 Nodes of Markov blanket: [13, 118, 173]
[2025-04-30 06:59:48,997] [MB metrics] precision: 1.000, recall: 0.188, acc: 0.951, f1: 0.316
[2025-04-30 06:59:55,419] sub_met2 before prunning None
[2025-04-30 06:59:55,419] sub_met after prunning {'fdr': 0.0, 'tpr': 0.0, 'fpr': 0.0, 'shd': 2, 'nnz': 0, 'precision': nan, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 06:59:55,419] 
===  174-th graph ===
[2025-04-30 06:59:55,419] 38 Nodes of True MB: [5, 22, 31, 46, 63, 73, 74, 77, 80, 102, 107, 117, 122, 128, 139, 141, 155, 166, 174, 180, 183, 189, 192, 204, 208, 221, 231, 237, 239, 244, 249, 255, 258, 266, 267, 275, 294, 298], parents: {266}, children: {258, 255, 5, 231, 77, 239, 63}, spouse: {128, 266, 139, 267, 141, 275, 22, 155, 31, 294, 166, 298, 174, 46, 180, 183, 189, 192, 73, 74, 204, 80, 208, 221, 102, 107, 237, 244, 117, 249, 122}
[2025-04-30 06:59:55,419] 8 Nodes of Markov blanket: [22, 46, 102, 174, 180, 192, 244, 275]
[2025-04-30 06:59:55,426] [MB metrics] precision: 1.000, recall: 0.211, acc: 0.900, f1: 0.348
[2025-04-30 07:00:13,454] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:00:13,454] sub_met2 before prunning None
[2025-04-30 07:00:13,454] sub_met after prunning None
[2025-04-30 07:00:13,454] 
===  175-th graph ===
[2025-04-30 07:00:13,454] 32 Nodes of True MB: [7, 15, 24, 33, 46, 81, 88, 102, 118, 126, 136, 148, 155, 156, 160, 161, 170, 171, 175, 194, 197, 208, 219, 235, 240, 249, 260, 262, 264, 280, 282, 295], parents: {155, 260}, children: {81, 148, 262}, spouse: {7, 136, 264, 15, 280, 24, 282, 156, 160, 161, 33, 295, 170, 171, 46, 175, 194, 197, 208, 88, 219, 102, 235, 240, 118, 249, 126}
[2025-04-30 07:00:13,454] 9 Nodes of Markov blanket: [15, 46, 126, 136, 156, 170, 175, 208, 219]
[2025-04-30 07:00:13,470] [MB metrics] precision: 1.000, recall: 0.281, acc: 0.922, f1: 0.439
[2025-04-30 07:00:28,606] sub_met2 before prunning None
[2025-04-30 07:00:28,606] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2286, 'shd': 9, 'nnz': 8, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:00:28,606] 
===  176-th graph ===
[2025-04-30 07:00:28,606] 23 Nodes of True MB: [18, 32, 46, 51, 53, 57, 78, 140, 164, 176, 182, 185, 205, 216, 222, 224, 234, 241, 248, 250, 253, 257, 297], parents: {257, 297, 205, 46, 78, 241, 57, 253, 222}, children: {53, 182}, spouse: {32, 224, 248, 164, 234, 140, 176, 18, 51, 182, 216, 185, 250, 57}
[2025-04-30 07:00:28,606] 3 Nodes of Markov blanket: [51, 57, 176]
[2025-04-30 07:00:28,615] [MB metrics] precision: 1.000, recall: 0.130, acc: 0.933, f1: 0.231
[2025-04-30 07:00:35,695] sub_met2 before prunning None
[2025-04-30 07:00:35,695] sub_met after prunning {'fdr': 0.6667, 'tpr': 1.0, 'fpr': 1.0, 'shd': 2, 'nnz': 3, 'precision': 0.3333, 'recall': 1.0, 'F1': 0.5, 'gscore': 0.0}
[2025-04-30 07:00:35,695] 
===  177-th graph ===
[2025-04-30 07:00:35,695] 27 Nodes of True MB: [24, 32, 45, 55, 64, 66, 68, 69, 75, 104, 111, 112, 128, 135, 159, 177, 179, 180, 196, 202, 208, 215, 216, 226, 233, 247, 269], parents: {32, 226, 66, 75, 215}, children: {269, 45}, spouse: {128, 135, 24, 159, 177, 179, 180, 55, 64, 68, 69, 196, 202, 75, 208, 216, 104, 233, 111, 112, 247}
[2025-04-30 07:00:35,695] 
===  178-th graph ===
[2025-04-30 07:00:35,695] 48 Nodes of True MB: [4, 7, 18, 25, 30, 31, 33, 37, 47, 48, 54, 67, 68, 70, 76, 82, 84, 91, 103, 110, 134, 138, 140, 152, 153, 154, 164, 178, 193, 198, 202, 208, 209, 210, 224, 226, 232, 234, 251, 253, 255, 260, 262, 267, 272, 281, 285, 290], parents: {202, 260, 198}, children: {226, 68, 37, 138, 210, 84, 154}, spouse: {4, 260, 134, 7, 262, 267, 140, 272, 18, 152, 25, 153, 281, 285, 30, 31, 33, 290, 164, 47, 48, 178, 54, 193, 67, 70, 202, 76, 208, 209, 82, 91, 224, 103, 232, 234, 110, 251, 253, 255}
[2025-04-30 07:00:35,695] 19 Nodes of Markov blanket: [7, 31, 47, 48, 54, 67, 70, 76, 91, 103, 134, 164, 178, 202, 232, 234, 255, 260, 272]
[2025-04-30 07:00:35,705] [MB metrics] precision: 1.000, recall: 0.396, acc: 0.900, f1: 0.567
[2025-04-30 07:00:56,165] sub_met2 before prunning None
[2025-04-30 07:00:56,165] sub_met after prunning {'fdr': 0.9318, 'tpr': 0.375, 'fpr': 0.2515, 'shd': 46, 'nnz': 44, 'precision': 0.0682, 'recall': 0.375, 'F1': 0.1154, 'gscore': 0.0}
[2025-04-30 07:00:56,165] 
===  179-th graph ===
[2025-04-30 07:00:56,165] 51 Nodes of True MB: [16, 20, 29, 34, 48, 49, 55, 62, 64, 68, 71, 73, 75, 82, 98, 102, 104, 107, 110, 121, 124, 128, 135, 143, 145, 159, 171, 177, 179, 181, 191, 202, 208, 211, 219, 222, 231, 233, 237, 239, 245, 250, 259, 260, 269, 272, 279, 287, 291, 296, 297], parents: {191, 233, 279, 121, 287}, children: {128, 34, 71, 171, 237, 269, 272}, spouse: {128, 259, 260, 135, 143, 16, 145, 20, 29, 287, 159, 291, 296, 297, 48, 49, 177, 179, 181, 55, 62, 191, 64, 68, 73, 202, 75, 208, 82, 211, 219, 222, 98, 102, 231, 104, 233, 107, 110, 239, 245, 250, 124}
[2025-04-30 07:00:56,165] 13 Nodes of Markov blanket: [16, 48, 68, 73, 75, 107, 128, 159, 179, 181, 191, 202, 233]
[2025-04-30 07:00:56,183] [MB metrics] precision: 1.000, recall: 0.255, acc: 0.872, f1: 0.406
[2025-04-30 07:01:13,404] sub_met2 before prunning None
[2025-04-30 07:01:13,404] sub_met after prunning {'fdr': 0.8621, 'tpr': 0.5, 'fpr': 0.3571, 'shd': 28, 'nnz': 29, 'precision': 0.1379, 'recall': 0.5, 'F1': 0.2162, 'gscore': 0.0}
[2025-04-30 07:01:13,404] 
===  180-th graph ===
[2025-04-30 07:01:13,404] 56 Nodes of True MB: [5, 12, 13, 18, 20, 22, 24, 26, 38, 45, 48, 50, 69, 73, 74, 80, 95, 102, 107, 108, 111, 112, 123, 125, 128, 135, 139, 155, 159, 160, 164, 168, 169, 170, 174, 177, 180, 183, 196, 201, 204, 216, 221, 233, 236, 237, 244, 247, 249, 258, 269, 272, 275, 277, 294, 297], parents: {297}, children: {258, 5, 168, 201, 170, 45, 123}, spouse: {128, 135, 139, 12, 13, 269, 272, 18, 275, 20, 277, 22, 24, 26, 155, 159, 160, 164, 294, 38, 169, 174, 48, 177, 50, 180, 183, 196, 69, 73, 74, 204, 80, 216, 221, 95, 102, 233, 107, 236, 237, 108, 111, 112, 244, 247, 249, 125}
[2025-04-30 07:01:13,404] 11 Nodes of Markov blanket: [5, 18, 22, 24, 48, 108, 125, 169, 174, 180, 244]
[2025-04-30 07:01:13,421] [MB metrics] precision: 1.000, recall: 0.196, acc: 0.849, f1: 0.328
[2025-04-30 07:01:29,509] sub_met2 before prunning None
[2025-04-30 07:01:29,509] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2115, 'shd': 14, 'nnz': 11, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:01:29,509] 
===  181-th graph ===
[2025-04-30 07:01:29,509] 61 Nodes of True MB: [0, 2, 5, 9, 16, 30, 38, 40, 48, 58, 59, 61, 62, 64, 67, 69, 73, 74, 85, 91, 95, 103, 106, 107, 110, 120, 125, 126, 129, 134, 135, 140, 144, 146, 160, 168, 171, 179, 181, 190, 195, 198, 200, 215, 225, 228, 231, 232, 233, 246, 248, 251, 258, 259, 261, 269, 270, 274, 285, 287, 294], parents: {287}, children: {2, 67, 9, 171, 270, 146, 215, 58, 190}, spouse: {0, 129, 258, 259, 5, 134, 135, 261, 140, 269, 16, 144, 274, 285, 30, 160, 294, 38, 168, 40, 48, 179, 181, 59, 61, 62, 64, 195, 69, 198, 200, 73, 74, 85, 215, 91, 95, 248, 225, 228, 103, 232, 231, 233, 107, 106, 110, 246, 120, 251, 125, 126}
[2025-04-30 07:01:29,509] 15 Nodes of Markov blanket: [16, 40, 73, 74, 85, 95, 107, 129, 160, 179, 181, 215, 261, 285, 294]
[2025-04-30 07:01:29,514] [MB metrics] precision: 1.000, recall: 0.246, acc: 0.844, f1: 0.395
[2025-04-30 07:01:45,612] sub_met2 before prunning None
[2025-04-30 07:01:45,612] sub_met after prunning {'fdr': 0.9592, 'tpr': 0.6667, 'fpr': 0.4608, 'shd': 48, 'nnz': 49, 'precision': 0.0408, 'recall': 0.6667, 'F1': 0.0769, 'gscore': 0.0}
[2025-04-30 07:01:45,612] 
===  182-th graph ===
[2025-04-30 07:01:45,612] 31 Nodes of True MB: [18, 32, 42, 44, 45, 51, 53, 57, 71, 84, 116, 131, 135, 140, 141, 142, 164, 167, 176, 182, 184, 185, 190, 216, 224, 234, 248, 250, 275, 277, 295], parents: {32, 224, 140, 176, 51, 248, 57}, children: {184, 53, 167}, spouse: {131, 135, 141, 142, 18, 275, 277, 164, 295, 42, 44, 45, 176, 182, 185, 190, 71, 84, 216, 234, 116, 250}
[2025-04-30 07:01:45,612] 10 Nodes of Markov blanket: [18, 42, 45, 116, 141, 164, 182, 185, 216, 277]
[2025-04-30 07:01:45,622] [MB metrics] precision: 1.000, recall: 0.323, acc: 0.929, f1: 0.488
[2025-04-30 07:02:01,148] sub_met2 before prunning None
[2025-04-30 07:02:01,148] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3182, 'shd': 15, 'nnz': 14, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:02:01,148] 
===  183-th graph ===
[2025-04-30 07:02:01,148] 62 Nodes of True MB: [5, 12, 18, 20, 22, 24, 31, 45, 46, 51, 56, 62, 66, 71, 73, 76, 92, 102, 106, 107, 109, 110, 118, 128, 135, 141, 142, 156, 159, 163, 166, 168, 171, 174, 180, 183, 184, 194, 197, 202, 203, 221, 231, 234, 238, 243, 246, 247, 249, 255, 260, 261, 263, 275, 276, 280, 284, 285, 286, 289, 292, 293], parents: {197, 231}, children: {292, 5, 263, 106, 238, 51, 243, 24}, spouse: {128, 260, 261, 135, 12, 141, 142, 18, 275, 20, 276, 22, 280, 156, 285, 284, 31, 159, 289, 286, 163, 292, 293, 166, 168, 171, 45, 174, 46, 180, 183, 184, 56, 62, 66, 194, 71, 73, 202, 203, 76, 92, 221, 102, 234, 107, 109, 110, 246, 247, 118, 249, 255}
[2025-04-30 07:02:01,148] 5 Nodes of Markov blanket: [24, 135, 183, 285, 293]
[2025-04-30 07:02:01,153] [MB metrics] precision: 1.000, recall: 0.081, acc: 0.806, f1: 0.149
[2025-04-30 07:02:08,575] sub_met2 before prunning None
[2025-04-30 07:02:08,575] sub_met after prunning {'fdr': 0.875, 'tpr': 0.5, 'fpr': 0.875, 'shd': 8, 'nnz': 8, 'precision': 0.125, 'recall': 0.5, 'F1': 0.2, 'gscore': 0.0}
[2025-04-30 07:02:08,575] 
===  184-th graph ===
[2025-04-30 07:02:08,591] 43 Nodes of True MB: [11, 12, 36, 44, 45, 46, 62, 67, 70, 76, 84, 88, 107, 109, 113, 116, 122, 129, 135, 141, 142, 149, 159, 166, 168, 169, 170, 182, 183, 184, 190, 222, 224, 232, 238, 276, 277, 280, 284, 286, 292, 293, 295], parents: {135, 295, 44, 45, 141, 142, 116, 277, 182, 190}, children: {11, 238, 286}, spouse: {129, 12, 276, 149, 280, 284, 286, 159, 292, 293, 166, 36, 168, 169, 170, 44, 46, 183, 184, 62, 67, 70, 76, 84, 88, 222, 224, 232, 107, 109, 113, 122}
[2025-04-30 07:02:08,591] 14 Nodes of Markov blanket: [36, 67, 107, 109, 149, 166, 169, 170, 184, 222, 224, 232, 286, 293]
[2025-04-30 07:02:08,596] [MB metrics] precision: 1.000, recall: 0.326, acc: 0.902, f1: 0.491
[2025-04-30 07:02:24,463] sub_met2 before prunning None
[2025-04-30 07:02:24,463] sub_met after prunning {'fdr': 0.8571, 'tpr': 0.3333, 'fpr': 0.3038, 'shd': 32, 'nnz': 28, 'precision': 0.1429, 'recall': 0.3333, 'F1': 0.2, 'gscore': 0.0}
[2025-04-30 07:02:24,463] 
===  185-th graph ===
[2025-04-30 07:02:24,463] 71 Nodes of True MB: [0, 1, 3, 5, 13, 18, 20, 28, 36, 39, 40, 42, 43, 53, 62, 71, 82, 84, 89, 92, 101, 102, 109, 111, 119, 125, 131, 134, 142, 148, 152, 153, 155, 162, 164, 167, 168, 176, 182, 185, 186, 189, 191, 194, 203, 207, 216, 222, 225, 226, 233, 234, 241, 246, 247, 248, 249, 250, 251, 255, 256, 257, 262, 266, 272, 275, 284, 287, 291, 298, 299], parents: {299, 109, 13, 207, 272, 82, 248, 249, 284}, children: {162, 3, 167, 40, 43, 53, 89, 28}, spouse: {256, 1, 257, 0, 131, 5, 134, 262, 266, 13, 142, 18, 275, 20, 148, 152, 153, 155, 287, 291, 36, 164, 39, 168, 298, 42, 176, 182, 185, 186, 189, 62, 191, 194, 71, 203, 82, 84, 216, 247, 92, 222, 225, 226, 101, 102, 233, 234, 111, 241, 246, 119, 250, 251, 125, 255}
[2025-04-30 07:02:24,463] 14 Nodes of Markov blanket: [1, 5, 42, 92, 119, 142, 148, 153, 182, 185, 186, 241, 256, 291]
[2025-04-30 07:02:24,467] [MB metrics] precision: 1.000, recall: 0.197, acc: 0.810, f1: 0.329
[2025-04-30 07:02:39,332] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:02:39,332] sub_met2 before prunning None
[2025-04-30 07:02:39,332] sub_met after prunning None
[2025-04-30 07:02:39,332] 
===  186-th graph ===
[2025-04-30 07:02:39,332] 40 Nodes of True MB: [29, 38, 39, 43, 45, 62, 67, 75, 89, 98, 101, 102, 104, 105, 107, 111, 126, 141, 145, 148, 152, 185, 186, 187, 188, 190, 199, 209, 214, 222, 223, 224, 246, 247, 249, 255, 260, 266, 280, 289], parents: {224, 289, 67, 38, 199, 104, 214, 249, 29}, children: {89, 43, 188, 209}, spouse: {260, 266, 141, 145, 148, 280, 152, 39, 45, 185, 186, 187, 62, 190, 199, 75, 222, 223, 224, 98, 101, 102, 105, 107, 111, 246, 247, 126, 255}
[2025-04-30 07:02:39,332] 7 Nodes of Markov blanket: [101, 148, 185, 186, 224, 255, 266]
[2025-04-30 07:02:39,332] [MB metrics] precision: 1.000, recall: 0.175, acc: 0.886, f1: 0.298
[2025-04-30 07:02:52,962] sub_met2 before prunning None
[2025-04-30 07:02:52,962] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3158, 'shd': 8, 'nnz': 6, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:02:52,962] 
===  187-th graph ===
[2025-04-30 07:02:52,962] 25 Nodes of True MB: [6, 37, 45, 67, 75, 77, 92, 97, 105, 107, 137, 145, 152, 159, 168, 186, 187, 190, 197, 209, 216, 222, 227, 246, 260], parents: {67, 227, 197, 168, 105, 77, 145, 246, 216}, children: {137, 209}, spouse: {97, 260, 37, 6, 105, 75, 107, 45, 152, 186, 187, 92, 222, 190, 159}
[2025-04-30 07:02:52,962] 
===  188-th graph ===
[2025-04-30 07:02:52,962] 12 Nodes of True MB: [98, 126, 141, 145, 186, 188, 199, 223, 224, 246, 260, 280], parents: {224, 98, 260, 199, 141, 145, 246, 280, 186, 126, 223}, children: set(), spouse: {188}
[2025-04-30 07:02:52,962] 
===  189-th graph ===
[2025-04-30 07:02:52,962] 47 Nodes of True MB: [6, 10, 13, 25, 27, 28, 31, 33, 40, 47, 67, 74, 75, 77, 82, 92, 104, 107, 117, 118, 148, 150, 153, 155, 166, 168, 174, 185, 189, 192, 203, 208, 213, 226, 228, 233, 242, 251, 257, 259, 260, 275, 277, 281, 284, 291, 299], parents: {67, 291, 168, 233, 13, 92}, children: {77, 242, 213, 150, 28}, spouse: {257, 259, 260, 6, 10, 275, 148, 277, 25, 281, 155, 284, 27, 153, 31, 33, 166, 40, 299, 174, 47, 185, 189, 192, 74, 75, 203, 208, 82, 226, 228, 104, 107, 117, 118, 251}
[2025-04-30 07:02:52,962] 4 Nodes of Markov blanket: [10, 40, 189, 251]
[2025-04-30 07:02:52,981] [MB metrics] precision: 1.000, recall: 0.085, acc: 0.857, f1: 0.157
[2025-04-30 07:03:00,174] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:03:00,174] sub_met2 before prunning None
[2025-04-30 07:03:00,174] sub_met after prunning None
[2025-04-30 07:03:00,174] 
===  190-th graph ===
[2025-04-30 07:03:00,174] 46 Nodes of True MB: [23, 40, 44, 45, 72, 75, 77, 100, 105, 106, 107, 112, 116, 125, 126, 135, 139, 141, 142, 150, 152, 166, 171, 181, 182, 184, 186, 187, 190, 200, 201, 209, 212, 218, 221, 222, 246, 251, 253, 259, 260, 264, 273, 277, 295, 298], parents: {259, 200, 106, 181, 246, 126}, children: {72, 209, 212, 184}, spouse: {260, 135, 264, 139, 141, 142, 273, 277, 150, 23, 152, 166, 295, 40, 298, 171, 44, 45, 182, 186, 187, 190, 201, 75, 77, 218, 221, 222, 100, 105, 107, 112, 116, 125, 251, 253}
[2025-04-30 07:03:00,174] 9 Nodes of Markov blanket: [45, 75, 77, 150, 190, 218, 221, 222, 260]
[2025-04-30 07:03:00,190] [MB metrics] precision: 1.000, recall: 0.196, acc: 0.876, f1: 0.327
[2025-04-30 07:03:15,265] sub_met2 before prunning None
[2025-04-30 07:03:15,265] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.6471, 'shd': 24, 'nnz': 22, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:03:15,265] 
===  191-th graph ===
[2025-04-30 07:03:15,265] 61 Nodes of True MB: [0, 3, 20, 24, 25, 27, 32, 38, 39, 45, 48, 49, 59, 73, 74, 82, 83, 97, 99, 101, 111, 120, 121, 125, 133, 134, 139, 149, 156, 157, 163, 164, 179, 185, 191, 196, 218, 219, 223, 224, 225, 227, 233, 237, 241, 245, 246, 251, 258, 260, 262, 264, 267, 268, 270, 276, 279, 282, 284, 287, 297], parents: set(), children: {3, 163, 196, 139, 268, 237, 179, 83}, spouse: {0, 258, 260, 133, 134, 262, 264, 267, 270, 276, 20, 149, 279, 24, 25, 282, 27, 284, 157, 156, 287, 32, 164, 38, 39, 297, 45, 48, 49, 179, 185, 59, 191, 73, 74, 82, 218, 219, 223, 224, 225, 97, 99, 227, 101, 233, 111, 241, 245, 246, 120, 121, 251, 125}
[2025-04-30 07:03:15,265] 25 Nodes of Markov blanket: [0, 25, 32, 49, 59, 99, 101, 120, 134, 163, 164, 179, 191, 223, 225, 227, 233, 237, 245, 246, 251, 260, 267, 270, 287]
[2025-04-30 07:03:15,269] [MB metrics] precision: 1.000, recall: 0.410, acc: 0.879, f1: 0.581
[2025-04-30 07:03:35,364] sub_met2 before prunning None
[2025-04-30 07:03:35,364] sub_met after prunning {'fdr': 0.8544, 'tpr': 0.6522, 'fpr': 0.3177, 'shd': 96, 'nnz': 103, 'precision': 0.1456, 'recall': 0.6522, 'F1': 0.2381, 'gscore': 0.0}
[2025-04-30 07:03:35,364] 
===  192-th graph ===
[2025-04-30 07:03:35,364] 54 Nodes of True MB: [0, 1, 6, 9, 13, 14, 16, 20, 24, 25, 30, 33, 40, 42, 46, 47, 50, 69, 74, 77, 78, 82, 92, 93, 101, 107, 111, 117, 141, 174, 189, 192, 193, 195, 198, 200, 202, 219, 224, 232, 234, 242, 245, 247, 249, 251, 255, 265, 266, 267, 269, 271, 298, 299], parents: {202, 267, 299, 141, 219}, children: {1, 101, 42, 74, 14, 242, 251, 255}, spouse: {0, 6, 265, 9, 266, 269, 13, 271, 16, 20, 24, 25, 30, 33, 40, 298, 46, 47, 174, 50, 189, 192, 193, 195, 69, 198, 200, 74, 77, 78, 82, 92, 93, 224, 232, 234, 107, 111, 245, 117, 247, 249}
[2025-04-30 07:03:35,364] 20 Nodes of Markov blanket: [0, 9, 20, 24, 25, 33, 46, 50, 77, 101, 107, 117, 174, 192, 195, 198, 232, 249, 265, 269]
[2025-04-30 07:03:35,375] [MB metrics] precision: 1.000, recall: 0.370, acc: 0.887, f1: 0.541
[2025-04-30 07:03:55,259] sub_met2 before prunning None
[2025-04-30 07:03:55,259] sub_met after prunning {'fdr': 0.9531, 'tpr': 0.375, 'fpr': 0.3352, 'shd': 66, 'nnz': 64, 'precision': 0.0469, 'recall': 0.375, 'F1': 0.0833, 'gscore': 0.0}
[2025-04-30 07:03:55,259] 
===  193-th graph ===
[2025-04-30 07:03:55,259] 27 Nodes of True MB: [4, 7, 14, 24, 30, 40, 54, 69, 76, 103, 111, 134, 138, 142, 161, 178, 192, 193, 197, 198, 200, 209, 232, 247, 262, 282, 290], parents: {161, 4, 197, 40, 142, 111, 282}, children: {138, 14}, spouse: {192, 193, 290, 69, 134, 103, 7, 232, 262, 198, 76, 200, 209, 178, 54, 247, 24, 30}
[2025-04-30 07:03:55,260] 3 Nodes of Markov blanket: [24, 193, 198]
[2025-04-30 07:03:55,263] [MB metrics] precision: 1.000, recall: 0.111, acc: 0.918, f1: 0.200
[2025-04-30 07:04:02,273] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:04:02,273] sub_met2 before prunning None
[2025-04-30 07:04:02,273] sub_met after prunning None
[2025-04-30 07:04:02,273] 
===  194-th graph ===
[2025-04-30 07:04:02,273] 69 Nodes of True MB: [5, 7, 11, 13, 15, 20, 25, 31, 40, 45, 46, 56, 61, 66, 67, 78, 81, 82, 88, 102, 110, 111, 112, 115, 122, 124, 126, 130, 131, 134, 136, 152, 155, 156, 159, 163, 164, 168, 169, 170, 175, 183, 185, 194, 195, 202, 207, 208, 219, 221, 225, 228, 231, 233, 242, 244, 246, 247, 255, 259, 263, 280, 281, 289, 291, 292, 293, 294, 295], parents: set(), children: {130, 195, 259, 281, 263, 40, 295, 46, 207, 81, 25}, spouse: {131, 5, 134, 7, 136, 11, 13, 15, 20, 152, 280, 155, 156, 159, 31, 289, 291, 292, 163, 293, 164, 168, 169, 170, 295, 294, 45, 46, 175, 183, 56, 185, 61, 194, 66, 67, 202, 78, 208, 82, 88, 219, 221, 225, 228, 102, 231, 233, 110, 111, 112, 242, 115, 244, 246, 247, 122, 124, 126, 255}
[2025-04-30 07:04:02,289] 14 Nodes of Markov blanket: [13, 31, 45, 46, 82, 110, 152, 155, 163, 168, 170, 194, 246, 293]
[2025-04-30 07:04:02,289] [MB metrics] precision: 1.000, recall: 0.203, acc: 0.814, f1: 0.337
[2025-04-30 07:04:17,859] sub_met2 before prunning None
[2025-04-30 07:04:17,859] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2386, 'shd': 24, 'nnz': 21, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:04:17,859] 
===  195-th graph ===
[2025-04-30 07:04:17,859] 47 Nodes of True MB: [0, 1, 2, 5, 16, 20, 31, 33, 38, 50, 59, 61, 66, 67, 77, 82, 91, 99, 102, 110, 111, 116, 122, 125, 131, 142, 149, 150, 159, 161, 170, 181, 192, 194, 195, 198, 217, 225, 227, 228, 230, 232, 249, 253, 265, 269, 279], parents: {159, 225, 194, 131, 102, 111, 122, 31}, children: {1, 2, 265, 116, 217}, spouse: {0, 5, 265, 269, 142, 16, 20, 149, 150, 279, 33, 161, 38, 170, 50, 181, 59, 61, 192, 66, 195, 67, 198, 77, 82, 91, 253, 99, 228, 227, 230, 232, 110, 249, 125}
[2025-04-30 07:04:17,872] 8 Nodes of Markov blanket: [33, 50, 66, 192, 195, 232, 249, 269]
[2025-04-30 07:04:17,874] [MB metrics] precision: 1.000, recall: 0.170, acc: 0.861, f1: 0.291
[2025-04-30 07:04:35,309] sub_met2 before prunning None
[2025-04-30 07:04:35,309] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.4074, 'shd': 11, 'nnz': 11, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:04:35,309] 
===  196-th graph ===
[2025-04-30 07:04:35,309] 29 Nodes of True MB: [0, 9, 24, 27, 45, 69, 73, 87, 111, 112, 115, 120, 134, 139, 157, 177, 180, 191, 196, 205, 216, 219, 223, 227, 233, 241, 247, 282, 284], parents: {0, 223, 227, 134, 73, 233, 219, 241, 284, 24, 27, 120, 157, 191}, children: {205, 45}, spouse: {196, 69, 9, 233, 139, 111, 112, 177, 115, 180, 87, 120, 24, 282, 247, 216}
[2025-04-30 07:04:35,309] 
===  197-th graph ===
[2025-04-30 07:04:35,309] 61 Nodes of True MB: [4, 16, 24, 26, 38, 39, 40, 48, 50, 56, 62, 67, 77, 82, 85, 97, 100, 102, 105, 107, 111, 115, 120, 140, 142, 145, 148, 160, 161, 166, 168, 170, 175, 183, 187, 193, 197, 200, 206, 211, 214, 216, 218, 223, 226, 227, 231, 235, 240, 246, 254, 255, 264, 266, 267, 272, 277, 279, 281, 282, 299], parents: set(), children: {193, 39, 218, 107, 206, 148, 85, 183, 26, 187, 254}, spouse: {4, 264, 266, 267, 140, 142, 272, 16, 145, 277, 279, 24, 281, 282, 160, 161, 38, 166, 40, 168, 170, 299, 175, 48, 50, 56, 62, 67, 197, 200, 77, 82, 211, 214, 216, 223, 97, 226, 227, 100, 102, 231, 105, 235, 111, 240, 115, 246, 120, 255}
[2025-04-30 07:04:35,309] 18 Nodes of Markov blanket: [4, 16, 48, 56, 62, 82, 105, 115, 145, 166, 197, 211, 214, 226, 246, 255, 281, 282]
[2025-04-30 07:04:35,309] [MB metrics] precision: 1.000, recall: 0.295, acc: 0.857, f1: 0.456
[2025-04-30 07:04:53,527] sub_met2 before prunning None
[2025-04-30 07:04:53,527] sub_met after prunning {'fdr': 0.9362, 'tpr': 0.75, 'fpr': 0.2953, 'shd': 45, 'nnz': 47, 'precision': 0.0638, 'recall': 0.75, 'F1': 0.1176, 'gscore': 0.0}
[2025-04-30 07:04:53,527] 
===  198-th graph ===
[2025-04-30 07:04:53,527] 37 Nodes of True MB: [0, 2, 5, 12, 14, 24, 30, 52, 58, 59, 61, 67, 69, 91, 103, 111, 112, 125, 134, 140, 143, 168, 178, 181, 192, 193, 195, 198, 200, 202, 228, 232, 247, 251, 260, 269, 291], parents: {140}, children: {2, 67, 14, 112, 178, 52}, spouse: {0, 260, 5, 134, 12, 269, 143, 24, 30, 291, 168, 181, 58, 59, 61, 192, 193, 195, 69, 198, 200, 202, 91, 228, 103, 232, 111, 247, 251, 125}
[2025-04-30 07:04:53,527] 11 Nodes of Markov blanket: [24, 30, 58, 67, 69, 103, 112, 192, 193, 198, 291]
[2025-04-30 07:04:53,531] [MB metrics] precision: 1.000, recall: 0.297, acc: 0.911, f1: 0.458
[2025-04-30 07:05:09,854] sub_met2 before prunning None
[2025-04-30 07:05:09,854] sub_met after prunning {'fdr': 0.9375, 'tpr': 0.25, 'fpr': 0.2941, 'shd': 18, 'nnz': 16, 'precision': 0.0625, 'recall': 0.25, 'F1': 0.1, 'gscore': 0.0}
[2025-04-30 07:05:09,854] 
===  199-th graph ===
[2025-04-30 07:05:09,870] 51 Nodes of True MB: [11, 13, 29, 38, 42, 55, 56, 64, 67, 79, 80, 86, 94, 98, 102, 104, 108, 111, 118, 122, 123, 126, 141, 145, 147, 163, 166, 172, 173, 186, 188, 199, 203, 214, 222, 223, 224, 229, 234, 241, 244, 246, 249, 252, 254, 260, 267, 277, 280, 287, 289], parents: {64, 163, 104, 254, 222}, children: {172, 173, 79, 277, 186, 188}, spouse: {260, 11, 267, 13, 141, 145, 147, 280, 29, 287, 289, 166, 38, 42, 55, 56, 186, 67, 199, 203, 80, 86, 214, 94, 223, 224, 98, 126, 229, 102, 104, 234, 108, 111, 241, 244, 118, 246, 249, 122, 123, 252, 254}
[2025-04-30 07:05:09,870] 9 Nodes of Markov blanket: [13, 29, 38, 94, 118, 199, 203, 249, 254]
[2025-04-30 07:05:09,874] [MB metrics] precision: 1.000, recall: 0.176, acc: 0.855, f1: 0.300
[2025-04-30 07:05:25,027] sub_met2 before prunning None
[2025-04-30 07:05:25,027] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3143, 'shd': 12, 'nnz': 11, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:05:25,027] 
===  200-th graph ===
[2025-04-30 07:05:25,027] 43 Nodes of True MB: [14, 15, 16, 20, 24, 29, 30, 36, 48, 56, 68, 69, 82, 85, 96, 102, 106, 107, 111, 115, 122, 126, 141, 159, 181, 190, 192, 193, 197, 198, 200, 206, 211, 214, 233, 246, 247, 255, 259, 260, 267, 285, 299], parents: set(), children: {36, 299, 14, 211, 85, 122, 190, 159}, spouse: {259, 260, 267, 141, 15, 16, 20, 24, 285, 29, 30, 48, 181, 56, 192, 193, 68, 69, 198, 197, 200, 206, 82, 214, 96, 102, 233, 106, 107, 111, 115, 246, 247, 126, 255}
[2025-04-30 07:05:25,027] 6 Nodes of Markov blanket: [20, 29, 68, 115, 200, 246]
[2025-04-30 07:05:25,033] [MB metrics] precision: 1.000, recall: 0.140, acc: 0.877, f1: 0.245
[2025-04-30 07:05:35,069] sub_met2 before prunning None
[2025-04-30 07:05:35,069] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.5, 'shd': 8, 'nnz': 7, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:05:35,069] 
===  201-th graph ===
[2025-04-30 07:05:35,069] 34 Nodes of True MB: [6, 12, 13, 40, 41, 50, 72, 74, 95, 112, 118, 125, 135, 155, 158, 159, 160, 166, 180, 190, 201, 204, 206, 218, 236, 245, 251, 253, 264, 269, 273, 277, 293, 298], parents: {159, 160, 12, 13, 204, 236, 269, 50, 180, 277, 155, 125, 95}, children: {72, 41}, spouse: {6, 135, 264, 273, 158, 293, 166, 40, 298, 190, 201, 74, 206, 218, 112, 245, 118, 251, 253}
[2025-04-30 07:05:35,069] 6 Nodes of Markov blanket: [112, 201, 218, 253, 273, 298]
[2025-04-30 07:05:35,069] [MB metrics] precision: 1.000, recall: 0.176, acc: 0.906, f1: 0.300
[2025-04-30 07:05:45,190] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:05:45,190] sub_met2 before prunning None
[2025-04-30 07:05:45,190] sub_met after prunning None
[2025-04-30 07:05:45,190] 
===  202-th graph ===
[2025-04-30 07:05:45,190] 55 Nodes of True MB: [16, 18, 20, 31, 44, 45, 55, 64, 66, 68, 75, 82, 84, 87, 92, 95, 104, 109, 119, 128, 129, 135, 141, 147, 157, 159, 163, 164, 177, 178, 179, 183, 192, 194, 198, 202, 208, 211, 219, 224, 229, 234, 247, 251, 255, 260, 263, 267, 269, 282, 283, 285, 289, 293, 299], parents: {211, 285}, children: {192, 68, 229, 263, 269, 16, 178, 282}, spouse: {128, 129, 260, 135, 267, 141, 18, 147, 20, 283, 157, 31, 159, 289, 163, 164, 293, 299, 44, 45, 177, 178, 179, 183, 55, 64, 66, 194, 68, 198, 202, 75, 208, 82, 84, 87, 219, 92, 247, 95, 224, 104, 234, 109, 119, 251, 255}
[2025-04-30 07:05:45,190] 10 Nodes of Markov blanket: [75, 141, 157, 159, 178, 179, 202, 234, 267, 299]
[2025-04-30 07:05:45,190] [MB metrics] precision: 1.000, recall: 0.182, acc: 0.850, f1: 0.308
[2025-04-30 07:05:59,701] sub_met2 before prunning None
[2025-04-30 07:05:59,701] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.5, 'shd': 23, 'nnz': 22, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:05:59,701] 
===  203-th graph ===
[2025-04-30 07:05:59,701] 32 Nodes of True MB: [13, 16, 18, 28, 78, 80, 94, 102, 106, 108, 112, 115, 117, 118, 147, 153, 156, 168, 173, 183, 185, 189, 199, 203, 226, 233, 234, 254, 267, 276, 280, 289], parents: {102, 115, 78}, children: {280, 106, 28, 173}, spouse: {267, 13, 16, 18, 147, 276, 153, 156, 289, 168, 183, 185, 189, 199, 203, 80, 94, 226, 233, 234, 108, 112, 117, 118, 254}
[2025-04-30 07:05:59,701] 7 Nodes of Markov blanket: [13, 94, 117, 118, 199, 203, 276]
[2025-04-30 07:05:59,705] [MB metrics] precision: 1.000, recall: 0.219, acc: 0.914, f1: 0.359
[2025-04-30 07:06:12,863] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:06:12,863] sub_met2 before prunning None
[2025-04-30 07:06:12,863] sub_met after prunning None
[2025-04-30 07:06:12,863] 
===  204-th graph ===
[2025-04-30 07:06:12,863] 38 Nodes of True MB: [12, 13, 22, 29, 50, 73, 74, 80, 92, 95, 101, 110, 121, 125, 133, 139, 155, 159, 160, 174, 180, 201, 204, 208, 226, 231, 236, 237, 245, 251, 254, 258, 269, 277, 293, 294, 298, 299], parents: {101, 231, 298, 299, 110, 121, 254}, children: {201, 258, 293}, spouse: {133, 139, 12, 13, 269, 277, 22, 155, 29, 159, 160, 294, 174, 50, 180, 73, 74, 204, 80, 208, 92, 95, 226, 236, 237, 245, 251, 125}
[2025-04-30 07:06:12,863] 10 Nodes of Markov blanket: [22, 74, 80, 204, 208, 226, 237, 245, 251, 294]
[2025-04-30 07:06:12,863] [MB metrics] precision: 1.000, recall: 0.263, acc: 0.907, f1: 0.417
[2025-04-30 07:06:29,308] sub_met2 before prunning None
[2025-04-30 07:06:29,308] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2727, 'shd': 13, 'nnz': 12, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:06:29,308] 
===  205-th graph ===
[2025-04-30 07:06:29,308] 18 Nodes of True MB: [9, 46, 57, 78, 87, 112, 115, 120, 139, 176, 196, 205, 222, 241, 253, 257, 282, 297], parents: {196, 9, 139, 112, 115, 87, 120, 282}, children: {176}, spouse: {257, 297, 205, 46, 78, 241, 57, 253, 222}
[2025-04-30 07:06:29,308] 
===  206-th graph ===
[2025-04-30 07:06:29,308] 47 Nodes of True MB: [6, 15, 25, 29, 33, 36, 41, 64, 74, 88, 90, 96, 107, 112, 113, 118, 119, 126, 128, 141, 144, 149, 152, 156, 158, 166, 173, 197, 200, 201, 206, 211, 213, 222, 226, 228, 232, 233, 243, 244, 245, 253, 267, 275, 279, 291, 293], parents: {197, 166, 279}, children: {33, 36, 228, 41, 113, 149, 253}, spouse: {128, 6, 267, 141, 15, 144, 275, 152, 25, 156, 29, 158, 291, 293, 166, 173, 64, 200, 201, 74, 206, 211, 213, 88, 90, 222, 96, 226, 228, 232, 233, 107, 112, 243, 244, 245, 118, 119, 126}
[2025-04-30 07:06:29,311] 4 Nodes of Markov blanket: [206, 228, 243, 253]
[2025-04-30 07:06:29,315] [MB metrics] precision: 1.000, recall: 0.085, acc: 0.854, f1: 0.157
[2025-04-30 07:06:36,491] sub_met2 before prunning None
[2025-04-30 07:06:36,491] sub_met after prunning {'fdr': 0.3333, 'tpr': 0.6667, 'fpr': 0.3333, 'shd': 2, 'nnz': 3, 'precision': 0.6667, 'recall': 0.6667, 'F1': 0.6667, 'gscore': 0.3333}
[2025-04-30 07:06:36,491] 
===  207-th graph ===
[2025-04-30 07:06:36,491] 29 Nodes of True MB: [13, 39, 64, 78, 82, 86, 90, 102, 109, 124, 133, 157, 164, 185, 194, 207, 223, 226, 228, 245, 248, 249, 265, 266, 272, 284, 292, 294, 299], parents: {194, 102, 164, 78}, children: {185, 86, 223}, spouse: {133, 265, 266, 13, 272, 284, 157, 292, 294, 39, 299, 64, 207, 82, 90, 226, 228, 109, 245, 248, 249, 124}
[2025-04-30 07:06:36,491] 5 Nodes of Markov blanket: [39, 90, 207, 228, 272]
[2025-04-30 07:06:36,507] [MB metrics] precision: 1.000, recall: 0.172, acc: 0.920, f1: 0.294
[2025-04-30 07:06:43,950] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:06:43,950] sub_met2 before prunning None
[2025-04-30 07:06:43,950] sub_met after prunning None
[2025-04-30 07:06:43,950] 
===  208-th graph ===
[2025-04-30 07:06:43,950] 77 Nodes of True MB: [4, 7, 9, 15, 20, 22, 24, 29, 30, 31, 33, 46, 55, 59, 64, 68, 73, 75, 76, 77, 81, 82, 88, 92, 100, 103, 104, 108, 115, 117, 118, 126, 128, 133, 135, 136, 140, 153, 155, 156, 159, 161, 166, 170, 171, 174, 175, 177, 178, 179, 189, 194, 202, 204, 208, 210, 219, 220, 221, 226, 233, 235, 244, 245, 249, 251, 253, 262, 269, 275, 280, 281, 285, 289, 293, 295, 298], parents: {20}, children: {289, 293, 262, 135, 76, 77, 269, 81, 82, 210, 275, 220, 221}, spouse: {128, 4, 133, 7, 135, 9, 136, 140, 15, 275, 22, 24, 280, 153, 155, 156, 29, 30, 31, 159, 33, 281, 285, 161, 166, 295, 298, 171, 170, 174, 175, 46, 177, 178, 179, 55, 59, 189, 64, 194, 68, 73, 202, 75, 204, 208, 88, 219, 92, 226, 100, 103, 104, 233, 235, 108, 115, 244, 245, 118, 117, 249, 251, 253, 126}
[2025-04-30 07:06:43,950] 21 Nodes of Markov blanket: [9, 22, 46, 59, 92, 100, 115, 135, 140, 153, 155, 161, 175, 204, 208, 219, 226, 244, 245, 251, 275]
[2025-04-30 07:06:43,965] [MB metrics] precision: 1.000, recall: 0.273, acc: 0.813, f1: 0.429
[2025-04-30 07:07:03,811] sub_met2 before prunning None
[2025-04-30 07:07:03,811] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2537, 'shd': 56, 'nnz': 52, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:07:03,811] 
===  209-th graph ===
[2025-04-30 07:07:03,819] 22 Nodes of True MB: [7, 45, 54, 75, 76, 103, 105, 107, 134, 138, 152, 178, 186, 187, 190, 193, 209, 222, 232, 260, 262, 290], parents: {260, 105, 107, 75, 45, 152, 186, 187, 222, 190}, children: {138}, spouse: {193, 290, 134, 103, 7, 232, 262, 76, 209, 178, 54}
[2025-04-30 07:07:03,819] 
===  210-th graph ===
[2025-04-30 07:07:03,819] 10 Nodes of True MB: [4, 30, 140, 153, 178, 208, 210, 253, 281, 285], parents: {4, 281, 140, 208, 178, 153, 285, 253, 30}, children: set(), spouse: {210}
[2025-04-30 07:07:03,819] 
===  211-th graph ===
[2025-04-30 07:07:03,819] 42 Nodes of True MB: [10, 18, 20, 38, 39, 48, 50, 82, 97, 98, 100, 104, 120, 124, 135, 140, 142, 143, 170, 179, 197, 200, 202, 206, 211, 219, 220, 223, 225, 228, 230, 233, 234, 248, 253, 257, 259, 272, 276, 277, 285, 299], parents: {200, 20, 285}, children: {225, 98, 230, 39, 202, 10, 272, 253}, spouse: {257, 259, 135, 140, 142, 143, 18, 276, 277, 285, 38, 170, 299, 48, 50, 179, 197, 206, 82, 211, 219, 220, 223, 248, 97, 100, 228, 230, 104, 233, 234, 120, 124}
[2025-04-30 07:07:03,819] 21 Nodes of Markov blanket: [18, 38, 48, 97, 104, 120, 124, 135, 140, 170, 197, 211, 219, 223, 228, 234, 248, 259, 276, 277, 285]
[2025-04-30 07:07:03,823] [MB metrics] precision: 1.000, recall: 0.500, acc: 0.930, f1: 0.667
[2025-04-30 07:07:23,692] sub_met2 before prunning None
[2025-04-30 07:07:23,692] sub_met after prunning {'fdr': 0.9302, 'tpr': 0.3333, 'fpr': 0.199, 'shd': 46, 'nnz': 43, 'precision': 0.0698, 'recall': 0.3333, 'F1': 0.1154, 'gscore': 0.0}
[2025-04-30 07:07:23,692] 
===  212-th graph ===
[2025-04-30 07:07:23,692] 11 Nodes of True MB: [23, 77, 100, 125, 139, 141, 150, 171, 190, 212, 221], parents: {100, 139, 171, 77, 141, 150, 23, 221, 125, 190}, children: set(), spouse: {212}
[2025-04-30 07:07:23,693] 
===  213-th graph ===
[2025-04-30 07:07:23,693] 17 Nodes of True MB: [10, 40, 119, 126, 144, 148, 149, 173, 189, 206, 213, 243, 251, 259, 281, 284, 299], parents: {259, 40, 10, 299, 148, 281, 251, 284, 189}, children: {149}, spouse: {173, 206, 144, 243, 213, 119, 126}
[2025-04-30 07:07:23,693] 
===  214-th graph ===
[2025-04-30 07:07:23,693] 40 Nodes of True MB: [6, 7, 16, 22, 26, 29, 38, 48, 56, 67, 75, 80, 85, 92, 104, 113, 114, 134, 145, 168, 186, 197, 199, 200, 214, 224, 233, 234, 235, 249, 255, 257, 261, 266, 267, 276, 279, 287, 289, 291], parents: {233, 134}, children: {257, 261, 75, 80, 114, 85, 186}, spouse: {261, 6, 7, 266, 267, 16, 145, 276, 22, 279, 26, 29, 287, 289, 291, 38, 168, 48, 56, 67, 197, 199, 200, 214, 92, 224, 104, 234, 235, 113, 249, 255}
[2025-04-30 07:07:23,693] 14 Nodes of Markov blanket: [6, 7, 16, 48, 56, 113, 197, 214, 233, 255, 261, 266, 267, 276]
[2025-04-30 07:07:23,698] [MB metrics] precision: 1.000, recall: 0.350, acc: 0.911, f1: 0.519
[2025-04-30 07:07:40,533] sub_met2 before prunning None
[2025-04-30 07:07:40,533] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2644, 'shd': 27, 'nnz': 23, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:07:40,533] 
===  215-th graph ===
[2025-04-30 07:07:40,533] 32 Nodes of True MB: [21, 32, 43, 48, 64, 65, 66, 67, 75, 85, 125, 129, 131, 134, 135, 144, 146, 160, 177, 181, 215, 216, 226, 234, 236, 243, 248, 251, 259, 274, 288, 291], parents: {134, 135, 48, 144, 274, 181}, children: {64, 177, 146, 21, 125}, spouse: {129, 131, 259, 134, 32, 160, 288, 291, 43, 181, 65, 66, 67, 75, 85, 215, 216, 226, 234, 236, 243, 248, 251}
[2025-04-30 07:07:40,533] 13 Nodes of Markov blanket: [32, 66, 75, 85, 129, 134, 160, 181, 215, 216, 226, 248, 251]
[2025-04-30 07:07:40,538] [MB metrics] precision: 1.000, recall: 0.406, acc: 0.935, f1: 0.578
[2025-04-30 07:07:56,524] sub_met2 before prunning None
[2025-04-30 07:07:56,524] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.36, 'shd': 30, 'nnz': 27, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:07:56,524] 
===  216-th graph ===
[2025-04-30 07:07:56,524] 45 Nodes of True MB: [18, 24, 45, 53, 64, 67, 69, 70, 77, 105, 111, 112, 113, 117, 124, 125, 134, 135, 145, 164, 168, 176, 177, 180, 182, 185, 187, 196, 197, 215, 216, 219, 222, 227, 233, 234, 235, 239, 246, 247, 248, 250, 251, 259, 272], parents: {64, 67, 235, 239, 272, 113, 219, 124, 222}, children: {70, 45, 53, 187, 125}, spouse: {259, 134, 135, 145, 18, 24, 164, 168, 176, 177, 180, 182, 185, 67, 196, 69, 197, 77, 215, 216, 227, 233, 234, 105, 111, 112, 117, 246, 247, 248, 250, 251}
[2025-04-30 07:07:56,524] 11 Nodes of Markov blanket: [18, 24, 134, 164, 182, 215, 216, 233, 234, 248, 251]
[2025-04-30 07:07:56,534] [MB metrics] precision: 1.000, recall: 0.244, acc: 0.875, f1: 0.393
[2025-04-30 07:08:12,826] sub_met2 before prunning None
[2025-04-30 07:08:12,826] sub_met after prunning {'fdr': 0.9474, 'tpr': 0.3333, 'fpr': 0.3462, 'shd': 20, 'nnz': 19, 'precision': 0.0526, 'recall': 0.3333, 'F1': 0.0909, 'gscore': 0.0}
[2025-04-30 07:08:12,826] 
===  217-th graph ===
[2025-04-30 07:08:12,826] 7 Nodes of True MB: [99, 195, 217, 227, 228, 230, 279], parents: {99, 228, 195, 230, 227, 279}, children: set(), spouse: {217}
[2025-04-30 07:08:12,826] 
===  218-th graph ===
[2025-04-30 07:08:12,826] 36 Nodes of True MB: [25, 40, 45, 54, 55, 64, 72, 83, 97, 109, 111, 112, 119, 121, 135, 149, 158, 166, 190, 191, 197, 201, 218, 220, 226, 227, 235, 246, 251, 253, 258, 264, 272, 273, 281, 298], parents: {272, 226, 235, 197}, children: {72, 83, 54, 55}, spouse: {258, 135, 264, 273, 149, 25, 281, 158, 166, 40, 298, 45, 190, 191, 64, 201, 218, 220, 97, 227, 109, 111, 112, 246, 119, 121, 251, 253}
[2025-04-30 07:08:12,826] 11 Nodes of Markov blanket: [40, 97, 119, 166, 190, 201, 218, 253, 258, 273, 298]
[2025-04-30 07:08:12,842] [MB metrics] precision: 1.000, recall: 0.306, acc: 0.916, f1: 0.468
[2025-04-30 07:08:28,579] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:08:28,579] sub_met2 before prunning None
[2025-04-30 07:08:28,579] sub_met after prunning None
[2025-04-30 07:08:28,579] 
===  219-th graph ===
[2025-04-30 07:08:28,579] 58 Nodes of True MB: [0, 15, 24, 27, 46, 48, 50, 64, 67, 73, 78, 81, 82, 88, 99, 111, 113, 120, 124, 126, 134, 135, 136, 141, 152, 156, 157, 163, 170, 175, 179, 191, 192, 194, 196, 202, 208, 211, 216, 219, 222, 223, 225, 227, 233, 235, 239, 241, 259, 267, 270, 272, 276, 280, 284, 291, 295, 299], parents: set(), children: {192, 225, 163, 196, 135, 78, 111, 272, 81, 216}, spouse: {0, 259, 134, 136, 267, 141, 270, 15, 272, 276, 24, 152, 280, 27, 284, 157, 156, 291, 295, 170, 299, 46, 175, 48, 50, 179, 191, 64, 194, 67, 73, 202, 208, 82, 211, 88, 219, 222, 223, 99, 227, 233, 235, 239, 241, 113, 120, 124, 126}
[2025-04-30 07:08:28,579] 11 Nodes of Markov blanket: [46, 64, 113, 124, 170, 175, 208, 211, 219, 267, 272]
[2025-04-30 07:08:28,579] [MB metrics] precision: 1.000, recall: 0.190, acc: 0.843, f1: 0.319
[2025-04-30 07:08:45,393] sub_met2 before prunning None
[2025-04-30 07:08:45,393] sub_met after prunning {'fdr': 0.9524, 'tpr': 0.2, 'fpr': 0.4, 'shd': 24, 'nnz': 21, 'precision': 0.0476, 'recall': 0.2, 'F1': 0.0769, 'gscore': 0.0}
[2025-04-30 07:08:45,393] 
===  220-th graph ===
[2025-04-30 07:08:45,393] 30 Nodes of True MB: [13, 18, 25, 54, 64, 69, 77, 101, 108, 115, 120, 121, 130, 135, 150, 151, 153, 161, 168, 208, 211, 218, 220, 227, 230, 234, 248, 256, 260, 299], parents: {208, 161, 108}, children: {230, 54, 151, 120, 153}, spouse: {256, 130, 260, 135, 13, 18, 150, 25, 168, 299, 64, 69, 77, 211, 218, 220, 227, 101, 230, 234, 115, 248, 121}
[2025-04-30 07:08:45,393] 4 Nodes of Markov blanket: [77, 101, 115, 220]
[2025-04-30 07:08:45,400] [MB metrics] precision: 1.000, recall: 0.133, acc: 0.913, f1: 0.235
[2025-04-30 07:08:52,643] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:08:52,643] sub_met2 before prunning None
[2025-04-30 07:08:52,643] sub_met after prunning None
[2025-04-30 07:08:52,643] 
===  221-th graph ===
[2025-04-30 07:08:52,643] 42 Nodes of True MB: [5, 22, 23, 25, 38, 47, 65, 67, 73, 76, 77, 100, 102, 107, 125, 128, 133, 139, 141, 150, 169, 171, 174, 180, 183, 190, 194, 208, 212, 221, 226, 233, 236, 243, 244, 245, 248, 249, 255, 275, 294, 295], parents: {208, 233, 100, 245}, children: {65, 5, 38, 212, 25}, spouse: {128, 133, 139, 141, 275, 22, 23, 150, 294, 295, 169, 171, 174, 47, 180, 183, 190, 194, 67, 73, 76, 77, 221, 226, 100, 102, 107, 236, 243, 244, 248, 249, 125, 255}
[2025-04-30 07:08:52,643] 8 Nodes of Markov blanket: [47, 77, 100, 141, 150, 190, 221, 255]
[2025-04-30 07:08:52,643] [MB metrics] precision: 1.000, recall: 0.190, acc: 0.885, f1: 0.320
[2025-04-30 07:09:09,371] sub_met2 before prunning None
[2025-04-30 07:09:09,371] sub_met after prunning {'fdr': 0.9167, 'tpr': 1.0, 'fpr': 0.4074, 'shd': 11, 'nnz': 12, 'precision': 0.0833, 'recall': 1.0, 'F1': 0.1538, 'gscore': 0.0}
[2025-04-30 07:09:09,371] 
===  222-th graph ===
[2025-04-30 07:09:09,371] 68 Nodes of True MB: [20, 25, 33, 34, 36, 39, 45, 46, 57, 64, 67, 68, 69, 75, 78, 88, 89, 90, 98, 101, 104, 105, 107, 109, 110, 113, 124, 129, 131, 141, 148, 152, 163, 170, 176, 179, 184, 185, 186, 187, 190, 199, 205, 206, 209, 216, 219, 222, 224, 232, 233, 235, 239, 241, 247, 250, 253, 254, 255, 257, 260, 266, 272, 275, 286, 293, 297, 299], parents: {224, 131, 69, 299, 20}, children: {33, 34, 199, 176, 209, 216, 89, 286}, spouse: {257, 129, 260, 266, 141, 272, 275, 148, 152, 25, 163, 36, 293, 39, 297, 170, 45, 46, 179, 184, 57, 186, 187, 185, 190, 64, 67, 68, 75, 205, 206, 78, 88, 90, 219, 222, 98, 101, 232, 233, 104, 105, 107, 235, 110, 239, 109, 241, 113, 247, 250, 124, 253, 254, 255}
[2025-04-30 07:09:09,371] 14 Nodes of Markov blanket: [36, 57, 64, 75, 78, 98, 109, 141, 152, 184, 190, 222, 260, 275]
[2025-04-30 07:09:09,371] [MB metrics] precision: 1.000, recall: 0.206, acc: 0.820, f1: 0.341
[2025-04-30 07:09:26,164] sub_met2 before prunning None
[2025-04-30 07:09:26,164] sub_met after prunning {'fdr': 0.9688, 'tpr': 0.3333, 'fpr': 0.3523, 'shd': 33, 'nnz': 32, 'precision': 0.0312, 'recall': 0.3333, 'F1': 0.0571, 'gscore': 0.0}
[2025-04-30 07:09:26,164] 
===  223-th graph ===
[2025-04-30 07:09:26,164] 54 Nodes of True MB: [0, 5, 24, 27, 28, 32, 38, 39, 48, 50, 59, 73, 90, 94, 97, 98, 100, 120, 126, 134, 139, 140, 141, 142, 145, 156, 157, 164, 170, 186, 188, 191, 196, 197, 199, 207, 211, 219, 223, 224, 226, 227, 228, 233, 241, 245, 246, 252, 260, 277, 280, 284, 291, 294], parents: {228, 294, 207, 245, 90}, children: {196, 39, 139, 188, 94}, spouse: {0, 260, 5, 134, 140, 141, 142, 145, 277, 24, 280, 27, 284, 157, 156, 28, 32, 291, 164, 38, 170, 48, 50, 186, 59, 191, 197, 199, 73, 211, 219, 223, 224, 97, 98, 227, 100, 226, 233, 241, 246, 120, 252, 126}
[2025-04-30 07:09:26,164] 10 Nodes of Markov blanket: [38, 97, 120, 140, 170, 191, 211, 223, 226, 252]
[2025-04-30 07:09:26,171] [MB metrics] precision: 1.000, recall: 0.185, acc: 0.851, f1: 0.312
[2025-04-30 07:09:41,457] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:09:41,457] sub_met2 before prunning None
[2025-04-30 07:09:41,457] sub_met after prunning None
[2025-04-30 07:09:41,457] 
===  224-th graph ===
[2025-04-30 07:09:41,457] 66 Nodes of True MB: [8, 11, 13, 18, 20, 25, 29, 31, 32, 38, 44, 51, 57, 67, 68, 69, 70, 73, 74, 82, 84, 92, 98, 101, 104, 111, 122, 126, 131, 133, 140, 141, 145, 149, 166, 169, 176, 178, 182, 184, 186, 188, 191, 192, 199, 202, 214, 222, 223, 224, 234, 246, 248, 249, 250, 251, 260, 264, 267, 268, 280, 282, 286, 289, 293, 299], parents: {73, 250}, children: {68, 8, 11, 268, 182, 186, 251, 188, 222}, spouse: {131, 260, 133, 264, 267, 140, 13, 141, 145, 18, 20, 149, 280, 25, 282, 29, 286, 31, 32, 289, 293, 166, 38, 169, 299, 44, 176, 178, 51, 184, 57, 186, 191, 192, 67, 69, 70, 199, 202, 74, 82, 84, 214, 92, 223, 224, 98, 101, 104, 234, 111, 246, 248, 249, 122, 251, 126}
[2025-04-30 07:09:41,457] 17 Nodes of Markov blanket: [25, 31, 69, 84, 101, 126, 131, 133, 149, 166, 169, 184, 186, 224, 249, 260, 286]
[2025-04-30 07:09:41,474] [MB metrics] precision: 1.000, recall: 0.258, acc: 0.837, f1: 0.410
[2025-04-30 07:10:00,589] sub_met2 before prunning None
[2025-04-30 07:10:00,589] sub_met after prunning {'fdr': 0.9375, 'tpr': 0.6, 'fpr': 0.3435, 'shd': 47, 'nnz': 48, 'precision': 0.0625, 'recall': 0.6, 'F1': 0.1132, 'gscore': 0.0}
[2025-04-30 07:10:00,589] 
===  225-th graph ===
[2025-04-30 07:10:00,589] 34 Nodes of True MB: [0, 3, 31, 38, 39, 59, 69, 82, 102, 111, 120, 122, 125, 131, 134, 140, 152, 159, 165, 168, 181, 185, 191, 194, 195, 211, 219, 225, 235, 251, 262, 266, 270, 287], parents: {211, 219}, children: {3, 195, 165, 270, 59}, spouse: {0, 131, 134, 262, 266, 140, 152, 159, 287, 31, 38, 39, 168, 181, 185, 191, 194, 69, 82, 225, 102, 235, 111, 120, 122, 251, 125}
[2025-04-30 07:10:00,589] 5 Nodes of Markov blanket: [134, 152, 191, 225, 251]
[2025-04-30 07:10:00,592] [MB metrics] precision: 1.000, recall: 0.147, acc: 0.899, f1: 0.256
[2025-04-30 07:10:07,980] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:10:07,980] sub_met2 before prunning None
[2025-04-30 07:10:07,980] sub_met after prunning None
[2025-04-30 07:10:07,980] 
===  226-th graph ===
[2025-04-30 07:10:07,980] 57 Nodes of True MB: [5, 10, 22, 28, 29, 32, 39, 47, 56, 64, 65, 66, 73, 75, 76, 86, 92, 94, 97, 124, 133, 152, 153, 157, 166, 169, 177, 178, 185, 189, 197, 203, 204, 206, 207, 208, 215, 218, 221, 223, 226, 228, 235, 245, 251, 252, 255, 265, 266, 272, 274, 287, 291, 292, 293, 294, 295], parents: {152, 178}, children: {65, 228, 293, 177, 274, 86, 218, 28, 157, 94}, spouse: {133, 5, 265, 10, 266, 272, 22, 152, 153, 28, 29, 157, 287, 32, 291, 292, 166, 295, 294, 169, 39, 47, 56, 185, 189, 64, 66, 197, 73, 75, 76, 204, 206, 207, 208, 203, 215, 92, 221, 223, 97, 226, 235, 252, 245, 251, 124, 255}
[2025-04-30 07:10:07,980] 15 Nodes of Markov blanket: [5, 22, 28, 97, 152, 157, 197, 204, 208, 215, 223, 226, 245, 251, 252]
[2025-04-30 07:10:07,980] [MB metrics] precision: 1.000, recall: 0.263, acc: 0.858, f1: 0.417
[2025-04-30 07:10:24,233] sub_met2 before prunning None
[2025-04-30 07:10:24,233] sub_met after prunning {'fdr': 0.9375, 'tpr': 0.4, 'fpr': 0.3, 'shd': 33, 'nnz': 32, 'precision': 0.0625, 'recall': 0.4, 'F1': 0.1081, 'gscore': 0.0}
[2025-04-30 07:10:24,233] 
===  227-th graph ===
[2025-04-30 07:10:24,239] 43 Nodes of True MB: [0, 24, 25, 27, 29, 44, 48, 54, 64, 67, 73, 77, 82, 92, 97, 99, 101, 105, 120, 121, 134, 145, 157, 168, 187, 191, 195, 196, 197, 216, 217, 218, 219, 220, 223, 227, 228, 230, 233, 241, 246, 279, 284], parents: {97, 101, 44, 48, 82, 120, 92, 29}, children: {217, 187, 196, 54}, spouse: {0, 134, 145, 279, 24, 25, 27, 284, 157, 168, 191, 64, 195, 67, 197, 73, 77, 216, 218, 219, 220, 223, 99, 227, 228, 230, 105, 233, 241, 246, 120, 121}
[2025-04-30 07:10:24,239] 4 Nodes of Markov blanket: [48, 120, 191, 227]
[2025-04-30 07:10:24,242] [MB metrics] precision: 1.000, recall: 0.093, acc: 0.863, f1: 0.170
[2025-04-30 07:10:31,458] sub_met2 before prunning None
[2025-04-30 07:10:31,458] sub_met after prunning {'fdr': 0.3333, 'tpr': 1.0, 'fpr': 0.25, 'shd': 1, 'nnz': 3, 'precision': 0.6667, 'recall': 1.0, 'F1': 0.8, 'gscore': 0.5}
[2025-04-30 07:10:31,473] 
===  228-th graph ===
[2025-04-30 07:10:31,473] 48 Nodes of True MB: [0, 2, 5, 27, 59, 61, 75, 82, 90, 91, 97, 99, 104, 112, 118, 122, 125, 150, 152, 155, 166, 181, 189, 194, 195, 198, 206, 207, 211, 217, 223, 226, 227, 228, 230, 231, 232, 245, 253, 256, 257, 260, 269, 277, 279, 291, 294, 295], parents: {226, 291, 166, 206, 152}, children: {97, 2, 295, 150, 217, 253, 223}, spouse: {256, 0, 257, 260, 5, 269, 277, 279, 27, 155, 294, 181, 59, 61, 189, 194, 195, 198, 75, 206, 207, 82, 211, 90, 91, 99, 228, 227, 230, 231, 232, 104, 112, 245, 118, 122, 125}
[2025-04-30 07:10:31,473] 8 Nodes of Markov blanket: [90, 122, 206, 207, 211, 228, 253, 256]
[2025-04-30 07:10:31,476] [MB metrics] precision: 1.000, recall: 0.167, acc: 0.865, f1: 0.286
[2025-04-30 07:10:49,212] sub_met2 before prunning None
[2025-04-30 07:10:49,212] sub_met after prunning {'fdr': 0.6364, 'tpr': 1.0, 'fpr': 0.2917, 'shd': 7, 'nnz': 11, 'precision': 0.3636, 'recall': 1.0, 'F1': 0.5333, 'gscore': 0.0}
[2025-04-30 07:10:49,212] 
===  229-th graph ===
[2025-04-30 07:10:49,212] 24 Nodes of True MB: [11, 33, 43, 44, 87, 88, 92, 102, 103, 119, 122, 129, 142, 147, 172, 199, 202, 229, 247, 273, 280, 283, 284, 287], parents: {129, 202, 44, 87, 119, 283, 92}, children: {273, 172}, spouse: {33, 280, 229, 102, 103, 199, 43, 11, 142, 147, 247, 88, 122, 284, 287}
[2025-04-30 07:10:49,212] 5 Nodes of Markov blanket: [33, 88, 147, 229, 247]
[2025-04-30 07:10:49,227] [MB metrics] precision: 1.000, recall: 0.208, acc: 0.934, f1: 0.345
[2025-04-30 07:10:56,830] sub_met2 before prunning None
[2025-04-30 07:10:56,830] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3333, 'shd': 4, 'nnz': 3, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:10:56,830] 
===  230-th graph ===
[2025-04-30 07:10:56,830] 24 Nodes of True MB: [13, 18, 98, 99, 104, 130, 135, 143, 150, 151, 195, 211, 217, 220, 227, 228, 230, 234, 248, 257, 260, 276, 279, 299], parents: {135, 234, 299, 211, 248, 220}, children: {217, 98, 151}, spouse: {257, 130, 99, 227, 228, 230, 195, 104, 135, 260, 13, 143, 18, 211, 276, 150, 279, 220}
[2025-04-30 07:10:56,830] 5 Nodes of Markov blanket: [18, 98, 104, 230, 276]
[2025-04-30 07:10:56,845] [MB metrics] precision: 1.000, recall: 0.208, acc: 0.937, f1: 0.345
[2025-04-30 07:11:04,335] sub_met2 before prunning None
[2025-04-30 07:11:04,335] sub_met after prunning {'fdr': 0.5, 'tpr': 0.75, 'fpr': 0.5, 'shd': 4, 'nnz': 6, 'precision': 0.5, 'recall': 0.75, 'F1': 0.6, 'gscore': 0.0}
[2025-04-30 07:11:04,335] 
===  231-th graph ===
[2025-04-30 07:11:04,335] 43 Nodes of True MB: [12, 16, 17, 19, 42, 48, 62, 64, 73, 101, 107, 110, 112, 121, 122, 140, 141, 155, 165, 168, 171, 174, 179, 181, 183, 194, 197, 204, 228, 231, 233, 234, 237, 248, 253, 254, 276, 277, 284, 293, 295, 298, 299], parents: {122, 141, 174}, children: {295, 171, 204, 17, 19, 183}, spouse: {12, 140, 16, 276, 277, 155, 284, 165, 293, 168, 298, 299, 42, 48, 179, 181, 62, 64, 194, 197, 73, 228, 101, 231, 233, 234, 107, 237, 110, 112, 248, 121, 253, 254}
[2025-04-30 07:11:04,335] 4 Nodes of Markov blanket: [140, 231, 234, 254]
[2025-04-30 07:11:04,335] [MB metrics] precision: 1.000, recall: 0.093, acc: 0.870, f1: 0.170
[2025-04-30 07:11:11,514] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:11:11,514] sub_met2 before prunning None
[2025-04-30 07:11:11,514] sub_met after prunning None
[2025-04-30 07:11:11,514] 
===  232-th graph ===
[2025-04-30 07:11:11,514] 68 Nodes of True MB: [0, 2, 5, 7, 12, 15, 25, 33, 36, 42, 47, 52, 54, 58, 59, 61, 67, 76, 88, 90, 91, 92, 93, 103, 107, 109, 111, 113, 125, 129, 134, 138, 140, 141, 143, 152, 154, 168, 170, 178, 181, 184, 192, 193, 195, 198, 206, 209, 222, 228, 232, 233, 234, 245, 247, 248, 250, 255, 257, 260, 262, 269, 271, 275, 286, 290, 291, 293], parents: {140, 15}, children: {33, 2, 42, 138, 52, 248, 154, 92, 286}, spouse: {0, 257, 129, 260, 5, 134, 7, 262, 12, 141, 269, 271, 143, 275, 152, 25, 290, 291, 36, 293, 168, 170, 47, 178, 181, 54, 184, 58, 59, 61, 192, 193, 195, 67, 198, 76, 206, 209, 88, 90, 91, 92, 93, 222, 228, 103, 232, 233, 234, 107, 109, 111, 113, 245, 247, 250, 125, 255}
[2025-04-30 07:11:11,514] 22 Nodes of Markov blanket: [5, 7, 36, 54, 67, 76, 88, 92, 103, 107, 109, 134, 140, 170, 178, 184, 192, 195, 232, 250, 255, 260]
[2025-04-30 07:11:11,514] [MB metrics] precision: 1.000, recall: 0.324, acc: 0.844, f1: 0.489
[2025-04-30 07:11:31,433] sub_met2 before prunning None
[2025-04-30 07:11:31,438] sub_met after prunning {'fdr': 0.9756, 'tpr': 0.1, 'fpr': 0.181, 'shd': 48, 'nnz': 41, 'precision': 0.0244, 'recall': 0.1, 'F1': 0.0392, 'gscore': 0.0}
[2025-04-30 07:11:31,438] 
===  233-th graph ===
[2025-04-30 07:11:31,438] 91 Nodes of True MB: [0, 10, 13, 15, 16, 24, 25, 27, 33, 40, 45, 49, 50, 62, 63, 64, 66, 67, 68, 69, 73, 88, 90, 92, 96, 100, 107, 108, 109, 111, 112, 115, 117, 120, 121, 129, 134, 135, 141, 145, 147, 152, 155, 157, 159, 161, 166, 168, 169, 171, 177, 179, 180, 181, 185, 189, 191, 194, 196, 200, 203, 206, 208, 211, 214, 216, 219, 221, 222, 223, 227, 231, 232, 233, 241, 245, 246, 247, 259, 260, 266, 267, 275, 276, 279, 280, 284, 287, 288, 291, 293], parents: set(), children: {288, 33, 129, 280, 196, 69, 287, 40, 10, 171, 45, 15, 179, 214, 221, 189, 159}, spouse: {0, 13, 16, 24, 25, 27, 49, 50, 62, 63, 64, 66, 67, 68, 69, 73, 88, 90, 92, 96, 100, 107, 108, 109, 111, 112, 115, 117, 120, 121, 134, 135, 141, 145, 147, 152, 155, 157, 161, 166, 168, 169, 177, 179, 180, 181, 185, 191, 194, 196, 200, 203, 206, 208, 211, 216, 219, 222, 223, 227, 231, 232, 233, 241, 245, 246, 247, 259, 260, 266, 267, 275, 276, 279, 284, 287, 291, 293}
[2025-04-30 07:11:31,438] 20 Nodes of Markov blanket: [24, 67, 73, 92, 117, 134, 135, 145, 152, 155, 166, 168, 179, 191, 214, 216, 233, 247, 279, 287]
[2025-04-30 07:11:31,441] [MB metrics] precision: 1.000, recall: 0.220, acc: 0.759, f1: 0.360
[2025-04-30 07:11:51,195] sub_met2 before prunning None
[2025-04-30 07:11:51,195] sub_met after prunning {'fdr': 0.9474, 'tpr': 0.2222, 'fpr': 0.1989, 'shd': 42, 'nnz': 38, 'precision': 0.0526, 'recall': 0.2222, 'F1': 0.0851, 'gscore': 0.0}
[2025-04-30 07:11:51,195] 
===  234-th graph ===
[2025-04-30 07:11:51,195] 71 Nodes of True MB: [0, 13, 18, 19, 22, 30, 31, 42, 47, 48, 53, 55, 56, 62, 68, 73, 82, 84, 88, 93, 102, 105, 106, 108, 111, 121, 125, 131, 134, 135, 140, 144, 152, 156, 164, 166, 168, 176, 178, 182, 183, 185, 192, 199, 202, 203, 211, 214, 215, 216, 220, 224, 230, 231, 232, 234, 237, 239, 240, 245, 248, 250, 251, 259, 261, 266, 267, 271, 277, 289, 299], parents: {73, 266, 166}, children: {68, 261, 230, 105, 42, 106, 144, 19, 53, 277, 125, 62}, spouse: {0, 131, 259, 134, 135, 267, 140, 13, 271, 18, 277, 22, 152, 156, 30, 31, 289, 164, 166, 168, 42, 299, 47, 48, 176, 178, 182, 183, 55, 185, 56, 192, 199, 202, 203, 82, 211, 84, 214, 215, 88, 216, 220, 93, 224, 102, 231, 232, 234, 108, 237, 239, 240, 111, 245, 248, 121, 250, 251}
[2025-04-30 07:11:51,195] 24 Nodes of Markov blanket: [13, 18, 30, 31, 42, 48, 84, 102, 111, 121, 140, 152, 156, 164, 178, 202, 211, 216, 231, 234, 240, 248, 277, 289]
[2025-04-30 07:11:51,209] [MB metrics] precision: 1.000, recall: 0.338, acc: 0.843, f1: 0.505
[2025-04-30 07:12:11,891] sub_met2 before prunning None
[2025-04-30 07:12:11,891] sub_met after prunning {'fdr': 0.9455, 'tpr': 0.2143, 'fpr': 0.1985, 'shd': 63, 'nnz': 55, 'precision': 0.0545, 'recall': 0.2143, 'F1': 0.087, 'gscore': 0.0}
[2025-04-30 07:12:11,891] 
===  235-th graph ===
[2025-04-30 07:12:11,891] 45 Nodes of True MB: [7, 13, 24, 33, 50, 55, 59, 64, 67, 75, 92, 98, 108, 113, 118, 119, 121, 124, 127, 141, 152, 165, 168, 171, 175, 197, 208, 214, 216, 218, 219, 222, 225, 226, 235, 239, 249, 262, 266, 270, 272, 277, 287, 291, 299], parents: {121, 299, 141}, children: {165, 262, 75, 108, 13, 119, 216, 218, 59, 127}, spouse: {7, 266, 141, 270, 272, 277, 152, 24, 287, 33, 291, 168, 171, 175, 50, 55, 64, 67, 197, 208, 214, 219, 92, 222, 225, 226, 98, 121, 235, 239, 113, 118, 249, 124}
[2025-04-30 07:12:11,891] 3 Nodes of Markov blanket: [98, 235, 299]
[2025-04-30 07:12:11,902] [MB metrics] precision: 1.000, recall: 0.067, acc: 0.860, f1: 0.125
[2025-04-30 07:12:18,913] sub_met2 before prunning None
[2025-04-30 07:12:18,913] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.5, 'shd': 2, 'nnz': 1, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:12:18,913] 
===  236-th graph ===
[2025-04-30 07:12:18,913] 30 Nodes of True MB: [12, 13, 25, 38, 50, 64, 67, 76, 95, 105, 125, 148, 152, 155, 159, 160, 180, 201, 204, 215, 221, 236, 237, 243, 244, 248, 269, 271, 277, 289], parents: {152}, children: {64, 201, 38, 271}, spouse: {12, 13, 269, 148, 277, 25, 155, 159, 160, 289, 50, 180, 67, 204, 76, 215, 221, 95, 105, 236, 237, 243, 244, 248, 125}
[2025-04-30 07:12:18,913] 3 Nodes of Markov blanket: [125, 236, 248]
[2025-04-30 07:12:18,929] [MB metrics] precision: 1.000, recall: 0.100, acc: 0.907, f1: 0.182
[2025-04-30 07:12:25,369] sub_met2 before prunning None
[2025-04-30 07:12:25,369] sub_met after prunning {'fdr': 0.0, 'tpr': 0.0, 'fpr': 0.0, 'shd': 1, 'nnz': 0, 'precision': nan, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:12:25,369] 
===  237-th graph ===
[2025-04-30 07:12:25,369] 42 Nodes of True MB: [19, 20, 25, 38, 42, 48, 49, 50, 67, 73, 74, 76, 80, 104, 105, 121, 122, 124, 126, 139, 140, 148, 174, 179, 180, 191, 204, 231, 234, 236, 237, 243, 245, 248, 258, 260, 271, 275, 277, 289, 294, 297], parents: {260, 297, 49, 179, 20, 245, 191}, children: {258, 19, 126, 271}, spouse: {139, 140, 275, 148, 277, 25, 289, 294, 38, 42, 174, 48, 50, 180, 67, 73, 74, 204, 76, 80, 231, 104, 105, 234, 236, 237, 243, 248, 121, 122, 124}
[2025-04-30 07:12:25,369] 15 Nodes of Markov blanket: [25, 74, 80, 104, 105, 122, 124, 140, 148, 191, 204, 237, 258, 289, 294]
[2025-04-30 07:12:25,369] [MB metrics] precision: 1.000, recall: 0.357, acc: 0.909, f1: 0.526
[2025-04-30 07:12:42,545] sub_met2 before prunning None
[2025-04-30 07:12:42,545] sub_met after prunning {'fdr': 0.8718, 'tpr': 0.625, 'fpr': 0.3505, 'shd': 37, 'nnz': 39, 'precision': 0.1282, 'recall': 0.625, 'F1': 0.2128, 'gscore': 0.0}
[2025-04-30 07:12:42,546] 
===  238-th graph ===
[2025-04-30 07:12:42,546] 14 Nodes of True MB: [12, 46, 62, 76, 159, 168, 183, 184, 238, 276, 280, 284, 286, 292], parents: {280, 292, 168, 12, 76, 46, 286, 276, 183, 184, 284, 62, 159}, children: set(), spouse: {238}
[2025-04-30 07:12:42,546] 
===  239-th graph ===
[2025-04-30 07:12:42,547] 45 Nodes of True MB: [10, 15, 32, 35, 49, 55, 57, 64, 67, 70, 71, 73, 88, 96, 97, 102, 109, 113, 122, 124, 131, 133, 140, 144, 147, 156, 166, 174, 179, 216, 219, 222, 234, 235, 239, 244, 253, 256, 266, 267, 272, 291, 296, 298, 299], parents: {267, 244, 174}, children: {96, 35, 71, 298, 109, 144, 216, 57}, spouse: {256, 131, 133, 10, 266, 140, 15, 272, 147, 156, 32, 291, 166, 296, 299, 49, 179, 55, 64, 67, 70, 73, 88, 219, 222, 97, 102, 234, 235, 109, 239, 113, 122, 124, 253}
[2025-04-30 07:12:42,547] 3 Nodes of Markov blanket: [97, 239, 296]
[2025-04-30 07:12:42,550] [MB metrics] precision: 1.000, recall: 0.067, acc: 0.860, f1: 0.125
[2025-04-30 07:12:49,684] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:12:49,684] sub_met2 before prunning None
[2025-04-30 07:12:49,700] sub_met after prunning None
[2025-04-30 07:12:49,700] 
===  240-th graph ===
[2025-04-30 07:12:49,700] 21 Nodes of True MB: [24, 30, 31, 84, 88, 102, 105, 107, 115, 135, 140, 148, 160, 161, 175, 197, 234, 240, 245, 264, 282], parents: {135}, children: {105, 107, 148}, spouse: {160, 161, 197, 102, 264, 234, 140, 175, 240, 115, 84, 245, 88, 24, 282, 30, 31}
[2025-04-30 07:12:49,700] 6 Nodes of Markov blanket: [30, 84, 115, 140, 234, 240]
[2025-04-30 07:12:49,700] [MB metrics] precision: 1.000, recall: 0.286, acc: 0.947, f1: 0.444
[2025-04-30 07:12:59,785] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:12:59,785] sub_met2 before prunning None
[2025-04-30 07:12:59,785] sub_met after prunning None
[2025-04-30 07:12:59,785] 
===  241-th graph ===
[2025-04-30 07:12:59,785] 47 Nodes of True MB: [0, 1, 5, 16, 20, 24, 27, 36, 42, 46, 57, 73, 78, 79, 86, 92, 119, 120, 123, 134, 142, 148, 157, 162, 176, 185, 191, 196, 199, 205, 219, 222, 223, 227, 233, 241, 244, 252, 253, 256, 257, 284, 289, 291, 292, 297, 298], parents: {16, 289, 292}, children: {176, 162, 196, 79}, spouse: {256, 257, 1, 0, 5, 134, 142, 20, 148, 24, 27, 284, 157, 291, 36, 297, 298, 42, 46, 185, 57, 191, 199, 73, 205, 78, 86, 219, 92, 222, 223, 227, 233, 241, 244, 119, 120, 123, 252, 253}
[2025-04-30 07:12:59,785] 13 Nodes of Markov blanket: [1, 5, 46, 57, 78, 92, 119, 123, 142, 185, 241, 252, 291]
[2025-04-30 07:12:59,785] [MB metrics] precision: 1.000, recall: 0.277, acc: 0.886, f1: 0.433
[2025-04-30 07:13:15,242] sub_met2 before prunning None
[2025-04-30 07:13:15,242] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3247, 'shd': 26, 'nnz': 25, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:13:15,242] 
===  242-th graph ===
[2025-04-30 07:13:15,242] 22 Nodes of True MB: [5, 6, 11, 25, 33, 40, 46, 47, 56, 61, 66, 74, 82, 107, 115, 117, 130, 189, 192, 194, 242, 292], parents: {192, 33, 6, 40, 74, 107, 47, 117, 25, 189}, children: {130}, spouse: {66, 194, 292, 5, 11, 46, 242, 82, 115, 56, 61}
[2025-04-30 07:13:15,242] 
===  243-th graph ===
[2025-04-30 07:13:15,242] 33 Nodes of True MB: [25, 38, 50, 56, 64, 67, 76, 105, 113, 119, 126, 128, 141, 142, 144, 148, 149, 156, 173, 183, 206, 213, 215, 221, 236, 237, 243, 244, 248, 267, 271, 276, 289], parents: {141, 142, 276, 183, 56}, children: {64, 38, 271, 113, 149}, spouse: {128, 267, 144, 148, 25, 156, 289, 173, 50, 64, 67, 76, 206, 213, 215, 221, 105, 236, 237, 243, 244, 119, 248, 126}
[2025-04-30 07:13:15,244] 5 Nodes of Markov blanket: [64, 156, 206, 243, 248]
[2025-04-30 07:13:15,246] [MB metrics] precision: 1.000, recall: 0.152, acc: 0.903, f1: 0.263
[2025-04-30 07:13:22,753] sub_met2 before prunning None
[2025-04-30 07:13:22,753] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.6667, 'shd': 7, 'nnz': 6, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:13:22,753] 
===  244-th graph ===
[2025-04-30 07:13:22,753] 54 Nodes of True MB: [0, 6, 7, 9, 18, 20, 38, 42, 59, 64, 73, 76, 79, 86, 88, 99, 100, 102, 111, 113, 117, 118, 122, 123, 124, 126, 128, 140, 156, 158, 168, 169, 174, 180, 194, 199, 206, 208, 221, 236, 239, 241, 243, 244, 248, 252, 253, 257, 259, 266, 267, 281, 287, 298], parents: {266}, children: {0, 99, 259, 38, 6, 168, 76, 79, 239, 113}, spouse: {128, 257, 7, 9, 267, 140, 18, 20, 281, 156, 158, 287, 169, 298, 42, 174, 180, 59, 64, 194, 199, 73, 206, 208, 86, 88, 221, 100, 102, 236, 111, 241, 243, 244, 117, 118, 252, 248, 122, 123, 124, 253, 126}
[2025-04-30 07:13:22,753] 16 Nodes of Markov blanket: [7, 9, 20, 59, 73, 76, 102, 117, 123, 156, 169, 174, 180, 208, 244, 248]
[2025-04-30 07:13:22,759] [MB metrics] precision: 1.000, recall: 0.296, acc: 0.873, f1: 0.457
[2025-04-30 07:13:40,750] sub_met2 before prunning None
[2025-04-30 07:13:40,750] sub_met after prunning {'fdr': 0.8889, 'tpr': 0.5714, 'fpr': 0.2832, 'shd': 35, 'nnz': 36, 'precision': 0.1111, 'recall': 0.5714, 'F1': 0.186, 'gscore': 0.0}
[2025-04-30 07:13:40,750] 
===  245-th graph ===
[2025-04-30 07:13:40,750] 60 Nodes of True MB: [0, 4, 6, 20, 22, 29, 30, 31, 41, 42, 47, 49, 50, 64, 74, 82, 84, 88, 90, 92, 93, 100, 105, 108, 109, 112, 118, 133, 134, 140, 155, 158, 166, 179, 191, 192, 201, 204, 206, 207, 208, 221, 223, 226, 228, 232, 233, 234, 237, 240, 245, 251, 257, 260, 267, 271, 288, 293, 294, 297], parents: {82, 166}, children: {288, 4, 293, 41, 42, 105, 237, 221, 223}, spouse: {0, 257, 260, 133, 134, 6, 267, 140, 271, 20, 22, 155, 29, 158, 30, 31, 293, 294, 297, 47, 49, 50, 179, 191, 64, 192, 201, 74, 204, 206, 207, 208, 84, 88, 90, 92, 93, 226, 100, 228, 232, 233, 234, 108, 109, 112, 240, 245, 118, 251}
[2025-04-30 07:13:40,759] 13 Nodes of Markov blanket: [22, 100, 112, 134, 158, 166, 191, 204, 208, 226, 245, 251, 257]
[2025-04-30 07:13:40,761] [MB metrics] precision: 1.000, recall: 0.217, acc: 0.842, f1: 0.356
[2025-04-30 07:13:55,948] sub_met2 before prunning None
[2025-04-30 07:13:55,948] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3506, 'shd': 28, 'nnz': 27, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:13:55,948] 
===  246-th graph ===
[2025-04-30 07:13:55,948] 51 Nodes of True MB: [13, 22, 32, 40, 45, 46, 66, 67, 77, 83, 92, 97, 98, 105, 106, 109, 111, 115, 126, 141, 145, 149, 152, 155, 168, 181, 183, 185, 186, 187, 188, 190, 191, 194, 197, 199, 200, 216, 218, 223, 224, 227, 233, 246, 258, 259, 260, 280, 285, 292, 298], parents: {115}, children: {32, 292, 40, 187, 46, 83, 22, 155, 188, 190}, spouse: {258, 259, 260, 141, 13, 145, 149, 152, 280, 155, 285, 168, 298, 45, 181, 183, 185, 186, 191, 194, 67, 66, 197, 199, 200, 77, 216, 218, 92, 223, 224, 97, 98, 227, 233, 105, 106, 109, 111, 246, 126}
[2025-04-30 07:13:55,948] 11 Nodes of Markov blanket: [13, 126, 145, 152, 155, 191, 194, 197, 200, 246, 280]
[2025-04-30 07:13:55,958] [MB metrics] precision: 1.000, recall: 0.216, acc: 0.866, f1: 0.355
[2025-04-30 07:14:11,796] sub_met2 before prunning None
[2025-04-30 07:14:11,796] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.2407, 'shd': 13, 'nnz': 13, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:14:11,796] 
===  247-th graph ===
[2025-04-30 07:14:11,796] 62 Nodes of True MB: [12, 14, 20, 24, 30, 31, 32, 33, 39, 43, 45, 52, 58, 66, 68, 69, 78, 88, 89, 90, 101, 102, 103, 111, 112, 128, 134, 141, 142, 143, 148, 154, 163, 168, 177, 180, 183, 185, 186, 192, 193, 194, 196, 198, 200, 202, 216, 222, 229, 232, 233, 247, 251, 255, 263, 266, 273, 280, 284, 289, 291, 293], parents: {32, 128, 68, 154, 141, 78, 90, 251}, children: {263, 45, 14, 273, 52, 89}, spouse: {134, 266, 12, 142, 143, 20, 148, 24, 280, 284, 30, 31, 289, 33, 163, 291, 293, 39, 168, 43, 45, 177, 180, 183, 185, 58, 186, 192, 193, 66, 194, 196, 69, 198, 200, 202, 216, 88, 222, 229, 102, 103, 232, 233, 101, 111, 112, 247, 255}
[2025-04-30 07:14:11,796] 10 Nodes of Markov blanket: [33, 69, 88, 111, 163, 229, 233, 247, 289, 293]
[2025-04-30 07:14:11,803] [MB metrics] precision: 1.000, recall: 0.161, acc: 0.823, f1: 0.278
[2025-04-30 07:14:27,737] sub_met2 before prunning None
[2025-04-30 07:14:27,737] sub_met after prunning {'fdr': 0.9286, 'tpr': 0.25, 'fpr': 0.3171, 'shd': 16, 'nnz': 14, 'precision': 0.0714, 'recall': 0.25, 'F1': 0.1111, 'gscore': 0.0}
[2025-04-30 07:14:27,737] 
===  248-th graph ===
[2025-04-30 07:14:27,737] 54 Nodes of True MB: [13, 19, 32, 38, 40, 42, 48, 51, 57, 58, 74, 82, 85, 90, 92, 95, 109, 110, 121, 125, 134, 135, 140, 176, 181, 182, 185, 207, 211, 215, 216, 220, 221, 224, 230, 231, 232, 234, 236, 237, 243, 244, 248, 249, 250, 251, 257, 258, 259, 261, 272, 277, 284, 299], parents: {232, 257, 250, 92}, children: {90, 38, 230, 19, 182, 185, 58, 125}, spouse: {258, 259, 261, 134, 135, 140, 13, 272, 277, 284, 32, 40, 42, 299, 48, 176, 51, 181, 57, 74, 207, 82, 211, 85, 215, 216, 220, 221, 95, 224, 249, 231, 234, 236, 237, 109, 110, 243, 244, 248, 121, 251}
[2025-04-30 07:14:27,737] 12 Nodes of Markov blanket: [13, 82, 134, 211, 215, 216, 234, 236, 243, 244, 248, 251]
[2025-04-30 07:14:27,741] [MB metrics] precision: 1.000, recall: 0.222, acc: 0.860, f1: 0.364
[2025-04-30 07:14:45,166] sub_met2 before prunning None
[2025-04-30 07:14:45,166] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3438, 'shd': 23, 'nnz': 22, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:14:45,166] 
===  249-th graph ===
[2025-04-30 07:14:45,166] 68 Nodes of True MB: [1, 5, 7, 10, 13, 15, 16, 20, 22, 24, 25, 29, 31, 33, 38, 46, 50, 59, 61, 66, 67, 73, 76, 77, 82, 84, 90, 102, 104, 105, 107, 109, 111, 113, 118, 128, 157, 164, 165, 171, 174, 175, 180, 183, 185, 186, 192, 195, 199, 207, 208, 214, 221, 224, 235, 248, 249, 262, 265, 269, 272, 274, 275, 280, 284, 289, 290, 299], parents: {164, 76, 84, 15}, children: {1, 290, 5, 262, 185, 186, 61}, spouse: {128, 5, 7, 265, 10, 269, 13, 16, 272, 274, 275, 20, 22, 24, 25, 280, 284, 157, 29, 31, 33, 289, 165, 38, 171, 299, 174, 175, 46, 50, 180, 183, 59, 192, 66, 195, 67, 199, 73, 77, 207, 208, 82, 214, 90, 221, 224, 102, 104, 105, 107, 235, 109, 111, 113, 118, 248, 249}
[2025-04-30 07:14:45,166] 13 Nodes of Markov blanket: [20, 29, 38, 50, 82, 104, 192, 195, 199, 224, 249, 265, 269]
[2025-04-30 07:14:45,174] [MB metrics] precision: 1.000, recall: 0.191, acc: 0.817, f1: 0.321
[2025-04-30 07:15:01,813] sub_met2 before prunning None
[2025-04-30 07:15:01,813] sub_met after prunning {'fdr': 0.9394, 'tpr': 0.5, 'fpr': 0.4189, 'shd': 33, 'nnz': 33, 'precision': 0.0606, 'recall': 0.5, 'F1': 0.1081, 'gscore': 0.0}
[2025-04-30 07:15:01,813] 
===  250-th graph ===
[2025-04-30 07:15:01,813] 37 Nodes of True MB: [18, 20, 34, 49, 53, 56, 64, 68, 73, 92, 95, 98, 99, 109, 110, 117, 142, 152, 155, 164, 176, 179, 182, 185, 216, 222, 224, 232, 234, 248, 250, 257, 264, 287, 294, 298, 299], parents: {20}, children: {224, 34, 294, 264, 142, 53, 248, 95}, spouse: {257, 18, 152, 155, 287, 164, 298, 299, 176, 49, 179, 182, 56, 185, 64, 68, 73, 216, 92, 222, 98, 99, 232, 234, 109, 110, 117, 250}
[2025-04-30 07:15:01,815] 4 Nodes of Markov blanket: [73, 232, 250, 287]
[2025-04-30 07:15:01,818] [MB metrics] precision: 1.000, recall: 0.108, acc: 0.890, f1: 0.195
[2025-04-30 07:15:08,463] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:15:08,463] sub_met2 before prunning None
[2025-04-30 07:15:08,463] sub_met after prunning None
[2025-04-30 07:15:08,463] 
===  251-th graph ===
[2025-04-30 07:15:08,463] 71 Nodes of True MB: [0, 3, 10, 13, 18, 22, 29, 30, 31, 32, 39, 40, 55, 67, 68, 72, 78, 82, 90, 92, 103, 109, 111, 112, 119, 125, 128, 133, 134, 135, 141, 148, 154, 158, 166, 178, 181, 185, 189, 190, 191, 192, 198, 201, 202, 204, 208, 213, 215, 216, 218, 224, 225, 226, 234, 245, 247, 248, 251, 253, 259, 262, 264, 267, 273, 281, 284, 287, 293, 298, 299], parents: {192, 224, 13, 111, 92}, children: {67, 3, 68, 293, 72, 213, 55, 247, 125}, spouse: {0, 128, 259, 133, 134, 262, 135, 264, 10, 267, 141, 273, 18, 148, 22, 281, 154, 284, 29, 30, 287, 31, 158, 32, 166, 39, 40, 298, 299, 178, 181, 185, 189, 190, 191, 68, 198, 201, 202, 204, 78, 208, 82, 215, 216, 218, 90, 92, 224, 225, 226, 103, 234, 109, 112, 245, 119, 248, 253, 251, 125}
[2025-04-30 07:15:08,463] 26 Nodes of Markov blanket: [10, 13, 22, 32, 68, 92, 103, 109, 119, 125, 128, 141, 154, 189, 191, 204, 208, 215, 216, 225, 226, 245, 248, 251, 253, 281]
[2025-04-30 07:15:08,463] [MB metrics] precision: 1.000, recall: 0.366, acc: 0.850, f1: 0.536
[2025-04-30 07:15:28,831] sub_met2 before prunning None
[2025-04-30 07:15:28,831] sub_met after prunning {'fdr': 0.9138, 'tpr': 0.7143, 'fpr': 0.3408, 'shd': 110, 'nnz': 116, 'precision': 0.0862, 'recall': 0.7143, 'F1': 0.1538, 'gscore': 0.0}
[2025-04-30 07:15:28,831] 
===  252-th graph ===
[2025-04-30 07:15:28,831] 25 Nodes of True MB: [4, 5, 28, 42, 67, 70, 73, 79, 86, 93, 94, 97, 113, 116, 123, 154, 160, 199, 223, 226, 241, 244, 252, 271, 291], parents: {73, 4, 113}, children: {93, 94, 79}, spouse: {5, 271, 154, 28, 160, 291, 42, 67, 70, 199, 86, 223, 97, 226, 241, 116, 244, 123, 252}
[2025-04-30 07:15:28,831] 5 Nodes of Markov blanket: [123, 223, 226, 241, 252]
[2025-04-30 07:15:28,848] [MB metrics] precision: 1.000, recall: 0.200, acc: 0.932, f1: 0.333
[2025-04-30 07:15:36,333] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:15:36,333] sub_met2 before prunning None
[2025-04-30 07:15:36,333] sub_met after prunning None
[2025-04-30 07:15:36,333] 
===  253-th graph ===
[2025-04-30 07:15:36,333] 60 Nodes of True MB: [4, 12, 17, 30, 35, 40, 46, 55, 57, 70, 72, 73, 78, 99, 102, 110, 112, 116, 133, 135, 140, 142, 149, 150, 153, 156, 165, 166, 168, 170, 176, 178, 190, 195, 201, 205, 206, 208, 210, 211, 218, 222, 228, 231, 239, 241, 244, 251, 253, 256, 257, 264, 273, 276, 281, 284, 285, 293, 297, 298], parents: {211, 228, 206}, children: {35, 99, 72, 176, 17, 210, 116}, spouse: {256, 257, 4, 133, 135, 264, 140, 12, 142, 273, 276, 149, 150, 153, 281, 156, 284, 30, 285, 165, 166, 293, 40, 297, 298, 168, 170, 46, 178, 55, 57, 190, 195, 70, 73, 201, 205, 78, 208, 218, 222, 102, 231, 110, 239, 112, 241, 244, 251, 253}
[2025-04-30 07:15:36,333] 13 Nodes of Markov blanket: [73, 133, 140, 156, 201, 206, 218, 228, 251, 253, 273, 284, 298]
[2025-04-30 07:15:36,333] [MB metrics] precision: 1.000, recall: 0.217, acc: 0.843, f1: 0.356
[2025-04-30 07:15:52,150] sub_met2 before prunning None
[2025-04-30 07:15:52,150] sub_met after prunning {'fdr': 0.9565, 'tpr': 0.25, 'fpr': 0.2973, 'shd': 25, 'nnz': 23, 'precision': 0.0435, 'recall': 0.25, 'F1': 0.0741, 'gscore': 0.0}
[2025-04-30 07:15:52,150] 
===  254-th graph ===
[2025-04-30 07:15:52,151] 23 Nodes of True MB: [13, 64, 80, 94, 101, 104, 110, 118, 121, 163, 166, 173, 197, 199, 203, 204, 222, 231, 254, 266, 267, 298, 299], parents: {266, 197, 166}, children: {204, 173, 199}, spouse: {64, 163, 101, 231, 199, 104, 298, 299, 203, 13, 110, 267, 80, 118, 94, 121, 222, 254}
[2025-04-30 07:15:52,151] 6 Nodes of Markov blanket: [110, 121, 199, 231, 254, 298]
[2025-04-30 07:15:52,153] [MB metrics] precision: 1.000, recall: 0.261, acc: 0.943, f1: 0.414
[2025-04-30 07:16:01,557] sub_met2 before prunning None
[2025-04-30 07:16:01,557] sub_met after prunning {'fdr': 0.0, 'tpr': 0.0, 'fpr': 0.0, 'shd': 1, 'nnz': 0, 'precision': nan, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:16:01,557] 
===  255-th graph ===
[2025-04-30 07:16:01,557] 62 Nodes of True MB: [16, 20, 26, 27, 29, 31, 39, 45, 46, 47, 48, 56, 62, 65, 66, 67, 73, 76, 82, 85, 89, 98, 101, 110, 111, 117, 133, 134, 136, 148, 154, 163, 169, 174, 178, 183, 185, 186, 192, 194, 197, 200, 202, 214, 221, 222, 226, 232, 247, 255, 260, 263, 266, 267, 268, 281, 289, 291, 293, 295, 298, 299], parents: {192, 266, 298, 174, 46, 117}, children: {65, 281, 154, 136, 263, 85, 89, 26, 29}, spouse: {260, 133, 134, 266, 267, 268, 16, 20, 148, 281, 27, 31, 289, 291, 163, 293, 295, 39, 169, 299, 45, 47, 48, 178, 183, 56, 185, 186, 62, 194, 67, 66, 197, 200, 73, 202, 76, 82, 214, 221, 222, 226, 98, 101, 232, 110, 111, 247, 255}
[2025-04-30 07:16:01,557] 16 Nodes of Markov blanket: [47, 56, 62, 67, 101, 111, 148, 178, 186, 197, 214, 221, 232, 255, 260, 266]
[2025-04-30 07:16:01,557] [MB metrics] precision: 1.000, recall: 0.258, acc: 0.847, f1: 0.410
[2025-04-30 07:16:20,601] sub_met2 before prunning None
[2025-04-30 07:16:20,601] sub_met after prunning {'fdr': 0.9459, 'tpr': 0.2857, 'fpr': 0.3097, 'shd': 39, 'nnz': 37, 'precision': 0.0541, 'recall': 0.2857, 'F1': 0.0909, 'gscore': 0.0}
[2025-04-30 07:16:20,601] 
===  256-th graph ===
[2025-04-30 07:16:20,601] 43 Nodes of True MB: [1, 5, 20, 27, 35, 36, 48, 55, 69, 70, 73, 84, 92, 97, 100, 101, 102, 115, 119, 120, 122, 133, 134, 135, 140, 142, 147, 148, 156, 162, 164, 169, 185, 220, 228, 239, 241, 253, 256, 257, 291, 296, 298], parents: {296}, children: {97, 162, 35, 102, 134, 120, 27}, spouse: {256, 1, 257, 5, 133, 135, 140, 142, 147, 20, 148, 156, 291, 36, 164, 169, 298, 48, 55, 185, 69, 70, 73, 84, 92, 220, 228, 101, 100, 239, 241, 115, 119, 122, 253}
[2025-04-30 07:16:20,601] 10 Nodes of Markov blanket: [5, 92, 100, 122, 142, 169, 185, 228, 256, 291]
[2025-04-30 07:16:20,609] [MB metrics] precision: 1.000, recall: 0.233, acc: 0.890, f1: 0.377
[2025-04-30 07:16:36,431] sub_met2 before prunning None
[2025-04-30 07:16:36,431] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.3864, 'shd': 18, 'nnz': 17, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:16:36,431] 
===  257-th graph ===
[2025-04-30 07:16:36,431] 56 Nodes of True MB: [0, 1, 4, 5, 18, 20, 27, 36, 46, 48, 49, 57, 69, 75, 78, 82, 92, 98, 100, 104, 118, 119, 122, 134, 135, 142, 143, 148, 150, 162, 176, 185, 189, 205, 211, 214, 222, 228, 230, 232, 241, 244, 245, 248, 250, 253, 256, 257, 260, 276, 277, 279, 287, 291, 297, 298], parents: {214, 279}, children: {0, 98, 162, 4, 48, 176, 150, 248}, spouse: {256, 257, 1, 260, 5, 134, 135, 142, 143, 18, 276, 20, 148, 277, 27, 287, 291, 36, 297, 298, 46, 49, 185, 57, 189, 69, 75, 205, 78, 82, 211, 92, 222, 100, 228, 230, 104, 232, 250, 241, 244, 245, 118, 119, 122, 253}
[2025-04-30 07:16:36,431] 12 Nodes of Markov blanket: [48, 49, 57, 75, 100, 104, 118, 122, 245, 257, 287, 291]
[2025-04-30 07:16:36,431] [MB metrics] precision: 1.000, recall: 0.214, acc: 0.853, f1: 0.353
[2025-04-30 07:16:53,486] sub_met2 before prunning None
[2025-04-30 07:16:53,486] sub_met after prunning {'fdr': 0.8571, 'tpr': 1.0, 'fpr': 0.3871, 'shd': 24, 'nnz': 28, 'precision': 0.1429, 'recall': 1.0, 'F1': 0.25, 'gscore': 0.0}
[2025-04-30 07:16:53,486] 
===  258-th graph ===
[2025-04-30 07:16:53,486] 26 Nodes of True MB: [40, 45, 58, 73, 74, 80, 83, 85, 95, 97, 110, 111, 139, 149, 174, 180, 181, 191, 204, 218, 237, 246, 248, 258, 261, 294], parents: {294, 73, 74, 139, 204, 237, 174, 80, 180}, children: {58, 83}, spouse: {97, 258, 191, 261, 40, 74, 45, 110, 111, 85, 181, 149, 248, 246, 218, 95}
[2025-04-30 07:16:53,486] 8 Nodes of Markov blanket: [45, 95, 97, 111, 218, 237, 258, 294]
[2025-04-30 07:16:53,498] [MB metrics] precision: 1.000, recall: 0.308, acc: 0.939, f1: 0.471
[2025-04-30 07:17:10,575] sub_met2 before prunning None
[2025-04-30 07:17:10,575] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.32, 'shd': 11, 'nnz': 8, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:17:10,575] 
===  259-th graph ===
[2025-04-30 07:17:10,575] 48 Nodes of True MB: [7, 10, 16, 31, 40, 48, 68, 69, 73, 82, 106, 111, 115, 117, 124, 125, 126, 134, 135, 148, 159, 169, 179, 181, 189, 190, 194, 200, 211, 213, 215, 216, 219, 233, 234, 244, 246, 248, 251, 259, 260, 272, 279, 281, 284, 289, 297, 299], parents: {194, 7, 169, 244, 124}, children: {69, 297, 272, 213, 31, 125, 190, 159}, spouse: {259, 260, 134, 135, 10, 16, 148, 279, 281, 284, 289, 40, 299, 48, 179, 181, 189, 68, 200, 73, 82, 211, 215, 216, 219, 233, 234, 106, 111, 115, 117, 246, 248, 251, 124, 126}
[2025-04-30 07:17:10,575] 6 Nodes of Markov blanket: [48, 82, 115, 211, 259, 279]
[2025-04-30 07:17:10,585] [MB metrics] precision: 1.000, recall: 0.125, acc: 0.860, f1: 0.222
[2025-04-30 07:17:20,726] sub_met2 before prunning None
[2025-04-30 07:17:20,726] sub_met after prunning {'fdr': 1.0, 'tpr': 0.0, 'fpr': 0.7857, 'shd': 12, 'nnz': 11, 'precision': 0.0, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:17:20,726] 
===  260-th graph ===
[2025-04-30 07:17:20,726] 80 Nodes of True MB: [10, 13, 16, 18, 20, 24, 27, 45, 49, 56, 66, 67, 68, 75, 82, 88, 91, 92, 98, 99, 104, 105, 107, 109, 111, 115, 118, 122, 126, 130, 141, 142, 145, 147, 150, 151, 152, 154, 155, 159, 160, 169, 175, 178, 179, 183, 186, 187, 188, 189, 190, 191, 198, 199, 200, 202, 209, 220, 222, 223, 224, 228, 230, 232, 233, 237, 245, 246, 255, 257, 259, 260, 266, 276, 277, 280, 284, 285, 292, 297], parents: {66, 88, 10, 266, 56, 91}, children: {160, 292, 237, 175, 209, 178, 284, 150, 151, 154, 188, 159}, spouse: {257, 130, 259, 260, 13, 142, 141, 16, 145, 18, 147, 20, 276, 277, 150, 24, 152, 280, 155, 27, 285, 297, 169, 45, 49, 178, 179, 183, 186, 187, 189, 190, 191, 67, 68, 198, 199, 200, 202, 75, 82, 92, 220, 222, 223, 224, 98, 99, 228, 230, 104, 105, 232, 107, 233, 109, 111, 115, 245, 246, 118, 122, 126, 255}
[2025-04-30 07:17:20,726] 17 Nodes of Markov blanket: [67, 68, 82, 91, 105, 126, 150, 178, 190, 191, 222, 224, 232, 255, 260, 276, 280]
[2025-04-30 07:17:20,744] [MB metrics] precision: 1.000, recall: 0.212, acc: 0.789, f1: 0.351
[2025-04-30 07:17:39,530] sub_met2 before prunning None
[2025-04-30 07:17:39,530] sub_met after prunning {'fdr': 0.8776, 'tpr': 0.6, 'fpr': 0.3413, 'shd': 46, 'nnz': 49, 'precision': 0.1224, 'recall': 0.6, 'F1': 0.2034, 'gscore': 0.0}
[2025-04-30 07:17:39,530] 
===  261-th graph ===
[2025-04-30 07:17:39,530] 39 Nodes of True MB: [22, 26, 28, 40, 51, 55, 58, 66, 71, 74, 85, 95, 100, 110, 113, 114, 118, 132, 135, 140, 145, 155, 158, 163, 166, 168, 171, 181, 183, 214, 234, 248, 258, 261, 264, 283, 284, 293, 295], parents: {168, 234, 214, 22}, children: {132, 114, 51, 58, 283}, spouse: {258, 261, 135, 264, 140, 145, 26, 155, 284, 28, 158, 163, 293, 166, 295, 40, 171, 181, 55, 183, 66, 71, 74, 85, 214, 95, 100, 110, 113, 118, 248}
[2025-04-30 07:17:39,530] 12 Nodes of Markov blanket: [40, 55, 74, 85, 95, 100, 110, 145, 166, 181, 214, 261]
[2025-04-30 07:17:39,537] [MB metrics] precision: 1.000, recall: 0.308, acc: 0.909, f1: 0.471
[2025-04-30 07:17:56,958] sub_met2 before prunning None
[2025-04-30 07:17:56,959] sub_met after prunning {'fdr': 0.9615, 'tpr': 0.3333, 'fpr': 0.3968, 'shd': 27, 'nnz': 26, 'precision': 0.0385, 'recall': 0.3333, 'F1': 0.069, 'gscore': 0.0}
[2025-04-30 07:17:56,959] 
===  262-th graph ===
[2025-04-30 07:17:56,959] 30 Nodes of True MB: [0, 3, 7, 24, 33, 39, 54, 76, 82, 103, 118, 125, 134, 138, 171, 175, 178, 185, 191, 193, 208, 209, 225, 232, 235, 249, 251, 262, 287, 290], parents: {33, 7, 171, 235, 175, 208, 118, 24, 249}, children: {138, 3}, spouse: {0, 262, 7, 134, 287, 290, 39, 178, 54, 185, 191, 193, 76, 209, 82, 225, 103, 232, 251, 125}
[2025-04-30 07:17:56,959] 2 Nodes of Markov blanket: [7, 262]
[2025-04-30 07:17:56,961] [MB metrics] precision: 1.000, recall: 0.067, acc: 0.904, f1: 0.125
[2025-04-30 07:18:03,303] sub_met2 before prunning None
[2025-04-30 07:18:03,303] sub_met after prunning {'fdr': 0.0, 'tpr': 0.0, 'fpr': 0.0, 'shd': 1, 'nnz': 0, 'precision': nan, 'recall': 0.0, 'F1': nan, 'gscore': 0.0}
[2025-04-30 07:18:03,303] 
===  263-th graph ===
[2025-04-30 07:18:03,303] 13 Nodes of True MB: [20, 31, 45, 66, 163, 183, 194, 202, 247, 255, 263, 289, 293], parents: {289, 66, 163, 194, 255, 293, 202, 45, 20, 183, 247, 31}, children: set(), spouse: {263}
[2025-04-30 07:18:03,303] 
===  264-th graph ===
[2025-04-30 07:18:03,303] 41 Nodes of True MB: [24, 25, 38, 40, 55, 64, 66, 72, 74, 99, 100, 101, 102, 112, 113, 132, 133, 135, 148, 160, 161, 163, 166, 175, 190, 191, 197, 201, 218, 224, 240, 250, 251, 253, 261, 264, 268, 273, 282, 284, 298], parents: {64, 250, 99}, children: {72, 148, 132, 268}, spouse: {261, 133, 135, 264, 273, 24, 25, 282, 284, 160, 161, 163, 166, 38, 40, 298, 175, 55, 190, 191, 66, 197, 201, 74, 218, 224, 100, 101, 102, 112, 240, 113, 251, 253}
[2025-04-30 07:18:03,303] 3 Nodes of Markov blanket: [55, 113, 264]
[2025-04-30 07:18:03,303] [MB metrics] precision: 1.000, recall: 0.073, acc: 0.873, f1: 0.136
[2025-04-30 07:18:10,290] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:18:10,290] sub_met2 before prunning None
[2025-04-30 07:18:10,290] sub_met after prunning None
[2025-04-30 07:18:10,290] 
===  265-th graph ===
[2025-04-30 07:18:10,290] 26 Nodes of True MB: [1, 16, 20, 33, 38, 39, 50, 64, 66, 67, 77, 82, 86, 124, 133, 157, 161, 192, 195, 207, 226, 249, 265, 266, 269, 292], parents: {161, 66, 67, 195, 38}, children: {1, 86}, spouse: {133, 265, 266, 269, 16, 20, 157, 33, 292, 39, 50, 192, 64, 195, 77, 207, 82, 226, 249, 124}
[2025-04-30 07:18:10,292] 6 Nodes of Markov blanket: [33, 50, 192, 249, 265, 269]
[2025-04-30 07:18:10,292] [MB metrics] precision: 1.000, recall: 0.231, acc: 0.932, f1: 0.375
[2025-04-30 07:18:20,466] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:18:20,466] sub_met2 before prunning None
[2025-04-30 07:18:20,466] sub_met after prunning None
[2025-04-30 07:18:20,466] 
===  266-th graph ===
[2025-04-30 07:18:20,466] 53 Nodes of True MB: [6, 7, 10, 15, 29, 39, 46, 56, 57, 59, 64, 66, 73, 80, 86, 88, 89, 91, 101, 102, 113, 117, 124, 133, 148, 152, 157, 166, 174, 185, 186, 192, 197, 207, 214, 222, 225, 226, 233, 234, 235, 239, 244, 247, 254, 255, 260, 265, 266, 276, 292, 298, 299], parents: set(), children: {89, 260, 234, 174, 15, 80, 244, 86, 57, 59, 29, 254, 255}, spouse: {133, 6, 7, 265, 266, 10, 15, 148, 276, 152, 157, 292, 166, 39, 298, 299, 46, 174, 56, 185, 186, 64, 192, 66, 197, 73, 207, 214, 88, 91, 222, 225, 226, 101, 102, 233, 235, 239, 113, 117, 247, 124, 255}
[2025-04-30 07:18:20,466] 12 Nodes of Markov blanket: [6, 7, 39, 73, 101, 148, 157, 186, 214, 255, 266, 276]
[2025-04-30 07:18:20,466] [MB metrics] precision: 1.000, recall: 0.226, acc: 0.863, f1: 0.369
[2025-04-30 07:18:37,848] sub_met2 before prunning None
[2025-04-30 07:18:37,848] sub_met after prunning {'fdr': 0.9722, 'tpr': 0.5, 'fpr': 0.5469, 'shd': 36, 'nnz': 36, 'precision': 0.0278, 'recall': 0.5, 'F1': 0.0526, 'gscore': 0.0}
[2025-04-30 07:18:37,848] 
===  267-th graph ===
[2025-04-30 07:18:37,848] 52 Nodes of True MB: [13, 16, 18, 24, 31, 48, 50, 56, 64, 68, 80, 82, 85, 94, 99, 108, 109, 113, 118, 128, 141, 155, 156, 163, 173, 174, 178, 191, 192, 197, 199, 200, 202, 203, 206, 214, 219, 224, 233, 234, 239, 243, 244, 245, 251, 254, 255, 267, 270, 276, 288, 299], parents: set(), children: {192, 288, 163, 68, 173, 239, 113, 85}, spouse: {128, 267, 141, 270, 13, 16, 18, 276, 24, 155, 156, 31, 299, 174, 48, 50, 178, 56, 191, 64, 197, 199, 200, 202, 203, 206, 80, 82, 214, 219, 94, 224, 99, 233, 234, 108, 109, 243, 244, 245, 118, 251, 254, 255}
[2025-04-30 07:18:37,848] 14 Nodes of Markov blanket: [16, 24, 50, 64, 99, 141, 155, 191, 202, 214, 219, 267, 270, 276]
[2025-04-30 07:18:37,853] [MB metrics] precision: 1.000, recall: 0.269, acc: 0.873, f1: 0.424
[2025-04-30 07:18:53,928] sub_met2 before prunning None
[2025-04-30 07:18:53,928] sub_met after prunning {'fdr': 0.9583, 'tpr': 0.5, 'fpr': 0.2584, 'shd': 24, 'nnz': 24, 'precision': 0.0417, 'recall': 0.5, 'F1': 0.0769, 'gscore': 0.0}
[2025-04-30 07:18:53,928] 
===  268-th graph ===
[2025-04-30 07:18:53,928] 15 Nodes of True MB: [20, 25, 27, 38, 74, 98, 101, 133, 136, 191, 224, 255, 264, 268, 282], parents: {224, 101, 38, 133, 264, 74, 25, 282, 191}, children: {136}, spouse: {98, 268, 20, 27, 255}
[2025-04-30 07:18:53,928] 
===  269-th graph ===
[2025-04-30 07:18:53,932] 45 Nodes of True MB: [0, 1, 2, 5, 12, 13, 16, 20, 33, 50, 55, 59, 61, 64, 68, 75, 77, 82, 91, 95, 104, 125, 128, 135, 155, 159, 160, 177, 179, 180, 181, 192, 195, 198, 201, 202, 204, 208, 228, 232, 236, 249, 265, 269, 277], parents: {64, 128, 68, 135, 104, 202, 75, 208, 177, 179, 55, 159}, children: {1, 2, 201}, spouse: {0, 5, 265, 12, 269, 13, 16, 20, 277, 155, 159, 160, 33, 50, 180, 181, 59, 61, 192, 195, 198, 204, 77, 82, 91, 95, 228, 232, 236, 249, 125}
[2025-04-30 07:18:53,932] 6 Nodes of Markov blanket: [33, 192, 195, 249, 265, 269]
[2025-04-30 07:18:53,935] [MB metrics] precision: 1.000, recall: 0.133, acc: 0.860, f1: 0.235
[2025-04-30 07:19:04,157] sub_met2 before prunning None
[2025-04-30 07:19:04,157] sub_met after prunning {'fdr': 0.9167, 'tpr': 1.0, 'fpr': 0.7857, 'shd': 11, 'nnz': 12, 'precision': 0.0833, 'recall': 1.0, 'F1': 0.1538, 'gscore': 0.0}
[2025-04-30 07:19:04,157] 
===  270-th graph ===
[2025-04-30 07:19:04,157] 32 Nodes of True MB: [12, 24, 38, 44, 50, 55, 66, 69, 98, 99, 103, 117, 120, 121, 127, 129, 135, 140, 141, 161, 163, 168, 181, 191, 219, 225, 235, 267, 270, 276, 277, 294], parents: {225, 69, 38, 168, 140, 181, 120}, children: {163, 12, 44, 127}, spouse: {129, 135, 267, 141, 270, 276, 277, 24, 161, 38, 294, 50, 55, 191, 66, 219, 98, 99, 103, 235, 117, 121}
[2025-04-30 07:19:04,157] 8 Nodes of Markov blanket: [50, 99, 117, 141, 191, 267, 270, 294]
[2025-04-30 07:19:04,157] [MB metrics] precision: 1.000, recall: 0.250, acc: 0.919, f1: 0.400
[2025-04-30 07:19:21,435] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:19:21,435] sub_met2 before prunning None
[2025-04-30 07:19:21,435] sub_met after prunning None
[2025-04-30 07:19:21,435] 
===  271-th graph ===
[2025-04-30 07:19:21,435] 24 Nodes of True MB: [0, 25, 42, 47, 50, 67, 70, 76, 93, 105, 116, 148, 154, 160, 192, 232, 234, 236, 237, 243, 245, 252, 271, 289], parents: {289, 67, 105, 76, 236, 237, 50, 243, 148, 25}, children: {42, 93}, spouse: {0, 192, 160, 67, 70, 232, 234, 47, 271, 116, 245, 154, 252, 93}
[2025-04-30 07:19:21,435] 
===  272-th graph ===
[2025-04-30 07:19:21,435] 40 Nodes of True MB: [13, 25, 26, 33, 37, 38, 47, 48, 64, 67, 70, 82, 91, 107, 109, 113, 123, 124, 135, 164, 178, 179, 180, 185, 197, 207, 211, 216, 218, 219, 222, 226, 235, 239, 248, 249, 259, 272, 284, 299], parents: {259, 48, 82, 179, 211, 219, 124}, children: {37, 216, 185, 218, 123}, spouse: {135, 13, 272, 25, 26, 284, 33, 164, 38, 299, 47, 48, 178, 180, 64, 67, 197, 70, 207, 82, 219, 91, 222, 226, 235, 107, 109, 239, 113, 248, 249, 124}
[2025-04-30 07:19:21,435] 12 Nodes of Markov blanket: [13, 48, 64, 70, 82, 91, 113, 124, 178, 207, 219, 272]
[2025-04-30 07:19:21,435] [MB metrics] precision: 1.000, recall: 0.300, acc: 0.907, f1: 0.462
[2025-04-30 07:19:43,600] sub_met2 before prunning None
[2025-04-30 07:19:43,600] sub_met after prunning {'fdr': 0.9412, 'tpr': 0.4, 'fpr': 0.5246, 'shd': 35, 'nnz': 34, 'precision': 0.0588, 'recall': 0.4, 'F1': 0.1026, 'gscore': 0.0}
[2025-04-30 07:19:43,600] 
===  273-th graph ===
[2025-04-30 07:19:43,600] 23 Nodes of True MB: [33, 40, 43, 72, 88, 102, 103, 112, 135, 142, 166, 190, 201, 218, 229, 247, 251, 253, 264, 273, 280, 284, 298], parents: {33, 280, 229, 102, 103, 43, 142, 247, 88, 284}, children: {72}, spouse: {166, 135, 40, 201, 264, 298, 112, 273, 218, 251, 253, 190}
[2025-04-30 07:19:43,600] 5 Nodes of Markov blanket: [201, 218, 253, 273, 298]
[2025-04-30 07:19:43,607] [MB metrics] precision: 1.000, recall: 0.217, acc: 0.940, f1: 0.357
[2025-04-30 07:19:51,725] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:19:51,725] sub_met2 before prunning None
[2025-04-30 07:19:51,725] sub_met after prunning None
[2025-04-30 07:19:51,725] 
===  274-th graph ===
[2025-04-30 07:19:51,725] 25 Nodes of True MB: [5, 10, 24, 25, 48, 56, 59, 66, 90, 97, 105, 111, 113, 134, 135, 144, 157, 181, 215, 226, 249, 274, 280, 290, 294], parents: {97, 226, 66, 294, 10, 56}, children: {290, 215}, spouse: {5, 134, 135, 10, 144, 274, 280, 24, 25, 157, 48, 181, 59, 66, 90, 105, 111, 113, 249}
[2025-04-30 07:19:51,725] 4 Nodes of Markov blanket: [48, 135, 144, 274]
[2025-04-30 07:19:51,725] [MB metrics] precision: 1.000, recall: 0.160, acc: 0.929, f1: 0.276
[2025-04-30 07:19:59,245] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:19:59,245] sub_met2 before prunning None
[2025-04-30 07:19:59,245] sub_met after prunning None
[2025-04-30 07:19:59,245] 
===  275-th graph ===
[2025-04-30 07:19:59,245] 44 Nodes of True MB: [5, 22, 25, 31, 33, 38, 42, 71, 73, 77, 84, 88, 90, 102, 103, 104, 107, 117, 122, 124, 126, 128, 131, 141, 152, 155, 166, 167, 174, 180, 182, 183, 185, 189, 206, 208, 221, 222, 232, 233, 237, 249, 275, 293], parents: {208, 117, 103}, children: {33, 5, 167, 77, 126}, spouse: {128, 131, 141, 275, 22, 152, 25, 155, 31, 293, 166, 38, 42, 174, 180, 182, 183, 185, 189, 71, 73, 206, 208, 84, 88, 90, 221, 222, 102, 232, 233, 104, 107, 237, 249, 122, 124}
[2025-04-30 07:19:59,245] 7 Nodes of Markov blanket: [103, 152, 155, 174, 208, 222, 275]
[2025-04-30 07:19:59,245] [MB metrics] precision: 1.000, recall: 0.159, acc: 0.874, f1: 0.275
[2025-04-30 07:20:13,520] sub_met2 before prunning None
[2025-04-30 07:20:13,520] sub_met after prunning {'fdr': 0.8571, 'tpr': 0.5, 'fpr': 0.3158, 'shd': 7, 'nnz': 7, 'precision': 0.1429, 'recall': 0.5, 'F1': 0.2222, 'gscore': 0.0}
[2025-04-30 07:20:13,520] 
===  276-th graph ===
[2025-04-30 07:20:13,524] 57 Nodes of True MB: [6, 7, 12, 16, 17, 18, 24, 46, 56, 62, 76, 80, 98, 99, 104, 108, 112, 113, 117, 135, 141, 142, 143, 147, 155, 159, 163, 165, 166, 168, 169, 183, 184, 191, 203, 211, 214, 219, 230, 231, 233, 238, 243, 253, 257, 260, 266, 267, 270, 276, 280, 284, 286, 289, 292, 293, 294], parents: {294, 289, 155, 166}, children: {98, 163, 238, 80, 17, 243, 280, 284}, spouse: {257, 260, 6, 135, 7, 266, 267, 12, 141, 270, 143, 142, 16, 18, 147, 276, 24, 280, 284, 286, 159, 292, 165, 293, 168, 169, 46, 183, 184, 56, 62, 191, 203, 76, 211, 214, 219, 99, 230, 231, 104, 233, 108, 112, 113, 117, 253}
[2025-04-30 07:20:13,524] 21 Nodes of Markov blanket: [6, 7, 18, 56, 80, 112, 113, 117, 142, 147, 166, 169, 203, 211, 214, 230, 260, 266, 267, 276, 292]
[2025-04-30 07:20:13,528] [MB metrics] precision: 1.000, recall: 0.368, acc: 0.878, f1: 0.538
[2025-04-30 07:20:36,760] sub_met2 before prunning None
[2025-04-30 07:20:36,760] sub_met after prunning {'fdr': 0.8421, 'tpr': 0.6, 'fpr': 0.2462, 'shd': 53, 'nnz': 57, 'precision': 0.1579, 'recall': 0.6, 'F1': 0.25, 'gscore': 0.0}
[2025-04-30 07:20:36,761] 
===  277-th graph ===
[2025-04-30 07:20:36,761] 63 Nodes of True MB: [12, 13, 19, 27, 38, 39, 42, 44, 45, 48, 50, 55, 56, 75, 82, 95, 97, 98, 100, 102, 104, 108, 111, 116, 118, 120, 121, 125, 127, 135, 140, 141, 142, 150, 155, 159, 160, 166, 170, 180, 182, 184, 189, 190, 197, 199, 201, 204, 211, 223, 228, 231, 234, 235, 236, 237, 248, 257, 260, 269, 270, 277, 295], parents: {102, 166, 199, 234, 108, 13, 111, 55, 56}, children: {39, 201, 19, 150, 184, 127}, spouse: {257, 260, 135, 140, 12, 142, 13, 269, 141, 270, 277, 155, 27, 159, 160, 38, 295, 170, 42, 44, 45, 48, 50, 180, 182, 55, 189, 190, 197, 75, 204, 82, 211, 95, 223, 97, 248, 98, 100, 228, 231, 104, 234, 235, 236, 237, 116, 118, 120, 121, 125}
[2025-04-30 07:20:36,761] 17 Nodes of Markov blanket: [13, 45, 48, 50, 82, 97, 116, 120, 121, 125, 141, 142, 170, 182, 211, 234, 277]
[2025-04-30 07:20:36,766] [MB metrics] precision: 1.000, recall: 0.270, acc: 0.845, f1: 0.425
[2025-04-30 07:20:57,990] sub_met2 before prunning None
[2025-04-30 07:20:57,990] sub_met after prunning {'fdr': 0.9714, 'tpr': 0.1667, 'fpr': 0.2615, 'shd': 38, 'nnz': 35, 'precision': 0.0286, 'recall': 0.1667, 'F1': 0.0488, 'gscore': 0.0}
[2025-04-30 07:20:57,990] 
===  278-th graph ===
[2025-04-30 07:20:57,990] 12 Nodes of True MB: [5, 10, 23, 59, 87, 97, 106, 123, 135, 160, 278, 295], parents: {59, 5, 295}, children: {23}, spouse: {160, 97, 135, 10, 106, 278, 87, 123}
[2025-04-30 07:20:57,992] 
===  279-th graph ===
[2025-04-30 07:20:57,992] 24 Nodes of True MB: [16, 31, 56, 99, 100, 121, 135, 166, 179, 191, 195, 197, 206, 214, 217, 227, 228, 230, 233, 257, 259, 279, 287, 289], parents: set(), children: {257, 100, 206, 179, 217, 31}, spouse: {289, 99, 287, 197, 166, 195, 227, 233, 228, 230, 135, 16, 214, 279, 56, 121, 259, 191}
[2025-04-30 07:20:57,993] 6 Nodes of Markov blanket: [16, 135, 166, 233, 259, 279]
[2025-04-30 07:20:57,996] [MB metrics] precision: 1.000, recall: 0.250, acc: 0.938, f1: 0.400
[2025-04-30 07:21:09,162] [Error] sub_met=None: Traceback (most recent call last):
  File "D:\nips\causual-discovery\DC_FAS.py", line 426, in <module>
    sub_met = castle.metrics.MetricsDAG(sub_causal_matrix, sub_true_dag)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 59, in __init__
    self.metrics = MetricsDAG._count_accuracy(self.B_est, self.B_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 163, in _count_accuracy
    gscore = MetricsDAG._cal_gscore(W_p, W_true)
  File "C:\Users\tpc19\anaconda3\envs\py310\lib\site-packages\castle\metrics\evaluation.py", line 190, in _cal_gscore
    assert num_true!=0
AssertionError

[2025-04-30 07:21:09,162] sub_met2 before prunning None
[2025-04-30 07:21:09,162] sub_met after prunning None
[2025-04-30 07:21:09,162] 
===  280-th graph ===
[2025-04-30 07:21:09,162] 65 Nodes of True MB: [5, 10, 12, 15, 16, 24, 25, 33, 43, 46, 59, 62, 66, 76, 81, 88, 90, 98, 102, 103, 105, 108, 111, 112, 113, 117, 126, 136, 141, 142, 145, 147, 156, 157, 159, 168, 170, 175, 183, 184, 186, 188, 194, 199, 203, 208, 219, 223, 224, 229, 233, 238, 246, 247, 249, 260, 273, 274, 276, 280, 284, 286, 290, 292, 295], parents: {168, 233, 203, 108, 16, 112, 147, 276, 117}, children: {290, 238, 81, 273, 188}, spouse: {260, 5, 136, 10, 12, 141, 142, 15, 145, 274, 276, 280, 24, 25, 284, 157, 286, 159, 156, 33, 292, 295, 168, 170, 43, 46, 175, 183, 184, 186, 59, 62, 66, 194, 199, 76, 208, 88, 90, 219, 223, 224, 98, 229, 102, 103, 105, 111, 113, 246, 247, 249, 126}
[2025-04-30 07:21:09,162] 11 Nodes of Markov blanket: [46, 76, 88, 111, 126, 145, 246, 260, 280, 284, 292]
[2025-04-30 07:21:09,162] [MB metrics] precision: 1.000, recall: 0.169, acc: 0.818, f1: 0.289
